(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5405],{50554:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return Q}});var a=n(809),i=n.n(a),o=n(92447),r=n(85893),c=n(74047),s=n(52700),l=n(8127),u=n(44102),d=n(20775),h=n(67294),p=n(46119),f=n(28261),m=n(53921),g=n(16683),_=n(94644),v=n(59999),x=n(4706),w=n(26265),Z=n(53082),b=n(96451),S=n(9008),y=n(4465),k=n(11768),T=n(418),j=n(6831),C=n(61160),O=n(79254),D=n(80900),L=n(37473),M=n(12383),V=n(88281),A=n(85097),I=n.n(A),P=n(7143);function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function U(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){(0,w.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function E(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=(0,d.Z)(t);if(e){var i=(0,d.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.Z)(this,n)}}var W={fetchedMain:m.Aw,fetchedSegmentation:m.iP,authTagsUpdate:T.pv,handleTags:T.ZI,fetchedMainV2:m.IA,clickHouseShoot:j.F7},$=128,N=1440,H=1024,B=function(t){(0,l.Z)(n,t);var e=E(n);function n(){var t;(0,c.Z)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return t=e.call.apply(e,[this].concat(r)),(0,w.Z)((0,x.Z)(t),"state",{browserWidth:0,currentLineCount:0,cardsCount:7,heroes:null,lines:t.props.startOriginals.startOriginals||[],linesLength:0,stopLoadLines:!1,v2:null,linesAliases:["recommend","top-10-on-Start"],currentVisiblePaging:0,countCards:0,countTop10Cards:0}),(0,w.Z)((0,x.Z)(t),"apiUrl",t.props.systemInformation.API_URL||f.T5),(0,w.Z)((0,x.Z)(t),"stop",!1),(0,w.Z)((0,x.Z)(t),"localLoaded",!1),(0,w.Z)((0,x.Z)(t),"loadTags",!1),(0,w.Z)((0,x.Z)(t),"loadV2Main",!1),(0,w.Z)((0,x.Z)(t),"loadV2MainTag",!1),(0,w.Z)((0,x.Z)(t),"loadV2MainTagData",!1),(0,w.Z)((0,x.Z)(t),"linesShot",[]),(0,w.Z)((0,x.Z)(t),"shootTimeout",[]),(0,w.Z)((0,x.Z)(t),"arrowTimeout",null),(0,w.Z)((0,x.Z)(t),"checkChild",!1),(0,w.Z)((0,x.Z)(t),"tempResult",[]),(0,w.Z)((0,x.Z)(t),"noAuth",!1),(0,w.Z)((0,x.Z)(t),"getScaleSize",(function(t,e){var n=100*t/1440,a=e?window.innerWidth:window.innerHeight;return Number(a*n/100).toFixed(2)})),(0,w.Z)((0,x.Z)(t),"arrowClick",(function(e,n){clearTimeout(t.arrowTimeout),t.arrowTimeout=null;var a=t.state,i=a.currentVisiblePaging,o=a.lines,r=a.countCards,c=a.countTop10Cards,s=t.props.systemInformation.clickHouseData,l=t.props.startOriginals,u=l.tranding,d=l.segmentation;t.setState({currentVisiblePaging:e?i+1:i-1},(function(){t.arrowTimeout=setTimeout((function(){var a="recommend"===n?{items:d}:"top-10-on-Start"===n?{items:u}:o.filter((function(t){return t.alias===n}))[0],i="recommend"===n?0:"top-10-on-Start"===n?1:o.findIndex((function(t){return t.alias===n})),l=a.items.slice(t.state.currentVisiblePaging*r,t.state.currentVisiblePaging*r+r),h=a.items.slice(t.state.currentVisiblePaging*c,t.state.currentVisiblePaging*c+c),p=U(U({},s),{},{action_id:"click",action_result:"top-10-on-Start"===n?h.map((function(t){return a.items.indexOf(t)+1})):l.map((function(t){return a.items.indexOf(t)+1})),action_attributes_num:i+2,action_attributes_str:"top-10-on-Start"===n?h.map((function(t){return t.uid||t.id})):l.map((function(t){return t.uid||t.id})),block_type:"collection",block_attributes_id:n,element_attributes_id:e?"arrow_right":"arrow_left",event_time:(new Date).getTime()});t.props.clickHouseShoot(p)}),2e3)}))})),(0,w.Z)((0,x.Z)(t),"loadData",(function(e){var n=t.props.locale,a=t.state,r=a.v2,c=a.linesLength,s=a.linesAliases,l=t.props.registration.authData,u="&locale=".concat(n),d="&content_lang=".concat(n),h=r&&!l.profile_for_child?"&for_kids=".concat(l.profile_for_child):"&for_kids=".concat(l.profile_for_child,"&limit=2&products_limit=9"),p="".concat(t.apiUrl).concat(e).concat(f.$h).concat(h).concat(u).concat(d);fetch(p,{credentials:"include",method:"GET"}).then((function(n){n.status<400&&n.json().then((function(n){if(r){var a=[];t.props.fetchedMainV2(n),n&&Promise.all(n.map(function(){var n=(0,o.Z)(i().mark((function n(o,r){var h,p,m;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r<2)){n.next=12;break}return h="".concat(t.apiUrl).concat(e,"/").concat(o.alias).concat(f.$h).concat(u).concat(d,"&profile_id=").concat(l.profile_id),n.next=4,fetch(h,{credentials:"include",method:"GET"});case 4:return p=n.sent,n.next=7,p.json();case 7:return m=n.sent,t.tempResult.push(m),n.next=11,t.setState({lines:t.tempResult,linesLength:c+1,linesAliases:s.concat(t.tempResult.map((function(t){return t.alias}))),currentLineCount:2});case 11:a.push(m);case 12:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}())),a.length&&t.props.fetchedMain(a)}else t.props.fetchedMain(n),t.setState({lines:n,linesLength:2,currentLineCount:2})}))}))})),(0,w.Z)((0,x.Z)(t),"renderMoreLines",(function(){var e=t.state,n=e.currentLineCount,a=e.linesLength,i=e.linesAliases,o=t.props.startOriginals.mainV2,r=t.props.registration.authData,c=t.props.locale,s="&locale=".concat(c),l="&content_lang=".concat(c);return o&&o.length?Promise.all(o.map((function(e,o){if(o===n-1){var c="".concat(t.apiUrl).concat(p.ve.mainV2,"/").concat(e.alias).concat(f.$h).concat(s).concat(l,"&profile_id=").concat(r.profile_id);fetch(c,{credentials:"include",method:"GET"}).then((function(e){e.status<400&&e.json().then((function(e){var n;null!==e&&void 0!==e&&null!==(n=e.items)&&void 0!==n&&n.length&&(t.tempResult.push(e),t.setState({lines:t.tempResult,linesLength:a+1,linesAliases:i.concat(t.tempResult.map((function(t){return t.alias})))}))}))}))}}))):null})),(0,w.Z)((0,x.Z)(t),"getMoreLines",(function(e){var n=t.state,a=n.lines,i=n.linesLength,o=n.cardsCount,r=n.linesAliases,c=t.props.profile.currentProfile,s=t.props.locale,l="&locale=".concat(s),u="&content_lang=".concat(s);t.stop=!0,fetch("".concat(t.apiUrl).concat(p.ve.main).concat(f.$h,"&for_kids=").concat(c&&c.child?"true":"false").concat(l).concat(u,"&limit=1&products_limit=").concat(o+1,"&skip=").concat(e),{credentials:"include"}).then((function(e){e.status<400&&e.json().then((function(e){if(e&&e.length){var n=a&&a.concat(e)||e;t.setState({lines:n,linesLength:i+1,linesAliases:r.concat(n.map((function(t){return t.alias})))},(function(){t.stop=!1}))}else t.setState({stopLoadLines:!0})}))}))})),(0,w.Z)((0,x.Z)(t),"getMoreCards",(function(e,n){var a=t.state,i=a.lines,o=a.cardsCount,r=a.linesLength,c=a.linesAliases,s=t.props.profile.currentProfile,l=t.props.locale,u=i.filter((function(t){return t.alias===e}))[0].items.length,d="&locale=".concat(l),h="&content_lang=".concat(l),m="".concat(t.apiUrl).concat(p.ve.main).concat(f.$h,"&for_kids=").concat(s&&s.child?"true":"false").concat(d).concat(h,"&limit=1&products_limit=").concat(o+1,"&products_skip=").concat(u,"&skip=").concat(n);fetch(m,{credentials:"include"}).then((function(e){e.status<400&&e.json().then((function(e){if(e){var a=i.map((function(t,a){return a===n?U(U({},t),{},{items:t.items.concat(e[0].items)}):t}));t.setState({lines:a,linesLength:r+1,linesAliases:c.concat(a.map((function(t){return t.alias})))})}}))}))})),(0,w.Z)((0,x.Z)(t),"getAllCards",(function(e){var n=t.state,a=n.v2,i=n.lines,o=n.countCards,r=n.linesLength,c=n.linesAliases,s=t.props.systemInformation.clickHouseData,l=t.props.startOriginals,u=l.tranding,d=l.segmentation,h=t.props.profile.currentProfile,p=t.props.locale,m="recommend"===e?{items:d}:"top-10-on-Start"===e?{items:u}:i.filter((function(t){return t.alias===e}))[0],g="recommend"===e?0:"top-10-on-Start"===e?1:i.findIndex((function(t){return t.alias===e})),_=document.getElementById("main_header").getBoundingClientRect().height,v=document.getElementById(e).getBoundingClientRect().top,x=window.innerHeight-v;if(x>0&&v>_){var w=window.innerWidth>H,Z=window.innerWidth>N,b=w?Z?t.getScaleSize($,!1):$:146,S=Math.floor(x/b)*o,y=m.items.slice(0,S),k=U(U({},s),{},{action_id:"click",action_result:y.map((function(t){return m.items.indexOf(t)+1})),action_attributes_num:g+2,action_attributes_str:y.map((function(t){return t.uid||t.id})),block_type:"collection",block_attributes_id:e,element_attributes_id:"show_more",event_time:(new Date).getTime()});t.props.clickHouseShoot(k)}if(!a&&"recommend"!==e){var T="&locale=".concat(p),j="&content_lang=".concat(p),C=i.filter((function(t){return t.alias===e}))[0],O="".concat(t.apiUrl).concat(C.url).concat(f.$h,"&for_kids=").concat(h&&h.child?"true":"false").concat(T).concat(j);fetch(O,{credentials:"include"}).then((function(n){n.status<400&&n.json().then((function(n){if(n){var a=i.map((function(t){return t.alias===e?U(U({},t),{},{items:n.items}):t}));t.setState({lines:a,linesLength:r+1,linesAliases:c.concat(a.map((function(t){return t.alias})))})}}))}))}})),(0,w.Z)((0,x.Z)(t),"handleScroll",(function(){var e,n=t.state,a=n.currentLineCount,i=n.v2;e=50+150*(a-1),window.scrollY>e&&t.setState({currentLineCount:a+1},(function(){i&&t.renderMoreLines()})),t.hanldeLinesScroll()})),(0,w.Z)((0,x.Z)(t),"hanldeLinesScroll",(function(){var e=t.state,n=e.linesAliases,a=e.currentVisiblePaging,i=e.countCards,o=e.lines,r=e.countTop10Cards,c=t.props.startOriginals,s=c.tranding,l=c.segmentation,u=document.getElementById("main_header").getBoundingClientRect().height;n&&n.map((function(e){var n=document.getElementById(e);if(n){var c=n.getBoundingClientRect(),d=c.top,h=c.height,p=window.innerHeight;if(p-d-h>0&&d>u&&-1===t.linesShot.indexOf(e)){var f=t.linesShot.indexOf(e);clearTimeout(t.shootTimeout[f]),t.linesShot.push(e);var m="recommend"===e?{items:l}:"top-10-on-Start"===e?{items:s}:o.filter((function(t){return t.alias===e}))[0],g="recommend"===e?0:"top-10-on-Start"===e?1:o.findIndex((function(t){return t.alias===e})),_=m.items.slice(a*i,a*i+i),v=m.items.slice(t.state.currentVisiblePaging*r,t.state.currentVisiblePaging*r+r),x=setTimeout((function(){var n=U(U({},t.props.systemInformation.clickHouseData),{},{action_id:"collection_view",action_result:"top-10-on-Start"===e?v.map((function(t){return m.items.indexOf(t)+1})):_.map((function(t){return m.items.indexOf(t)+1})),action_attributes_num:g+2,action_attributes_str:"top-10-on-Start"===e?v.map((function(t){return t.uid||t.id})):_.map((function(t){return t.uid||t.id})),block_type:"collection",block_attributes_id:e,event_time:(new Date).getTime()});t.props.clickHouseShoot(n)}),2e3);t.shootTimeout.push(x)}else if(!(p-d-h>0&&d>u)&&-1!==t.linesShot.indexOf(e)){var w=t.linesShot.indexOf(e);t.linesShot.splice(w,1),clearTimeout(t.shootTimeout[w]),t.shootTimeout.splice(w,1)}}}))})),(0,w.Z)((0,x.Z)(t),"sortLikeMainAnswer",(function(e){var n=t.props.startOriginals.mainV2;if(!n||!n.length||!e)return[];var a=[];return e.map((function(t,e){var i=n.findIndex((function(e){return e.alias===t.alias}));e===i?a.push(t):a.splice(i,0,t)})),a})),t}return(0,s.Z)(n,[{key:"componentDidMount",value:function(){var t=this;window.history.scrollRestoration="manual",window.addEventListener("scroll",this.handleScroll),k.ZP.remove("contentUrl",{path:"/",domain:(0,p.tm)(window.location.host)});var e=this.state.lines,n=this.props.locale,a="&locale=".concat(n),i="&content_lang=".concat(n);if(e&&e.length){var o=e.filter((function(t){return t.product_display_mode}));o&&o.length&&fetch("".concat(this.apiUrl).concat(p.ve.main,"/").concat(o[0].alias).concat(f.$h,"&for_kids=true").concat(a).concat(i),{credentials:"include"}).then((function(e){e.status<400&&e.json().then((function(e){t.setState({heroes:e})}))}))}var r=window.innerWidth>H,c=window.innerWidth>N,s=r?c?this.getScaleSize(56,!0):56:24,l=r?c?this.getScaleSize(218,!0):218:102,u=r?c?this.getScaleSize(381,!0):381:102;this.setState({browserWidth:window.innerWidth,countCards:Math.floor((window.innerWidth-s)/(l+4)),countTop10Cards:Math.floor((window.innerWidth-s)/(u+34))}),this.hanldeLinesScroll()}},{key:"componentDidUpdate",value:function(t,e){var n=this,a=this.state,i=a.currentLineCount,o=a.stopLoadLines,r=a.v2,c=this.props.profile.currentProfile,s=this.props.registration,l=s.authData,u=s.tags,d=this.props.locale,h=this.props.systemInformation.clickHouseData;if(e.currentLineCount!==i&&c&&!o&&!this.stop){if(r)return!1;this.getMoreLines(i)}if(e.browserWidth!==window.innerWidth&&this.setState({browserWidth:window.innerWidth}),l&&l.profile_id){if(-1!==l.tags.indexOf("web_featuredrec_true")&&!this.loadTags&&"ru"===d){this.loadTags=!0;var m="".concat(this.apiUrl).concat(p.ve.recommendationLigh).concat(l.profile_id).concat(f.$h);fetch(m,{credentials:"include",method:"GET"}).then((function(t){t.status<400&&t.json().then((function(t){var e;null!==t&&void 0!==t&&null!==(e=t.items)&&void 0!==e&&e.length&&n.props.fetchedSegmentation(t.items)}))}))}l.profile_for_child&&!this.checkChild&&(this.checkChild=!0,this.setState({linesLength:2})),u&&u.length&&(l.email||l.phone)&&-1===l.tags.indexOf("web_v2main_tag")&&-1===l.tags.indexOf("web_v2main_tag_true")&&-1===l.tags.indexOf("web_v2main_tag_false")&&!this.loadV2Main&&(this.loadV2Main=!0,this.props.authTagsUpdate({tags:["web_v2main_tag"].concat((0,v.Z)(l.tags))})),u&&u.length&&-1!==l.tags.indexOf("web_v2main_tag")&&-1===l.tags.indexOf("web_v2main_tag_true")&&-1===l.tags.indexOf("web_v2main_tag_false")&&!this.loadV2MainTag&&(this.loadV2MainTag=!0,this.props.handleTags(l,this.props.registration.tags,"main",h,this.apiUrl)),u&&u.length&&-1!==l.tags.indexOf("web_v2main_tag_true")&&!this.loadV2MainTagData&&!l.profile_for_child?(this.loadV2MainTagData=!0,this.setState({v2:!0},(function(){n.loadData(p.ve.mainV2)}))):-1===l.tags.indexOf("web_v2main_tag_false")||this.loadV2MainTagData||(this.loadV2MainTagData=!0,this.setState({v2:!1},(function(){n.loadData(p.ve.main)}))),(l.email||l.phone)&&!l.profile_for_child||this.noAuth||(this.noAuth=!0,this.setState({v2:!1},(function(){n.loadData(p.ve.main)})))}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.handleScroll)}},{key:"render",value:function(){var t=this,e=this.props.profile,n=e.continueWatching,a=e.currentProfile,i=e.childProfile,o=e.favorites,c=this.props.registration.authData,s=this.props.startOriginals,l=s.tranding,u=s.segmentation,d=this.props.calendarData,p=this.state,f=p.lines,m=p.heroes,g=p.v2,_=!!(n&&n.items&&n.items.length>0),v=this.sortLikeMainAnswer(f&&f.length&&f.filter((function(t){return"originals"!==t.alias&&"continue_watching"!==t.alias}))),x=c&&(c.email||c.phone)&&_?3:2,w=a&&!1===a.child?x+(u&&u.length&&l&&l.length?3:u&&u.length||l&&l.length?2:1):0,Z=a&&!1===a.child?x+(u&&u.length&&l&&l.length?6:u&&u.length||l&&l.length?5:4):x+3,b=c&&(c.email||c.phone)&&o&&o.length?a&&!1===a.child?x+(u&&u.length&&l&&l.length?7:u&&u.length||l&&l.length?6:5):x+4:null,S=a&&!1===a.child?2:0;return v&&v.length||u&&u.length||l&&l.length?(0,r.jsxs)("div",{id:"main_v2","data-testid":"new_main",className:"".concat(I().main," ").concat(_?"":I().main__up),children:[u&&u.length&&!i?(0,r.jsx)("div",{className:I().main__line,id:"recommend",children:(0,r.jsx)(V.Z,{idx:"recommend",blockIdx:x,lineAlias:"recommend",lineTitle:this.props.t("main.recommend"),lineContent:u,lineTotalCount:u&&u.length,recommend:!0,arrowClick:this.arrowClick,getAllCards:this.getAllCards},"recommend_on_main")},"line_recommend"):null,l&&l.length&&!i?(0,r.jsx)("div",{className:I().main__line,id:"top-10-on-Start",children:(0,r.jsx)(V.Z,{idx:"top-10-on-Start",blockIdx:u&&u.length?x+1:x,lineAlias:"top-10-on-Start",lineTitle:this.props.t("main.top-10"),lineContent:l,lineTotalCount:l&&l.length,topTen:!0,arrowClick:this.arrowClick,getAllCards:this.getAllCards},"top-10-on-Start_on_main")},"line_top-10-on-Start"):null,v&&v.map((function(e,n){return e.items.length?(0,r.jsxs)(h.Fragment,{children:[i&&e.product_display_mode&&m&&0!==Object.keys(m).length?(0,r.jsx)(L.Z,{blockIdx:x,cw:_,heroes:m},"heroes_on_main_".concat(n)):e.product_display_mode?null:(0,r.jsx)("div",{className:I().main__line,id:e.alias,children:(0,r.jsx)(V.Z,{idx:e.alias,blockIdx:x+n+S,blockIdxCalendar:w,blockIdxCollection:Z,blockIdxFavorites:b,lineUrl:g?"/main/".concat(e.alias):e.url,lineAlias:e.alias,lineTitle:e.title,lineContent:e.items,lineTotalCount:g?e.items.length:e.items_total,getMoreCards:t.getMoreCards,getAllCards:t.getAllCards,v2:g,arrowClick:t.arrowClick,index:n},"".concat(e.alias,"_on_main_").concat(n))},"line_".concat(e.alias,"_").concat(n)),(0,r.jsx)("div",{className:"".concat(I().main__line," ").concat(I().main__calendar),id:"calendar_on_main",style:{touchAction:"manipulation"},children:(0,r.jsx)(C.Z,{blockIdx:w,data:d,render:0===n&&"ru"===P.Z.language&&!i&&d&&d.length},"calendar_on_main_".concat(n))},"calendar"),0!==n||i||!c||c.email||c.phone?null:(0,r.jsx)(M.Z,{id:"social_on_main"},"socialtext_on_main_".concat(n)),2===n&&"ru"===P.Z.language?(0,r.jsx)("div",{className:I().main__line,id:"collection_on_main",children:(0,r.jsx)(O.Z,{blockIdx:Z},"collection_on_main_".concat(n))},"collection_".concat(n)):null,2===n&&c&&(c.email||c.phone)&&"ru"===P.Z.language?(0,r.jsx)("div",{className:I().main__line,children:(0,r.jsx)(D.Z,{blockIdx:b},"favorites_on_main_".concat(n))},"favorites_".concat(n)):null]},"index_main_".concat(n)):null}))]}):null}}]),n}(h.Component),F=(0,Z.$j)((function(t){return{profile:t.profile,registration:t.registration,startOriginals:t.startOriginals,systemInformation:t.systemInformation}}),W)((0,b.Z)()(B)),q=n(54097),z=n(78896);function G(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=(0,d.Z)(t);if(e){var i=(0,d.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.Z)(this,n)}}var X={authTagsUpdate:T.pv,handleTags:T.ZI},Y=function(t){(0,l.Z)(n,t);var e=G(n);function n(){var t;(0,c.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),(0,w.Z)((0,x.Z)(t),"state",{v2:null}),(0,w.Z)((0,x.Z)(t),"loadTags",!1),(0,w.Z)((0,x.Z)(t),"loadV2Main",!1),(0,w.Z)((0,x.Z)(t),"loadV2MainTag",!1),(0,w.Z)((0,x.Z)(t),"loadV2MainTagData",!1),(0,w.Z)((0,x.Z)(t),"noAuth",!1),(0,w.Z)((0,x.Z)(t),"apiUrl",t.props.systemInformation.API_URL||f.T5),t}return(0,s.Z)(n,[{key:"componentDidUpdate",value:function(){var t=this.props.registration,e=t.authData,n=t.tags,a=this.props.systemInformation.clickHouseData;e&&e.profile_id&&(n&&n.length&&(e.email||e.phone)&&-1===e.tags.indexOf("web_v2main_tag")&&-1===e.tags.indexOf("web_v2main_tag_true")&&-1===e.tags.indexOf("web_v2main_tag_false")&&!this.loadV2Main&&(this.loadV2Main=!0,this.props.authTagsUpdate({tags:["web_v2main_tag"].concat((0,v.Z)(e.tags))})),n&&n.length&&-1!==e.tags.indexOf("web_v2main_tag")&&-1===e.tags.indexOf("web_v2main_tag_true")&&-1===e.tags.indexOf("web_v2main_tag_false")&&!this.loadV2MainTag&&(this.loadV2MainTag=!0,this.props.handleTags(e,n,"main",a,this.apiUrl)),n&&n.length&&-1!==e.tags.indexOf("web_v2main_tag_true")&&!this.loadV2MainTagData&&!e.profile_for_child?(this.loadV2MainTagData=!0,this.setState({v2:!0})):-1===e.tags.indexOf("web_v2main_tag_false")||this.loadV2MainTagData||(this.loadV2MainTagData=!0,this.setState({v2:!1})),(!e.email&&!e.phone||e.profile_for_child||(e.email||e.phone)&&this.loadV2MainTag)&&!this.noAuth&&(this.noAuth=!0,this.setState({v2:!1})))}},{key:"render",value:function(){var t=this.props,e=t.calendarData,n=t.t,a=t.locale,i=this.props.registration.authData,o=this.state.v2,c=new Date;return(0,r.jsxs)(h.Fragment,{children:[(0,r.jsxs)(S.default,{children:[(0,r.jsx)("title",{children:n("meta.title")}),(0,r.jsx)("meta",{name:"title",content:n("meta.title")}),(0,r.jsx)("meta",{name:"description",content:n("meta.description")}),(0,r.jsx)("meta",{name:"keywords",content:n("meta.keywords")}),(0,r.jsx)("meta",{property:"og:title",content:n("meta.ogtitle")}),(0,r.jsx)("meta",{property:"og:description",content:n("meta.ogdescription")}),(0,r.jsx)("meta",{property:"vk:image",content:"https://start.ru/static/images/sharing.jpg"}),(0,r.jsx)("meta",{property:"og:image",content:"https://start.ru/static/images/sharing.jpg"}),(0,r.jsx)("link",{rel:"image_src",href:"https://start.ru/static/images/sharing.jpg"}),(0,r.jsx)("meta",{name:"mrc__share_title",content:n("meta.share")}),(0,r.jsx)("meta",{property:"og:site_name",content:"START.ru"}),(0,r.jsx)("meta",{property:"og:type",content:"website"}),(0,r.jsx)("meta",{property:"og:updated_time",content:c.toISOString()}),(0,r.jsx)("meta",{name:"apple-itunes-app",content:"app-id=1273218458"})]},"main-head"),(0,r.jsx)(y.Z,{locale:a},"main-newFeatured"),"ru"!==P.Z.language?null:(0,r.jsx)(z.Z,{},"updated-main-continue"),null===o?null:o&&i&&!i.profile_for_child?(0,r.jsx)(F,{calendarData:e,locale:a},"update-main-main_new"):(0,r.jsx)(q.Z,{calendarData:e,locale:a},"update-main-main_old")]})}}]),n}(h.Component),J=(0,Z.$j)((function(t){return{registration:t.registration,systemInformation:t.systemInformation}}),X)((0,b.Z)()(Y));function K(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=(0,d.Z)(t);if(e){var i=(0,d.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.Z)(this,n)}}var Q=function(t){(0,l.Z)(n,t);var e=K(n);function n(){return(0,c.Z)(this,n),e.apply(this,arguments)}return(0,s.Z)(n,[{key:"componentDidMount",value:function(){window.scrollTo(0,0)}},{key:"render",value:function(){var t=this.props,e=t.calendarData,n=t.locale;return(0,r.jsx)(J,{calendarData:e,locale:n},"index_index")}}],[{key:"getInitialProps",value:function(){var t=(0,o.Z)(i().mark((function t(e){var n,a,r,c,s,l,u,d,h,v,x,w,Z,b,S,y,k,T,j,C,O,D,L,M,V,A,I,P,R,U,E,W,$,N;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return S=e.req&&e.req.headers&&e.req.headers["geoip-country-code"]?"&geoip_cc=".concat(e.req.headers["geoip-country-code"]):"",y=(null===(n=e.reduxStore.getState())||void 0===n||null===(a=n.systemInformation)||void 0===a?void 0:a.API_URL)||f.T5,k=(null===(r=e.reduxStore.getState())||void 0===r||null===(c=r.systemInformation)||void 0===c?void 0:c.locale)||(null===e||void 0===e||null===(s=e.query)||void 0===s?void 0:s.locale)||"ru",T="&locale=".concat(k),j="&content_lang=".concat(k),C="".concat(y).concat(p.ve.featured).concat(f.$h).concat(S,"&for_kids=false").concat(T).concat(j),t.next=8,fetch(C,{credentials:"include"});case 8:return O=t.sent,t.next=11,O.json();case 11:if(D=t.sent,L=null,"ru"!==k){t.next=20;break}return t.next=16,fetch("".concat(y).concat(p.ve.trending).concat(f.$h).concat(S).concat(T).concat(j),{credentials:"include"});case 16:return M=t.sent,t.next=19,M.json();case 19:L=t.sent;case 20:if(V=(null===(l=e.reduxStore.getState())||void 0===l||null===(u=l.registration)||void 0===u||null===(d=u.authData)||void 0===d?void 0:d.segmentation_id)||null,A=(null===(h=e.reduxStore.getState())||void 0===h||null===(v=h.startOriginals)||void 0===v||null===(x=v.segmentation)||void 0===x?void 0:x.length)||null,I=null,A||"ru"!==k){t.next=30;break}return t.next=26,fetch("".concat(y).concat(p.ve.segmentation).concat(V||f.mZ).concat(f.$h).concat(S),{credentials:"include"});case 26:return P=t.sent,t.next=29,P.json();case 29:I=t.sent;case 30:return t.next=32,fetch("".concat(y).concat(p.ve.calendar).concat(f.__).concat(S).concat(T).concat(j));case 32:if(R=t.sent,U=[],!(R.status<400)){t.next=38;break}return t.next=37,R.json();case 37:U=t.sent;case 38:if(E=null,null===(w=e.reduxStore.getState())||void 0===w||null===(Z=w.promoContent)||void 0===Z||null===(b=Z.promoContentData)||void 0===b||!b.length||"ru"!==k){t.next=49;break}return t.next=42,e.reduxStore.getState().promoContent.promoContentData.filter((function(t){return"featured"===t.display&&!1===t.for_kids})).sort((function(t,e){return t.position-e.position}));case 42:if(W=t.sent,E=e.reduxStore.getState().promoContent.promoContentData,!W||!W.length){t.next=47;break}return t.next=47,W.map(function(){var t=(0,o.Z)(i().mark((function t(e){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!==D.indexOf(e)){t.next=3;break}return t.next=3,D.splice(e.position,0,e);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 47:t.next=70;break;case 49:if("ru"!==k){t.next=70;break}return t.next=52,fetch("".concat(y).concat(p.ve.promoBanner).concat(f.$h).concat(S),{credentials:"include"});case 52:if(!(($=t.sent).status<400)){t.next=70;break}return t.prev=54,t.next=57,$.json();case 57:E=t.sent,t.next=63;break;case 60:t.prev=60,t.t0=t.catch(54),E=[];case 63:return t.next=65,E.filter((function(t){return"featured"===t.display&&!1===t.for_kids})).sort((function(t,e){return t.position-e.position}));case 65:if(!(N=t.sent)||!N.length){t.next=69;break}return t.next=69,N.map(function(){var t=(0,o.Z)(i().mark((function t(e){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!==D.indexOf(e)){t.next=3;break}return t.next=3,D.splice(e.position,0,e);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 69:e.reduxStore.dispatch((0,_.M)(E));case 70:return e.reduxStore.dispatch((0,g.d)(D)),e.reduxStore.dispatch((0,m.TV)(L&&L.items?L.items:[])),I&&I.items&&e.reduxStore.dispatch((0,m.iP)(I.items)),t.abrupt("return",{promoData:E,featuredData:D,calendarData:U,locale:k});case 74:case"end":return t.stop()}}),t,null,[[54,60]])})));return function(e){return t.apply(this,arguments)}}()}]),n}(h.Component)},78581:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(50554)}])}},function(t){t.O(0,[9774,4027,7925,3433,2090,7018,2191,569,8122,5080,5527,1688,3325,6592],(function(){return e=78581,t(t.s=e);var e}));var e=t.O();_N_E=e}]);