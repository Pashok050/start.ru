(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7966],{54569:function(t,e,n){"use strict";n.d(e,{gX:function(){return s},$5:function(){return c},fm:function(){return i}});var o=n(28261),a=n(7143),r=n(46119),s=function(t,e){var n=o.k$;if(t)n=t;else{var a=navigator.language||navigator.userLanguage;a=a.split("-")[0];var r=o.a2.find((function(t){var e;return t.option.toLowerCase()===(null===(e=a)||void 0===e?void 0:e.toLowerCase())}));if(r)n=r.option;else if(!r&&e){var s=o.a2.find((function(t){return t.locales.find((function(t){return t.toLowerCase()===e.toLowerCase()}))}));s?n=s.option:s||n===o.k$||(n=o.k$)}}return n},c=function(t,e,n,s,c,i){if(t&&e){var p=t.replace(a.Z.language,""),u=(p=(p=(p=p.replace(e,"")).replace("//","/")).replace("/kids","/")).split("/");-1!==o.lE.indexOf(u[1])&&(p=(p=p.replace(u[1],"")).replace("//","/")),"/"===p&&"ru"!==e?p="/".concat(e):"ru"!==e&&"/"!==p&&(p="/".concat(e).concat(p));var l=function(t,e){var n=window.location.origin;return-1!==window.location.origin.indexOf(e)&&"ru"!==t?n=window.location.origin.replace(e,".film"):-1===window.location.origin.indexOf(e)&&"ru"===t&&(n=window.location.origin.replace(".film",e)),n}(e,i),d="https://api.".concat(l.replace("https://","")).concat(r.ve.authRefresh).concat(o.$h,"&auth_token=").concat(n);"http://localhost:3000"===l&&(d="".concat(o.T5).concat(r.ve.authRefresh).concat(o.$h,"&auth_token=").concat(n)),fetch(d,{credentials:"include",method:"POST"}).then((function(t){t.status<400&&t.json().then((function(t){s(t);var e=t.devices&&t.devices.map((function(t){return"web"===t.type?t:null}));e&&e.length&&e[e.length-1]&&c(e[e.length-1].uid),window.location="".concat(l).concat(p)}))}))}},i=function(t){if(t)return t.charAt(0).toUpperCase()+t.slice(1)}},1640:function(t,e,n){"use strict";n.d(e,{u:function(){return o}});var o=function(t){return{type:"FETCH_PAYMENTS_LOAD",payload:t}}},54883:function(t,e,n){"use strict";n.d(e,{tM:function(){return p},uM:function(){return u},Nt:function(){return d},Yo:function(){return _},_5:function(){return f},hv:function(){return h},xm:function(){return g},TE:function(){return m},n_:function(){return b},pX:function(){return v},pi:function(){return y},Nc:function(){return P}});var o=n(46119),a=n(53921),r=n(28261),s=n(80569),c=n.n(s),i=n(7143);function p(t){return{type:"CURRENT_PROFILE_FULFILLED",payload:t}}function u(t){return{type:"SET_PROFILE_TYPE",payload:t}}function l(t){return{type:"PROFILE_FAVORITES_FULFILLED",payload:t}}function d(t){return{type:"PROFILE_LIST_FULFILLED",payload:t}}function _(t){return{type:"PROFILE_HISTORY_FULFILLED",payload:t}}function f(t){return{type:"PROFILE_SUBSCRIPTIONS_FULFILLED",payload:t}}function h(t){return{type:"PROFILE_PENDING_SUBSCRIPTIONS_FULFILLED",payload:t}}function g(t){return{type:"FETCH_AVATARS",payload:t}}function m(t){return{type:"FETCH_AVATARS_CHILD",payload:t}}function b(t){return{type:"FETCH_CONTENT_LANG",payload:t}}function v(t,e){return function(n){c().get(e+o.ve.favorites+t+"?apikey=a20b12b279f744f2b3c7b5c5400c4eb5&device_type=web").withCredentials().end((function(t,e){!t&&e&&e.status>=200&&e.status<500&&n({type:"PROFILE_FAVORITES_FULFILLED",payload:e.body})}))}}function y(t,e,n){var s="".concat(n).concat(o.ve.continueWatching).concat(r.$h),c="".concat(n).concat(o.ve.favorites).concat(t._id).concat(r.$h,"&device_type=web"),p="".concat(n).concat(o.ve.profileHostory).concat(t._id).concat(r.$h);return function(u){return fetch(c,{credentials:"include"}).then((function(t){return t.json()})).then((function(t){return u(l(t))})).catch((function(t){return u(l(t))})).then((function(){e&&(e.email||e.phone)&&fetch(s,{credentials:"include"}).then((function(t){return t.json()})).then((function(t){return u(function(t){return{type:"FETCH_CONTINUE_WATCHING_FULFILLED",payload:t}}(t))})).catch((function(t){return u(function(t){return{type:"FETCH_CONTINUE_WATCHING_REJECTED",payload:t}}(t))}))})).then((function(){return fetch(p,{method:"GET",credentials:"include"}).then((function(s){s.status<400&&s.json().then((function(s){return t.child||-1!==e.tags.indexOf("web_featuredrec_true")||u(function(t,e,n){if("ru"!==i.Z.language)return;return function(s){fetch("".concat(n).concat(o.ve.segmentation).concat(t.segmentation_id).concat(r.$h,"&device_type=web"),{method:"GET",credentials:"include"}).then((function(t){t.status<400&&t.json().then((function(t){var n=[],o=[];if(t&&t.items&&t.items.length){var r=e.filter((function(t){return t.progress>=95}));t.items.map((function(t){var e,a;(e=r,a=t.uid,e.filter((function(t){return a===t.content_uid})).length>0)?o.push(t):n.push(t)}))}var c=n.concat(o);s((0,a.iP)(c))}))}))}}(e,s,n)),u(_(s))}))}))}))}}function P(t,e){var n="".concat(e).concat(o.ve.profileHostory).concat(t).concat(r.$h);return function(t){return fetch(n,{method:"GET",credentials:"include"}).then((function(e){e.status<400&&e.json().then((function(e){return t(_(e))}))}))}}},418:function(t,e,n){"use strict";n.d(e,{Go:function(){return g},Wg:function(){return m},Zy:function(){return b},wm:function(){return v},wc:function(){return y},Tt:function(){return P},ZX:function(){return w},sd:function(){return k},HV:function(){return Z},$R:function(){return j},pv:function(){return x},lR:function(){return S},ZI:function(){return O},$3:function(){return E},iv:function(){return C}});var o=n(809),a=n.n(o),r=n(26265),s=n(92447),c=n(46119),i=n(28261),p=n(55877),u=n.n(p),l=n(88495),d=n.n(l),_=n(6831);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){(0,r.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t){return{type:"SET_CONFIRM_PAYMENT_FULFILLED",payload:t}}function m(){return{type:"AUTH_REFRESH_RESET"}}function b(){return{type:"RESET_AUTH_LOGIN_STATUS"}}function v(t){return{type:"SET_EMAIL_TO_RECOVER",payload:t}}function y(t){return{type:"AUTH_REFRESH_FULFILLED",payload:t}}function P(t){return{type:"SET_START_DEVICE",payload:t}}function w(t){return{type:"GET_TARIFF_FULFILLED",payload:t}}function k(t){return{type:"UPDATE_GDPR_STATUS",payload:t}}function Z(t){return{type:"CONFIRM_SPAM_FULFILLED",payload:t}}function j(t){return{type:"PASSWORD_CONFIRM_STATUS",payload:t}}function x(t){return{type:"AUTH_TAGS_UPDATE",payload:t||{tags:[]}}}function S(t){return{type:"AUTH_LANGUAGES_UPDATE",payload:t}}function D(){return(D=(0,s.Z)(a().mark((function t(e,n,o,r,s,p){var u;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i.XZ.push(s),u=p+(1===n?c.ve.tagsAdd:c.ve.tagsRemove)+i.$h,t.next=4,fetch(u,{credentials:"include",method:1===n?"POST":"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(t){t.status<400&&t.json().then((function(t){if(t&&t.tags&&t.tags.length&&o(x(t)),1===n){var a=h(h({},r),{},{action_id:"experiment_distribution",screen_attributes_ab_tag:e.tags[0],event_time:(new Date).getTime()});o((0,_.F7)(a))}if(s){var u="".concat(p).concat(c.ve.tagsRemove).concat(i.$h);fetch(u,{credentials:"include",method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({tags:[s]})}).then((function(t){t.status<400&&t.json().then((function(t){t&&t.tags&&t.tags.length&&o(x(t))}))}))}}))}));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(t,e,n,o,a){return function(r){t&&e&&e.length&&e.map((function(e){if(e.status){var s=e&&Array.isArray(e.initialization_screen)&&-1!==e.initialization_screen.indexOf(n)?e:null;if(!(s&&s.group_tags&&s.status&&-1===i.XZ.indexOf(s.initialization_tag)))return;var c=d()(t._id+s.experiment_name).slice(-2),p=parseInt(c,16)%s.group_tags.length,u=s.group_tags[p];t.tags&&t.tags.length&&t.tags.includes(s.initialization_tag)&&function(t,e,n,o,a,r){D.apply(this,arguments)}({tags:[u.name]},1,r,o,s.initialization_tag,a)}}))}}function E(t){var e="".concat(t).concat(c.ve.tags).concat(i.$h);return function(t){return fetch(e,{credentials:"include",method:"GET"}).then((function(e){e.status<400&&e.json().then((function(e){t(function(t){return{type:"FETCH_TAGS_FULFILLED",payload:t}}(e))})),t({type:"FETCH_TAGS_STATUS_FULFILLED",payload:e.status})}))}}function C(t){var e=t+c.ve.authRefresh+i.$h;return function(n){return fetch(e,{credentials:"include",method:"POST"}).then((function(e){if(e.status<400)e.json().then((function(t){var e=t.devices&&t.devices.map((function(t){return"web"===t.type?t:null}));return e&&e.length&&e[e.length-1]&&n(P(e[e.length-1].uid)),n(y(t))}));else{var o=u()();n(P(o));var a=t+c.ve.authDeviceLogin+i.$h,r={device_id:o,device_type:"web",traffic_source:window.location.search,is_child:"/kids"===window.location.pathname};fetch(a,{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((function(t){return t.json()})).then((function(t){n(y(t))})).catch((function(t){console.error(t)}))}})).catch((function(t){console.error(t)}))}}},53921:function(t,e,n){"use strict";function o(t){return{type:"FETCH_START_ORIGINALS_CONTENT_FULFILLED",payload:t,status:"success"}}function a(t){return{type:"FETCH_MAIN_V2_FULFILLED",payload:t}}function r(t){return{type:"FETCH_SEGMENTATION_FULFILLED",payload:t}}function s(t){return{type:"FETCH_TRANDING_FULFILLED",payload:t}}n.d(e,{Aw:function(){return o},IA:function(){return a},iP:function(){return r},TV:function(){return s}})},82035:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return Nn}});var o=n(85893),a=n(74047),r=n(52700),s=n(4706),c=n(8127),i=n(44102),p=n(20775),u=n(26265),l=n(67294),d=n(53082),_=n(9008),f=n(6831),h=n(28261),g=n(58439),m=n(98848),b=n(26692),v=n(66261),y=n(27904),P=n(35273),w=n.n(P),k=n(96451),Z=n(7143);function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function S(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var D={clickHouseShoot:f.F7},O=function(t){(0,c.Z)(n,t);var e=S(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{browserwidth:0,offsetForScroll:-400}),(0,u.Z)((0,s.Z)(t),"resizeHandle",(function(){var e=t.state.browserwidth,n=window.innerWidth;e!==n&&t.setState({browserwidth:n,offsetForScroll:n>1440?n/1440*-400:-400})})),(0,u.Z)((0,s.Z)(t),"debounce",(function(t,e){var n;return function(){for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];n&&clearTimeout(n),n=setTimeout((function(){return t.apply(void 0,a)}),e)}})),(0,u.Z)((0,s.Z)(t),"sendEvent",(function(e,n){var o=x(x({},t.props.systemInformation.clickHouseData),{},{action_id:"click",event_time:(new Date).getTime(),element_type:"menu_item",element_attributes_id:e,element_attributes_text:n});t.props.clickHouseShoot(o)})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=this.state.browserwidth;window.addEventListener("resize",this.debounce(this.resizeHandle,100));var e=window.innerWidth;t!==e&&this.setState({browserwidth:e,offsetForScroll:e>1440?e/1440*-400:-400})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.debounce(this.resizeHandle,100))}},{key:"render",value:function(){var t=this,e=this.state.offsetForScroll;return(0,o.jsxs)("div",{className:w()["account-sidebar"],children:[(0,o.jsx)(v.rU,{spy:!0,smooth:!0,duration:500,offset:e+10,to:"personal_data",className:w()["account-sidebar__item"],activeClass:w()["account-sidebar__item-active"],onClick:function(){return t.sendEvent("personal_data",t.props.t("settingsaccountsidebar.personal-data"))},children:this.props.t("settingsaccountsidebar.personal-data")}),(0,o.jsx)(v.rU,{spy:!0,smooth:!0,duration:500,offset:e+10,to:"account",className:w()["account-sidebar__item"],activeClass:w()["account-sidebar__item-active"],onClick:function(){return t.sendEvent("account",t.props.t("settingsaccountsidebar.account"))},children:this.props.t("settingsaccountsidebar.account")}),(0,o.jsx)(v.rU,{spy:!0,smooth:!0,duration:500,offset:e+10,to:"profile",className:w()["account-sidebar__item"],activeClass:w()["account-sidebar__item-active"],onClick:function(){return t.sendEvent("profiles",t.props.t("settingsaccountsidebar.users"))},children:this.props.t("settingsaccountsidebar.users")}),(0,o.jsx)(v.rU,{spy:!0,smooth:!0,duration:500,offset:e+10,to:"subscription",className:w()["account-sidebar__item"],activeClass:w()["account-sidebar__item-active"],onClick:function(){return t.sendEvent("subscriptions",t.props.t("settingsaccountsidebar.subscription"))},children:this.props.t("settingsaccountsidebar.subscription")}),(0,o.jsx)(y.Link,{route:"".concat("ru"!==Z.Z.language?"/".concat(Z.Z.language):"","/support"),children:(0,o.jsxs)("a",{className:w()["account-sidebar__button"],children:[this.props.t("support.support")," START"]})})]})}}]),n}(l.Component),E=(0,d.$j)((function(t){return{systemInformation:t.systemInformation}}),D)((0,k.Z)()(O)),C=n(46119),N=n(418),A=n(78777),I=n(42117),R=n(21380),T=n.n(R),L=n(61984);function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function U(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var F={toggleEmailPopup:A.Qj,authRefreshed:N.wc,accountChangeEmailPush:m.s$,accountEmailPush:m.ih,clickHouseShoot:f.F7},V=function(t){(0,c.Z)(n,t);var e=U(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"validationData",{"\u041f\u0430\u0440\u043e\u043b\u044c \u0431\u044b\u043b \u0432\u0432\u0435\u0434\u0451\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u043e.":t.props.t("settingsaccountemailpopup.wrong-password"),"Invalid password":t.props.t("settingsaccountemailpopup.wrong-password"),"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0442\u0430\u043a\u0438\u043c e-mail \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442.":t.props.t("settingsaccountemailpopup.email-exist"),EMAIL_ALREADY_EXISTS:t.props.t("settingsaccountemailpopup.email-exist"),EMAIL_ALREADY_USED:t.props.t("settingsaccountemailpopup.email-exist"),"\u0412\u0430\u0448 e-mail \u0430\u043a\u0442\u0443\u0430\u043b\u0435\u043d.":t.props.t("settingsaccountemailpopup.old-email"),INVALID_PASSWORD:t.props.t("settingsaccountemailpopup.wrong-password")}),(0,u.Z)((0,s.Z)(t),"state",{email:t.props.registration.authData&&t.props.registration.authData.email||"",password:"",emailIsValid:!0,passwordIsValid:!0,emailIsEmpty:!1,passwordIsEmpty:!1,emailError:!1,emailErrorMsg:"",passwordErrorMsg:"",blockInfo:{block_type:"popup",block_attributes_id:"change_email"},loading:!1}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"setEmailHandler",(function(e){t.setState({email:e.target.value,emailError:!1,emailErrorMsg:"",passwordIsEmpty:!1,passwordErrorMsg:""})})),(0,u.Z)((0,s.Z)(t),"setPasswordHandler",(function(e){t.setState({password:e.target.value,emailError:!1,emailErrorMsg:"",passwordIsEmpty:!1,passwordErrorMsg:""})})),(0,u.Z)((0,s.Z)(t),"checkValidate",(function(e,n){switch(n){case"email":t.setState({emailIsValid:e});break;case"password":t.setState({passwordIsValid:e})}})),(0,u.Z)((0,s.Z)(t),"sendEvents",(function(e,n,o){var a=M(M({},t.props.systemInformation.clickHouseData),{},{action_id:"click",block_type:"popup",block_attributes_id:"change_email",element_type:e||"",element_attributes_id:n||"",element_attributes_text:o||"",event_time:(new Date).getTime()});t.props.clickHouseShoot(a)})),(0,u.Z)((0,s.Z)(t),"handleSubmitClick",(function(){var e=t.state,n=e.emailIsValid,o=e.passwordIsValid,a=e.email,r=e.password,s=t.props.registration.authData;if(t.sendEvents("button",s&&s.email?"change":"add",s&&s.email?t.props.t("settingsaccountemailpopup.change"):t.props.t("settingsaccountemailpopup.add")),a&&r){if(n&&o){var c=s&&s.email,i=c?{email_new:a,password:btoa(unescape(encodeURIComponent(r)))}:{email:a,password:btoa(unescape(encodeURIComponent(r)))},p="".concat(t.apiUrl).concat(C.ve[c?"changeEmail":"addEmail"]).concat(h.$h);t.setState({loading:!0}),fetch(p,{method:c?"PUT":"POST",credentials:"include",body:JSON.stringify(i),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){t.setState({loading:!1}),e.status<400?e.json().then((function(e){e.msg&&"e-mail \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u0437\u043c\u0435\u043d\u0451\u043d."!==e.msg?t.setError(e):(s&&s.email&&e.auth_data&&e.auth_data.email?t.props.accountChangeEmailPush(!0):t.props.accountEmailPush(!0),t.props.authRefreshed(e&&e.auth_data||e),t.closeHandler())})):e.json().then((function(e){t.setError(e)}))}))}}else t.setState({emailIsEmpty:!a,emailErrorMsg:t.props.t("settingsaccountemailpopup.forgot-email"),passwordIsEmpty:!r,passwordErrorMsg:r?"":t.props.t("settingsaccountemailpopup.few-characters")})})),(0,u.Z)((0,s.Z)(t),"setError",(function(e){t.setState({emailError:!0,emailErrorMsg:"",passwordIsEmpty:!0,passwordErrorMsg:t.validationData[e.msg]||t.validationData[e.code]||t.validationData[e.message]||e.msg||e.message})})),(0,u.Z)((0,s.Z)(t),"closeHandler",(function(e,n,o){t.sendEvents(e,n,o),t.props.toggleEmailPopup(!1)})),(0,u.Z)((0,s.Z)(t),"handleKeyDown",(function(e){27===e.keyCode&&t.closeHandler(),13===e.keyCode&&t.handleSubmitClick()})),(0,u.Z)((0,s.Z)(t),"handleClickOutside",(function(e){t.popupWrapper&&!t.popupWrapper.contains(e.target)&&t.closeHandler()})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=M(M({},this.props.systemInformation.clickHouseData),{},{action_id:"popupview",block_type:"popup",block_attributes_id:"change_email",event_time:(new Date).getTime()});this.props.clickHouseShoot(t)}},{key:"render",value:function(){var t=this,e=this.state,n=e.email,a=e.password,r=e.emailIsEmpty,s=e.passwordIsEmpty,c=e.emailError,i=e.emailErrorMsg,p=e.blockInfo,u=e.passwordErrorMsg,l=e.loading,d=this.props.registration.authData;return(0,o.jsx)("div",{className:T()["start-popup"],onMouseDown:this.handleClickOutside,onKeyDown:this.handleKeyDown,children:(0,o.jsxs)("div",{className:T()["start-popup__wrapper"],ref:function(e){t.popupWrapper=e},children:[(0,o.jsx)("div",{className:T()["start-popup__close"],onClick:function(){return t.closeHandler("button","cross")},children:(0,o.jsx)("img",{src:"/static/images/popups/cross.svg"})}),(0,o.jsxs)("div",{className:T()["start-popup__content"],children:[(0,o.jsx)("div",{className:T()["start-popup__title"],children:d&&d.email?this.props.t("settingsaccountemailpopup.change-email"):this.props.t("settingsaccountemailpopup.add-email")}),(0,o.jsx)(I.Z,{value:n,label:d&&d.email?this.props.t("settingsaccountemailpopup.enter-email"):this.props.t("settingsaccountemailpopup.enter-your-email"),onChange:this.setEmailHandler,onValidate:this.checkValidate,id:"email",maxLengthForEmail:254,type:"text",validationType:"email",error:r||c,errorText:i,blockInfo:p,testid:"popup_email_mail"}),(0,o.jsx)(I.Z,{value:a,label:this.props.t("settingsaccountemailpopup.enter-password"),onChange:this.setPasswordHandler,onValidate:this.checkValidate,id:"password",maxLength:"50",type:"password",error:s,errorText:u,blockInfo:p,testid:"popup_email_password",canHidePassword:!0})]}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-red"]),onClick:this.handleSubmitClick,"data-testid":"popup_email_save",children:l?(0,o.jsx)(L.Z,{}):d&&d.email?this.props.t("settingsaccountemailpopup.change"):this.props.t("settingsaccountemailpopup.add")}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-stroke"]),onClick:function(){return t.closeHandler("button","cancel",t.props.t("settingsaccountemailpopup.cancel"))},"data-testid":"popup_email_cancel",children:this.props.t("settingsaccountemailpopup.cancel")})]})})}}]),n}(l.Component),W=(0,d.$j)((function(t){return{registration:t.registration,systemInformation:t.systemInformation}}),F)((0,k.Z)()(V));function G(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?G(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function B(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var K={togglePasswordPopup:A.z,accountChangePasswordPush:m.ow,authRefreshed:N.wc,clickHouseShoot:f.F7},J=function(t){(0,c.Z)(n,t);var e=B(n);function n(t){var o;return(0,a.Z)(this,n),o=e.call(this,t),(0,u.Z)((0,s.Z)(o),"checkValidate",(function(t,e){var n=o.state,a=n.oldPassword,r=n.newPassword,s=n.repeatPassword;switch(e){case"oldPassword":o.setState({oldPasswordError:!t,oldPasswordMessage:!t&&a.length<6?o.props.t("settingsaccountpasswordpopup.few-characters"):!t&&a.length>60?o.props.t("settingsaccountpasswordpopup.max-length"):""});break;case"newPassword":o.setState({newPasswordError:!t,newPasswordMessage:!t&&r.length<6?o.props.t("settingsaccountpasswordpopup.few-characters"):!t&&r.length>60?o.props.t("settingsaccountpasswordpopup.max-length"):""});break;case"repeatPassword":o.setState({repeatPasswordError:!t,repeatPasswordMessage:!t&&s.length<6?o.props.t("settingsaccountpasswordpopup.few-characters"):!t&&s.length>60?o.props.t("settingsaccountpasswordpopup.max-length"):""})}})),(0,u.Z)((0,s.Z)(o),"closeHandler",(function(t,e,n){o.sendEvents(t,e,n),o.props.togglePasswordPopup(!1)})),(0,u.Z)((0,s.Z)(o),"handleOldPasswordInput",(function(t){o.setState({oldPassword:t.target.value,oldPasswordError:!1,oldPasswordMessage:""})})),(0,u.Z)((0,s.Z)(o),"handleNewPasswordInput",(function(t){o.setState({newPassword:t.target.value,newPasswordError:!1,newPasswordMessage:"",repeatPasswordError:!1,repeatPasswordMessage:""})})),(0,u.Z)((0,s.Z)(o),"handleRepeatPasswordInput",(function(t){o.setState({repeatPassword:t.target.value,repeatPasswordError:!1,repeatPasswordMessage:"",newPasswordError:!1,newPasswordMessage:""})})),(0,u.Z)((0,s.Z)(o),"sendEvents",(function(t,e,n){var a=$($({},o.props.systemInformation.clickHouseData),{},{action_id:"click",block_type:"popup",block_attributes_id:"change_password",element_type:t||"",element_attributes_id:e||"",element_attributes_text:n||"",event_time:(new Date).getTime()});o.props.clickHouseShoot(a)})),(0,u.Z)((0,s.Z)(o),"submitHandler",(function(){var t=o.state,e=t.oldPassword,n=t.newPassword,a=t.repeatPassword,r=t.oldPasswordMessage,s=t.newPasswordMessage,c=t.repeatPasswordMessage,i=t.oldPasswordError,p=t.newPasswordError,u=t.repeatPasswordError;if(o.sendEvents("button","change",o.props.t("settingsaccountpasswordpopup.change")),e&&n&&a)if(e.length>60||n.length>60||a.length>60)o.setState({oldPasswordError:!e,oldPasswordMessage:e?r:o.props.t("settingsaccountpasswordpopup.max-length"),newPasswordError:!n,newPasswordMessage:n?s:o.props.t("settingsaccountpasswordpopup.max-length"),repeatPasswordError:!a,repeatPasswordMessage:a?c:o.props.t("settingsaccountpasswordpopup.max-length")});else if(n===a){if(!i&&!p&&!u){var l={password:btoa(unescape(encodeURIComponent(e))),new_password:btoa(unescape(encodeURIComponent(n)))},d="".concat(o.apiUrl).concat(C.ve.passwordChange).concat(h.$h);o.setState({loading:!0}),fetch(d,{method:"PUT",credentials:"include",body:JSON.stringify(l),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(t){o.setState({loading:!1}),t.status<400?t.json().then((function(t){o.props.authRefreshed(t),o.closeHandler(),o.props.accountChangePasswordPush(!0)})):t.json().then((function(t){switch(t.message){case"Invalid password":case"INVALID_PASSWORD":o.setState({oldPasswordError:!0,oldPasswordMessage:o.props.t("settingsaccountpasswordpopup.doesnt-add-up")});break;case"New password is the same as old one":o.setState({newPasswordError:!0,repeatPasswordError:!0,repeatPasswordMessage:o.props.t("settingsaccountpasswordpopup.new-as-old")})}}))}))}}else o.setState({repeatPasswordError:!0,repeatPasswordMessage:o.props.t("settingsaccountpasswordpopup.try-again")});else o.setState({oldPasswordError:!e,oldPasswordMessage:e?r:o.props.t("settingsaccountpasswordpopup.few-characters"),newPasswordError:!n,newPasswordMessage:n?s:o.props.t("settingsaccountpasswordpopup.few-characters"),repeatPasswordError:!a,repeatPasswordMessage:a?c:o.props.t("settingsaccountpasswordpopup.few-characters")})})),(0,u.Z)((0,s.Z)(o),"handleKeyDown",(function(t){27===t.keyCode&&o.closeHandler(),13===t.keyCode&&o.submitHandler()})),(0,u.Z)((0,s.Z)(o),"handleClickOutside",(function(t){o.popupWrapper&&!o.popupWrapper.contains(t.target)&&o.closeHandler()})),o.state={oldPassword:"",newPassword:"",repeatPassword:"",oldPasswordError:!1,newPasswordError:!1,repeatPasswordError:!1,oldPasswordMessage:"",newPasswordMessage:"",repeatPasswordMessage:"",blockInfo:{block_type:"popup",block_attributes_id:"change_password"},loading:!1},o.getResponse=!1,o.apiUrl=t.systemInformation.API_URL||h.T5,o}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=$($({},this.props.systemInformation.clickHouseData),{},{action_id:"popupview",block_type:"popup",block_attributes_id:"change_password",event_time:(new Date).getTime()});this.props.clickHouseShoot(t)}},{key:"render",value:function(){var t=this,e=this.state,n=e.oldPassword,a=e.newPassword,r=e.repeatPassword,s=e.oldPasswordError,c=e.newPasswordError,i=e.repeatPasswordError,p=e.oldPasswordMessage,u=e.newPasswordMessage,l=e.repeatPasswordMessage,d=e.blockInfo,_=e.loading;return(0,o.jsx)("div",{className:T()["start-popup"],onMouseDown:this.handleClickOutside,onKeyDown:this.handleKeyDown,children:(0,o.jsxs)("div",{className:T()["start-popup__wrapper"],ref:function(e){t.popupWrapper=e},children:[(0,o.jsx)("div",{className:T()["start-popup__close"],onClick:function(){return t.closeHandler("button","cross")},children:(0,o.jsx)("img",{src:"/static/images/popups/cross.svg"})}),(0,o.jsxs)("div",{className:T()["start-popup__content"],children:[(0,o.jsx)("div",{className:T()["start-popup__title"],children:this.props.t("settingsaccountpasswordpopup.change-pass")}),(0,o.jsx)(I.Z,{value:n,label:this.props.t("settingsaccountpasswordpopup.enter-cur-pass"),onChange:this.handleOldPasswordInput,onValidate:this.checkValidate,id:"oldPassword",type:"password",error:s,errorText:p,blockInfo:d,canHidePassword:!0,maxLenght:"60"}),(0,o.jsx)(I.Z,{value:a,label:this.props.t("settingsaccountpasswordpopup.enter-new-pass"),onChange:this.handleNewPasswordInput,onValidate:this.checkValidate,id:"newPassword",type:"password",hint:this.props.t("settingsaccountpasswordpopup.at-least-6"),error:c,errorText:u,blockInfo:d,maxLenght:"60",canHidePassword:!0}),(0,o.jsx)(I.Z,{value:r,label:this.props.t("settingsaccountpasswordpopup.enter-password-again"),onChange:this.handleRepeatPasswordInput,onValidate:this.checkValidate,id:"repeatPassword",type:"password",error:i,errorText:l,blockInfo:d,maxLenght:"60",canHidePassword:!0})]}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-red"]),onClick:this.submitHandler,"data-testid":"popup_password_save",children:_?(0,o.jsx)(L.Z,{}):this.props.t("settingsaccountpasswordpopup.change")}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-stroke"]),onClick:function(){return t.closeHandler("button","cancel",t.props.t("settingsaccountpasswordpopup.cancel"))},"data-testid":"popup_password_cancel",children:this.props.t("settingsaccountpasswordpopup.cancel")})]})})}}]),n}(l.Component),z=(0,d.$j)((function(t){return{systemInformation:t.systemInformation}}),K)((0,k.Z)()(J));function Y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function X(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Y(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function q(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var Q={togglePhonePopup:A.Xs,toggleConfirmPhonePopup:A.M_,authRefreshed:N.wc,clickHouseShoot:f.F7},tt=function(t){(0,c.Z)(n,t);var e=q(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"errors",{CODE_NOT_FOUND:t.props.t("settingsaccountphonepopup.CODE_NOT_FOUND"),PHONE_ALREADY_USED:t.props.t("settingsaccountphonepopup.PHONE_ALREADY_USED"),PHONE_NOT_CHANGED:t.props.t("settingsaccountphonepopup.PHONE_NOT_CHANGED"),INVALID_PASSWORD:t.props.t("settingsaccountphonepopup.INVALID_PASSWORD"),WRONG_USER:t.props.t("settingsaccountphonepopup.WRONG_USER"),"Maximum number of SMS messages was sent in last hour":t.props.t("settingsaccountphonepopup.Maximum number of SMS messages was sent in last hour"),"User has already been registered":t.props.t("settingsaccountphonepopup.User has already been registered"),SMS_SEND_DISABLED:t.props.t("settingsaccountphonepopup.SMS_SEND_DISABLED"),SMS_SERVER_ERROR:t.props.t("settingsaccountphonepopup.SMS_SERVER_ERROR"),SMS_LIMIT_EXCEEDED:t.props.t("settingsaccountphonepopup.SMS_LIMIT_EXCEEDED"),"Email has wrong format":t.props.t("settingsaccountphonepopup.Email has wrong format"),"Phone number is invalid.":t.props.t("settingsaccountphonepopup.Phone number is invalid.")}),(0,u.Z)((0,s.Z)(t),"state",{phone:t.props.registration.authData&&t.props.registration.authData.phone||"",password:"",phoneError:!1,phoneErrorMessage:"",passwordError:!1,passwordErrorMessage:"",blockInfo:{block_type:"popup",block_attributes_id:"change_phone"}}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"sendEvents",(function(e,n,o){var a=X(X({},t.props.systemInformation.clickHouseData),{},{action_id:"click",block_type:"popup",block_attributes_id:"change_phone",element_type:e||"",element_attributes_id:n||"",element_attributes_text:o||"",event_time:(new Date).getTime()});t.props.clickHouseShoot(a)})),(0,u.Z)((0,s.Z)(t),"setPhoneHandler",(function(e){t.setState({phone:e.target.value,phoneError:!1,phoneErrorMessage:"",passwordError:!1,passwordErrorMessage:""})})),(0,u.Z)((0,s.Z)(t),"setPasswordHandler",(function(e){t.setState({password:e.target.value,passwordError:!1,passwordErrorMessage:"",phoneError:!1,phoneErrorMessage:""})})),(0,u.Z)((0,s.Z)(t),"checkValidate",(function(e,n,o){var a=t.state,r=a.password,s=a.phone,c=t.props.t;switch(n){case"phone":s&&"+"!==s[0]||s&&s.length>1&&"7"!==s[1]||s&&s.length>2&&"9"!==s[2]?t.setState({phoneError:!0,phoneErrorMessage:c("passwordrecovery.error-phone")}):t.setState({phoneError:!e,phoneErrorMessage:!e&&o?o:""});break;case"password":t.setState({passwordError:!e,passwordErrorMessage:!e&&r.length<6?t.props.t("settingsaccountphonepopup.few-characters"):""})}})),(0,u.Z)((0,s.Z)(t),"handleInputBlur",(function(){var e=t.state.phone;e.length<11||!(0,h.Y0)(e)?t.setState({phoneError:!0,phoneErrorMessage:t.errors["Phone number is invalid."]}):"+79"!==e.slice(0,3)&&"89"!==e.slice(0,2)&&"79"!==e.slice(0,2)?t.setState({phoneError:!0,phoneErrorMessage:t.props.t("settingsaccountphonepopup.russian-phone")}):t.setState({phoneError:!1,phoneErrorMessage:""})})),(0,u.Z)((0,s.Z)(t),"handleSubmitClick",(function(){var e=t.state,n=e.phone,o=e.password,a=e.phoneErrorMessage,r=e.passwordErrorMessage,s=e.phoneError,c=e.passwordError,i=t.props.registration.authData;if(t.sendEvents("button",i&&i.phone?"change":"add",i&&i.phone?t.props.t("settingsaccountphonepopup.change"):t.props.t("settingsaccountphonepopup.add")),n.length<11||!(0,h.Y0)(n))t.setState({phoneError:!0,phoneErrorMessage:t.props.t("settingsaccountphonepopup.Phone number is invalid.")});else if("+79"!==n.slice(0,3)&&"89"!==n.slice(0,2)&&"79"!==n.slice(0,2))t.setState({phoneError:!0,phoneErrorMessage:t.props.t("settingsaccountphonepopup.russian-phone")});else{if(!n||!o)return void t.setState({phoneError:!n,phoneErrorMessage:n?a:t.props.t("settingsaccountphonepopup.forgot-phone"),passwordError:!o,passwordErrorMessage:o?r:t.props.t("settingsaccountphonepopup.few-characters")});if(!s&&!c&&!a&&!r){var p={phone_new:n,password:btoa(unescape(encodeURIComponent(o)))},u="".concat(t.apiUrl).concat(C.ve.changePhone).concat(h.$h);t.setState({loading:!0}),fetch(u,{method:"POST",credentials:"include",body:JSON.stringify(p),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){t.setState({loading:!1}),e.status<400?(e.json().then((function(e){e.phone&&e.authentication_token&&t.props.authRefreshed(e)})),t.closeHandler(),t.props.toggleConfirmPhonePopup({phoneForConfirm:n,toggle:!0})):e.json().then((function(e){t.setState({phoneIsEmpty:!0,passwordIsEmpty:!0,phoneError:!0,phoneErrorMessage:"",passwordError:!0,passwordErrorMessage:t.errors[e.code]||t.errors[e.message]||e.message||t.errors[e.details&&e.details.phone_new]||t.props.t("settingsaccountphonepopup.something-wrong")})}))}))}}})),(0,u.Z)((0,s.Z)(t),"closeHandler",(function(e,n,o){t.sendEvents(e,n,o),t.props.togglePhonePopup(!1)})),(0,u.Z)((0,s.Z)(t),"handleKeyDown",(function(e){27===e.keyCode&&t.closeHandler(),13===e.keyCode&&t.handleSubmitClick()})),(0,u.Z)((0,s.Z)(t),"handleClickOutside",(function(e){t.popupWrapper&&!t.popupWrapper.contains(e.target)&&t.closeHandler()})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=X(X({},this.props.systemInformation.clickHouseData),{},{action_id:"popupview",block_type:"popup",block_attributes_id:"change_phone",event_time:(new Date).getTime()});this.props.clickHouseShoot(t)}},{key:"render",value:function(){var t=this,e=this.state,n=e.phone,a=e.password,r=e.phoneError,s=e.phoneErrorMessage,c=e.passwordError,i=e.passwordErrorMessage,p=e.blockInfo,u=e.loading,l=this.props.registration.authData;return(0,o.jsx)("div",{className:T()["start-popup"],onMouseDown:this.handleClickOutside,onKeyDown:this.handleKeyDown,children:(0,o.jsxs)("div",{className:T()["start-popup__wrapper"],ref:function(e){t.popupWrapper=e},children:[(0,o.jsx)("div",{className:T()["start-popup__close"],onClick:function(){return t.closeHandler("button","cross")},children:(0,o.jsx)("img",{src:"/static/images/popups/cross.svg"})}),(0,o.jsxs)("div",{className:T()["start-popup__content"],children:[(0,o.jsx)("div",{className:T()["start-popup__title"],children:l&&l.phone?this.props.t("settingsaccountphonepopup.change-phone"):this.props.t("settingsaccountphonepopup.add-phone")}),(0,o.jsx)(I.Z,{value:n,label:l&&l.phone?this.props.t("settingsaccountphonepopup.enter-new-phone"):this.props.t("settingsaccountphonepopup.enter-phone"),onChange:this.setPhoneHandler,onBlur:this.handleInputBlur,onValidate:this.checkValidate,id:"phone",maxLength:"12",type:"tel",error:r,errorText:s,blockInfo:p,autoComplete:"mobile tel"}),(0,o.jsx)(I.Z,{value:a,label:this.props.t("settingsaccountphonepopup.enter-account-pass"),onChange:this.setPasswordHandler,onValidate:this.checkValidate,id:"password",maxLength:"50",type:"password",error:c,errorText:i,blockInfo:p,autoComplete:"new-password",canHidePassword:!0})]}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-red"]),onClick:this.handleSubmitClick,"data-testid":"popup_change_phone_save",children:u?(0,o.jsx)(L.Z,{}):l&&l.phone?this.props.t("settingsaccountphonepopup.change"):this.props.t("settingsaccountphonepopup.add")}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-stroke"]),onClick:function(){return t.closeHandler("button","cancel",t.props.t("settingsaccountphonepopup.cancel"))},"data-testid":"popup_change_phone_cancel",children:this.props.t("settingsaccountphonepopup.cancel")})]})})}}]),n}(l.Component),et=(0,d.$j)((function(t){return{toggle:t.toggle,profile:t.profile,systemInformation:t.systemInformation,registration:t.registration}}),Q)((0,k.Z)()(tt));function nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ot(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function at(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var rt={togglePhonePopup:A.Xs,toggleConfirmPhonePopup:A.M_,accountChangePhonePush:m.sl,accountAddPhonePush:m.zN,clickHouseShoot:f.F7,authRefreshed:N.wc},st=function(t){(0,c.Z)(n,t);var e=at(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"errors",{CODE_NOT_FOUND:t.props.t("settingsaccountconfirmpopup.CODE_NOT_FOUND"),PHONE_ALREADY_USED:t.props.t("settingsaccountconfirmpopup.PHONE_ALREADY_USED"),WRONG_USER:t.props.t("settingsaccountconfirmpopup.WRONG_USER")}),(0,u.Z)((0,s.Z)(t),"state",{code:"",codeError:!1,codeErrorMessage:"",submited:!1,blockInfo:{block_type:"popup",block_attributes_id:"code_sms"}}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"sendEvents",(function(e,n,o,a){var r=t.props.systemInformation.clickHouseData,s=t.state.code,c=ot(ot({},r),{},{action_id:a?"popupview":"click",action_result:s,block_type:"popup",block_attributes_id:"code_sms",element_type:e||"",element_attributes_id:n||"",element_attributes_text:o||"",event_time:(new Date).getTime()});t.props.clickHouseShoot(c)})),(0,u.Z)((0,s.Z)(t),"changeCodeHandler",(function(e){t.setState({code:e.target.value,codeError:!1,codeErrorMessage:""})})),(0,u.Z)((0,s.Z)(t),"checkValidate",(function(e,n){switch(n){case"code":t.setState({codeError:!e})}})),(0,u.Z)((0,s.Z)(t),"handleSubmitClick",(function(){var e=t.state,n=e.code,o=e.codeError;if(!e.submited){var a=t.props.toggle.phoneForConfirm;if(t.sendEvents("button","save",t.props.t("settingsaccountconfirmpopup.save")),n){if(!o){var r={phone:a,code:n},s="".concat(t.apiUrl).concat(C.ve.confirmPhone).concat(h.$h);t.setState({submited:!0},(function(){fetch(s,{method:"POST",credentials:"include",body:JSON.stringify(r),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){t.setState({submited:!1},(function(){e.status<400?e.json().then((function(e){t.closeHandler(),e.phone&&e.authentication_token?(t.props.accountChangePhonePush(!0),t.props.authRefreshed(e)):t.props.accountAddPhonePush(!0)})):e.json().then((function(e){t.setState({codeError:!0,codeErrorMessage:t.errors[e.code]||e.msg})}))}))}))}))}}else t.setState({codeError:!0,codeErrorMessage:t.props.t("settingsaccountconfirmpopup.forgot-code")})}})),(0,u.Z)((0,s.Z)(t),"closeHandler",(function(e,n,o){t.sendEvents(e,n,o),t.props.toggleConfirmPhonePopup(!1)})),(0,u.Z)((0,s.Z)(t),"handleKeyDown",(function(e){27===e.keyCode&&t.closeHandler(),13===e.keyCode&&t.handleSubmitClick()})),(0,u.Z)((0,s.Z)(t),"handleClickOutside",(function(e){t.popupWrapper&&!t.popupWrapper.contains(e.target)&&t.closeHandler()})),(0,u.Z)((0,s.Z)(t),"handleBlur",(function(){t.state.code||t.setState({codeError:!0,codeErrorMessage:t.props.t("settingsaccountconfirmpopup.forgot-code")})})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){this.sendEvents(null,null,null,!0)}},{key:"render",value:function(){var t=this,e=this.state,n=e.code,a=e.codeError,r=e.codeErrorMessage,s=e.blockInfo,c=e.submited;return(0,o.jsx)("div",{className:T()["start-popup"],onMouseDown:this.handleClickOutside,onKeyDown:this.handleKeyDown,children:(0,o.jsxs)("div",{className:T()["start-popup__wrapper"],ref:function(e){t.popupWrapper=e},children:[(0,o.jsx)("div",{className:T()["start-popup__close"],onClick:function(){return t.closeHandler("button","cross")},children:(0,o.jsx)("img",{src:"/static/images/popups/cross.svg"})}),(0,o.jsxs)("div",{className:T()["start-popup__content"],children:[(0,o.jsx)("div",{className:T()["start-popup__title"],children:this.props.t("settingsaccountconfirmpopup.enter-code")}),(0,o.jsx)(I.Z,{value:n,label:this.props.t("settingsaccountconfirmpopup.enter-code"),onChange:this.changeCodeHandler,onValidate:this.checkValidate,id:"code",maxLength:"225",type:"text",error:a,onBlur:this.handleBlur,errorText:r,blockInfo:s,updatedType:"code"})]}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-red"]),onClick:this.handleSubmitClick,children:c?(0,o.jsx)(L.Z,{}):this.props.t("settingsaccountconfirmpopup.save")}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-stroke"]),onClick:function(){return t.closeHandler("button","cancel",t.props.t("settingsaccountconfirmpopup.cancel"))},children:this.props.t("settingsaccountconfirmpopup.cancel")})]})})}}]),n}(l.Component),ct=(0,d.$j)((function(t){return{toggle:t.toggle,registration:t.registration,systemInformation:t.systemInformation}}),rt)((0,k.Z)()(st));function it(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?it(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ut(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var lt={authRefreshed:N.wc,clickHouseShoot:f.F7,toggleFacebookUnlinkPopup:A.Gu},dt=function(t){(0,c.Z)(n,t);var e=ut(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"errors",{INVALID_PASSWORD:t.props.t("settingsaccountfacebookpopup.INVALID_PASSWORD"),ACCOUNT_CONFLICT:t.props.t("settingsaccountfacebookpopup.ACCOUNT_CONFLICT"),FB_ERROR:t.props.t("settingsaccountfacebookpopup.FB_ERROR")}),(0,u.Z)((0,s.Z)(t),"state",{password:"",passwordError:!1,passwordErrorMessage:"",blockInfo:{block_type:"popup",block_attributes_id:"facebook_unlink"},spinner:!1}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"sendEvents",(function(e,n,o){var a=pt(pt({},t.props.systemInformation.clickHouseData),{},{action_id:"click",block_type:"popup",block_attributes_id:"facebook_unlink",element_type:e||"",element_attributes_id:n||"",element_attributes_text:o||"",event_time:(new Date).getTime()});t.props.clickHouseShoot(a)})),(0,u.Z)((0,s.Z)(t),"setPasswordHandler",(function(e){t.setState({password:e.target.value,passwordError:!1,passwordErrorMessage:"",phoneError:!1,phoneErrorMessage:""})})),(0,u.Z)((0,s.Z)(t),"checkValidate",(function(e,n){var o=t.state.password;switch(n){case"password":t.setState({passwordError:!e,passwordErrorMessage:!e&&o.length<6?t.props.t("settingsaccountfacebookpopup.few-characters"):""})}})),(0,u.Z)((0,s.Z)(t),"handleInputBlur",(function(){t.setState({phoneError:!1,phoneErrorMessage:""})})),(0,u.Z)((0,s.Z)(t),"handleSubmitClick",(function(){var e=t.state,n=e.password,o=e.passwordErrorMessage,a=e.passwordError,r=e.spinner;t.sendEvents("button","unlink",t.props.t("settingsaccountfacebookpopup.delete")),n?a||o||r||t.setState({spinner:!0},(function(){var e={password:btoa(unescape(encodeURIComponent(n)))},o="".concat(t.apiUrl).concat(C.ve.fbUnlink).concat(h.$h);fetch(o,{method:"POST",credentials:"include",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){e.status<400?e.json().then((function(e){t.props.authRefreshed(e),t.closeHandler()})):e.json().then((function(e){t.setState({passwordError:!0,spinner:!1,passwordErrorMessage:t.errors[e.code]||t.errors[e.message]||e.message||t.props.t("settingsaccountfacebookpopup.something-wrong")})}))}))})):t.setState({passwordError:!n,passwordErrorMessage:n?o:t.props.t("settingsaccountfacebookpopup.few-characters")})})),(0,u.Z)((0,s.Z)(t),"closeHandler",(function(e,n,o){t.sendEvents(e,n,o),t.setState({spinner:!1}),t.props.toggleFacebookUnlinkPopup(!1)})),(0,u.Z)((0,s.Z)(t),"handleKeyDown",(function(e){27===e.keyCode&&t.closeHandler(),13===e.keyCode&&t.handleSubmitClick()})),(0,u.Z)((0,s.Z)(t),"handleClickOutside",(function(e){t.popupWrapper&&!t.popupWrapper.contains(e.target)&&t.closeHandler()})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=pt(pt({},this.props.systemInformation.clickHouseData),{},{action_id:"popupview",block_type:"popup",block_attributes_id:"facebook_unlink",event_time:(new Date).getTime()});this.props.clickHouseShoot(t)}},{key:"render",value:function(){var t=this,e=this.state,n=e.password,a=e.passwordError,r=e.passwordErrorMessage,s=e.blockInfo,c=e.spinner;return(0,o.jsx)("div",{className:T()["start-popup"],onMouseDown:this.handleClickOutside,onKeyDown:this.handleKeyDown,children:(0,o.jsxs)("div",{className:T()["start-popup__wrapper"],ref:function(e){t.popupWrapper=e},children:[(0,o.jsx)("div",{className:T()["start-popup__close"],onClick:function(){return t.closeHandler("button","cross")},children:(0,o.jsx)("img",{src:"/static/images/popups/cross.svg"})}),(0,o.jsxs)("div",{className:T()["start-popup__content"],children:[(0,o.jsx)("div",{className:T()["start-popup__title"],children:this.props.t("settingsaccountfacebookpopup.delete-acc")}),(0,o.jsx)(I.Z,{value:n,label:this.props.t("settingsaccountfacebookpopup.enter-password"),onChange:this.setPasswordHandler,onValidate:this.checkValidate,id:"password",maxLength:"50",type:"password",error:a,errorText:r,blockInfo:s,autoComplete:"new-password",canHidePassword:!0})]}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-red"]),onClick:this.handleSubmitClick,children:c?(0,o.jsx)(L.Z,{}):this.props.t("settingsaccountfacebookpopup.delete")}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-stroke"]),onClick:function(){return t.closeHandler("button","cancel",t.props.t("settingsaccountfacebookpopup.cancel"))},children:this.props.t("settingsaccountfacebookpopup.cancel")})]})})}}]),n}(l.Component),_t=(0,d.$j)((function(t){return{toggle:t.toggle,profile:t.profile,systemInformation:t.systemInformation,registration:t.registration}}),lt)((0,k.Z)()(dt));function ft(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ht(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function gt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var mt={authRefreshed:N.wc,clickHouseShoot:f.F7,toggleVKUnlinkPopup:A.Hd},bt=function(t){(0,c.Z)(n,t);var e=gt(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"errors",{INVALID_PASSWORD:t.props.t("settingsaccountfacebookpopup.INVALID_PASSWORD"),ACCOUNT_CONFLICT:t.props.t("settingsaccountvkpopup.ACCOUNT_CONFLICT"),FB_ERROR:t.props.t("settingsaccountfacebookpopup.FB_ERROR")}),(0,u.Z)((0,s.Z)(t),"state",{password:"",passwordError:!1,passwordErrorMessage:"",blockInfo:{block_type:"popup",block_attributes_id:"vk_unlink"},spinner:!1}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"sendEvents",(function(e,n,o){var a=ht(ht({},t.props.systemInformation.clickHouseData),{},{action_id:"click",block_type:"popup",block_attributes_id:"vk_unlink",element_type:e||"",element_attributes_id:n||"",element_attributes_text:o||"",event_time:(new Date).getTime()});t.props.clickHouseShoot(a)})),(0,u.Z)((0,s.Z)(t),"setPasswordHandler",(function(e){t.setState({password:e.target.value,passwordError:!1,passwordErrorMessage:"",phoneError:!1,phoneErrorMessage:""})})),(0,u.Z)((0,s.Z)(t),"checkValidate",(function(e,n){var o=t.state.password;switch(n){case"password":t.setState({passwordError:!e,passwordErrorMessage:!e&&o.length<6?t.props.t("settingsaccountfacebookpopup.few-characters"):""})}})),(0,u.Z)((0,s.Z)(t),"handleInputBlur",(function(){t.setState({phoneError:!1,phoneErrorMessage:""})})),(0,u.Z)((0,s.Z)(t),"handleSubmitClick",(function(){var e=t.state,n=e.password,o=e.passwordErrorMessage,a=e.passwordError,r=e.spinner;t.sendEvents("button","delete",t.props.t("settingsaccountfacebookpopup.delete")),n?a||o||r||t.setState({spinner:!0},(function(){var e={password:btoa(unescape(encodeURIComponent(n)))},o="".concat(t.apiUrl).concat(C.ve.vkUnlink).concat(h.$h);fetch(o,{method:"POST",credentials:"include",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){if(e.status<400)e.json().then((function(e){t.props.authRefreshed(e),t.closeHandler()}));else{var n=ht(ht({},t.props.systemInformation.clickHouseData),{},{action_id:"error",block_type:"popup",block_attributes_id:"vk_unlink",element_type:"input",element_attributes_id:"password",element_attributes_text:t.props.t("settingsaccountfacebookpopup.enter-password"),event_time:(new Date).getTime()});t.props.clickHouseShoot(n),e.json().then((function(e){t.setState({passwordError:!0,spinner:!1,passwordErrorMessage:t.errors[e.code]||t.errors[e.message]||e.message||t.props.t("settingsaccountfacebookpopup.error-wrong")})}))}}))})):t.setState({passwordError:!n,passwordErrorMessage:n?o:t.props.t("settingsaccountfacebookpopup.few-characters")})})),(0,u.Z)((0,s.Z)(t),"closeHandler",(function(e,n,o){t.sendEvents(e,n,o),t.setState({spinner:!1}),t.props.toggleVKUnlinkPopup(!1)})),(0,u.Z)((0,s.Z)(t),"handleKeyDown",(function(e){27===e.keyCode&&t.closeHandler(),13===e.keyCode&&t.handleSubmitClick()})),(0,u.Z)((0,s.Z)(t),"handleClickOutside",(function(e){t.popupWrapper&&!t.popupWrapper.contains(e.target)&&t.closeHandler()})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=ht(ht({},this.props.systemInformation.clickHouseData),{},{action_id:"popupview",block_type:"popup",block_attributes_id:"vk_unlink",event_time:(new Date).getTime()});this.props.clickHouseShoot(t)}},{key:"render",value:function(){var t=this,e=this.state,n=e.password,a=e.passwordError,r=e.passwordErrorMessage,s=e.blockInfo,c=e.spinner;return(0,o.jsx)("div",{className:T()["start-popup"],onMouseDown:this.handleClickOutside,onKeyDown:this.handleKeyDown,children:(0,o.jsxs)("div",{className:T()["start-popup__wrapper"],ref:function(e){t.popupWrapper=e},children:[(0,o.jsx)("div",{className:T()["start-popup__close"],onClick:function(){return t.closeHandler("button","cross")},children:(0,o.jsx)("img",{src:"/static/images/popups/cross.svg"})}),(0,o.jsxs)("div",{className:T()["start-popup__content"],children:[(0,o.jsx)("div",{className:T()["start-popup__title"],children:this.props.t("settingsaccountvkpopup.delete-acc")}),(0,o.jsx)(I.Z,{value:n,label:this.props.t("settingsaccountfacebookpopup.enter-password"),onChange:this.setPasswordHandler,onValidate:this.checkValidate,id:"password",maxLength:"50",type:"password",error:a,errorText:r,blockInfo:s,autoComplete:"new-password",canHidePassword:!0})]}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-red"]),onClick:this.handleSubmitClick,children:c?(0,o.jsx)(L.Z,{}):this.props.t("settingsaccountfacebookpopup.delete")}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-stroke"]),onClick:function(){return t.closeHandler("button","cancel",t.props.t("settingsaccountfacebookpopup.cancel"))},children:this.props.t("settingsaccountfacebookpopup.cancel")})]})})}}]),n}(l.Component),vt=(0,d.$j)((function(t){return{toggle:t.toggle,profile:t.profile,systemInformation:t.systemInformation,registration:t.registration}}),mt)((0,k.Z)()(bt)),yt=n(55446),Pt=n.n(yt),wt=n(75937),kt=n.n(wt),Zt=n(88882);function jt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function xt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?jt(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function St(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var Dt={togglePasswordPopup:A.z,toggleEmailPopup:A.Qj,togglePhonePopup:A.Xs,clickHouseShoot:f.F7,authRefreshed:N.wc,toggleFacebookUnlinkPopup:A.Gu,toggleVKUnlinkPopup:A.Hd},Ot=function(t){(0,c.Z)(n,t);var e=St(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{socialFbError:null,socialVkError:null}),(0,u.Z)((0,s.Z)(t),"errors",{ACCOUNT_CONFLICT_F:t.props.t("settingsaccountinfo.err-fb"),ACCOUNT_CONFLICT_G:t.props.t("settingsaccountinfo.err-g")}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"sendEvent",(function(e,n,o){var a=xt(xt({},t.props.systemInformation.clickHouseData),{},{action_id:"click",element_type:"link",element_attributes_id:t.handleAttrType(o),element_attributes_text:e,element_attributes_index:n,block_type:"block",block_attributes_id:"account",event_time:(new Date).getTime()});t.props.clickHouseShoot(a)})),(0,u.Z)((0,s.Z)(t),"handleAttrType",(function(e){var n=t.props.registration.authData;if(n)switch(e){case"email":return n.email?"change":"add";case"phone":return n.phone?"change":"add";default:return"change"}})),(0,u.Z)((0,s.Z)(t),"emailHandler",(function(){var e=t.props.registration.authData;t.sendEvent(e&&e.email?t.props.t("settingsaccountinfo.change"):t.props.t("settingsaccountinfo.add"),1,"email"),t.props.toggleEmailPopup(!0)})),(0,u.Z)((0,s.Z)(t),"passwordHandler",(function(){var e=t.props.registration.authData;t.sendEvent(e&&e.email?t.props.t("settingsaccountinfo.change"):t.props.t("settingsaccountinfo.add"),2,"password"),t.props.togglePasswordPopup(!0)})),(0,u.Z)((0,s.Z)(t),"phoneHandler",(function(){var e=t.props.registration.authData;t.sendEvent(e&&e.phone?t.props.t("settingsaccountinfo.change"):t.props.t("settingsaccountinfo.add"),3,"phone"),t.props.togglePhonePopup(!0)})),(0,u.Z)((0,s.Z)(t),"handleClickFacebook",(function(){FB&&FB.login((function(e){"connected"===e.status&&fetch("".concat(t.apiUrl).concat(C.ve.fbLink).concat(h.$h),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({access_token:e.authResponse.accessToken})}).then((function(e){e.status<400?e.json().then((function(e){t.props.authRefreshed(e)})):t.handleFail(e,"F")}))}))})),(0,u.Z)((0,s.Z)(t),"handleClickVk",(function(){var e=xt(xt({},t.props.systemInformation.clickHouseData),{},{action_id:"click",element_type:"link",element_attributes_id:"add",element_attributes_text:t.props.t("settingsaccountinfo.add"),block_type:"block",block_attributes_id:"account",event_time:(new Date).getTime()});t.props.clickHouseShoot(e),Zt.lj.userVisibleAuth().then(t.onAuthData,t.onAuthError)})),(0,u.Z)((0,s.Z)(t),"onAuthData",(function(e){if(e&&e.payload&&e.payload.token&&e.payload.uuid){var n={silent_token:e.payload.token,public_uuid:e.payload.uuid};fetch("".concat(t.apiUrl).concat(C.ve.vkLink).concat(h.$h),{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){e.status<400?e.json().then((function(e){t.props.authRefreshed(e)})):e.json().then((function(e){"VKONTAKTE_ERROR"===e.code?t.setState({socialVkError:t.props.t("signin.errorVkontakteError")}):"ACCOUNT_CONFLICT"===e.code?t.setState({socialVkError:t.props.t("settingsaccountvkpopup.ACCOUNT_CONFLICT")}):t.setState({socialVkError:t.props.t("settingsaccountfacebookpopup.error-wrong")})}))}))}})),(0,u.Z)((0,s.Z)(t),"onAuthError",(function(t){console.error("onAuthError",t)})),(0,u.Z)((0,s.Z)(t),"facebookUnlink",(function(){t.props.toggleFacebookUnlinkPopup(!0)})),(0,u.Z)((0,s.Z)(t),"vkUnlink",(function(){t.props.toggleVKUnlinkPopup(!0)})),(0,u.Z)((0,s.Z)(t),"handleFail",(function(e,n){e.json().then((function(e){"F"===n&&t.setState({socialFbError:t.errors[e.code]||t.errors["".concat(e.code,"_").concat(n)]||t.props.t("settingsaccountinfo.err-happened")})}))})),(0,u.Z)((0,s.Z)(t),"getPhoneMask",(function(t){return t.replace(/^([+]\d{1})(\d{3})(\d{3})(\d{2})(\d{2})$/,(function(t,e,n,o,a,r,s,c){return"".concat(e," ").concat(n," ").concat(o,"-").concat(a,"-").concat(r)}))})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){if(!document.getElementById("connectfb")){var t=document.createElement("script");t.src="https://connect.facebook.net/en_US/sdk.js",t.async=!0,t.id="connectfb",document.body.appendChild(t),window.fbAsyncInit=function(){FB.init({appId:"110857366212101",autoLogAppEvents:!0,xfbml:!0,version:"v7.0"})}}Zt.De.init({appId:"7880617"})}},{key:"componentWillUnmount",value:function(){var t=this.props.toggle,e=t.emailPopup,n=t.passwordPopup,o=t.phonePopup,a=t.facebookUnlinkPopup,r=t.vkUnlinkPopup;e&&this.props.toggleEmailPopup(!1),n&&this.props.togglePasswordPopup(!1),o&&this.props.togglePhonePopup(!1),a&&this.props.toggleFacebookUnlinkPopup(!1),r&&this.props.toggleVKUnlinkPopup(!1)}},{key:"render",value:function(){var t,e,n=this.props.registration.authData,a=this.props.toggle,r=a.emailPopup,s=a.passwordPopup,c=a.phonePopup,i=a.confirmPhonePopup,p=a.facebookUnlinkPopup,u=a.vkUnlinkPopup,l=this.state,d=l.socialFbError,_=l.socialVkError;return(0,o.jsxs)(v.W_,{name:"account",children:[(0,o.jsx)("h2",{children:this.props.t("settingsaccountinfo.title")}),(0,o.jsxs)("div",{className:"".concat(kt()["account__block-wrapper"]),children:[(0,o.jsxs)("div",{className:kt().account__block,children:[(0,o.jsx)("div",{className:kt().account__data__label,children:this.props.t("settingsaccountinfo.email")}),(0,o.jsxs)("div",{className:kt().account__data__item,children:[n&&n.email&&(0,o.jsx)("div",{className:kt().account__data__text,"data-testid":"email",children:n.email}),(0,o.jsx)("div",{className:kt()["account__change-info"],onClick:this.emailHandler,"data-testid":"change_email",children:n&&n.email?this.props.t("settingsaccountinfo.change"):this.props.t("settingsaccountinfo.add")})]})]}),(0,o.jsxs)("div",{className:kt().account__block,children:[(0,o.jsx)("div",{className:kt().account__data__label,children:this.props.t("settingsaccountinfo.password")}),(0,o.jsxs)("div",{className:kt().account__data__item,children:[(0,o.jsx)("div",{className:kt().account__data__text,children:"\u2731\u2731\u2731\u2731\u2731\u2731"}),(0,o.jsx)("div",{className:kt()["account__change-info"],onClick:this.passwordHandler,"data-testid":"change_password",children:this.props.t("settingsaccountinfo.change")})]})]}),(0,o.jsxs)("div",{className:kt().account__block,children:[(0,o.jsx)("div",{className:kt().account__data__label,children:this.props.t("settingsaccountinfo.phone")}),(0,o.jsxs)("div",{className:kt().account__data__item,children:[n&&n.phone&&(0,o.jsx)("div",{className:kt().account__data__text,"data-testid":"phone",children:this.getPhoneMask(n.phone)}),(0,o.jsx)("div",{className:kt()["account__change-info"],onClick:this.phoneHandler,"data-testid":"change_mobile_button",children:n&&n.phone?this.props.t("settingsaccountinfo.change"):this.props.t("settingsaccountinfo.add")})]})]}),(0,o.jsxs)("div",{className:kt().account__block,children:[(0,o.jsx)("div",{className:kt().account__data__label,children:"Facebook"}),(0,o.jsxs)("div",{className:kt().account__data__item,children:[n&&n.facebook_info&&n.facebook_id&&(0,o.jsx)("div",{className:kt().account__data__text,children:n.facebook_info.email}),n&&n.facebook_id?(0,o.jsx)("div",{className:kt()["account__change-info"],onClick:this.facebookUnlink,children:this.props.t("settingsaccountinfo.delete")}):(0,o.jsx)("div",{className:kt()["account__change-info"],onClick:this.handleClickFacebook,children:this.props.t("settingsaccountinfo.add")})]}),d?(0,o.jsx)("div",{className:Pt().error,dangerouslySetInnerHTML:{__html:d}}):null]}),(0,o.jsxs)("div",{className:kt().account__block,children:[(0,o.jsx)("div",{className:kt().account__data__label,children:"VK Connect"}),(0,o.jsxs)("div",{className:kt().account__data__item,children:[n&&n.vk_id&&(null===(t=n.vk_info)||void 0===t?void 0:t.phone)&&(0,o.jsx)("div",{className:kt().account__data__text,children:this.getPhoneMask(n.vk_info.phone)}),n&&n.vk_id&&!(null!==(e=n.vk_info)&&void 0!==e&&e.phone)&&(0,o.jsx)("div",{className:kt().account__data__text,children:n.vk_id}),n&&n.vk_id?(0,o.jsx)("div",{className:kt()["account__change-info"],onClick:this.vkUnlink,children:this.props.t("settingsaccountinfo.delete")}):(0,o.jsx)("div",{className:kt()["account__change-info"],onClick:this.handleClickVk,children:this.props.t("settingsaccountinfo.add")})]}),_?(0,o.jsx)("div",{className:Pt().error,dangerouslySetInnerHTML:{__html:_}}):null]})]}),r&&(0,o.jsx)(W,{}),s&&(0,o.jsx)(z,{}),c&&(0,o.jsx)(et,{}),i&&(0,o.jsx)(ct,{}),p&&(0,o.jsx)(_t,{}),u&&(0,o.jsx)(vt,{})]})}}]),n}(l.Component),Et=(0,d.$j)((function(t){return{toggle:t.toggle,registration:t.registration,systemInformation:t.systemInformation}}),Dt)((0,k.Z)()(Ot)),Ct=n(11163);function Nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function At(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nt(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function It(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var Rt={toggleChangeProfileNamePopup:A.eO,personalDataRememberPush:m.Jl,clickHouseShoot:f.F7},Tt=function(t){(0,c.Z)(n,t);var e=It(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{name:"",errorName:!1,errorNameMessage:"",blockInfo:{block_type:"popup",block_attributes_id:"account_name",screen_type:"settings",screen_attributes_id:"settings"},loading:!1}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"sendEvents",(function(e,n,o,a,r){var s=t.props.systemInformation.clickHouseData,c=t.props.registration.authData,i=At(At({},s),{},{action_id:e,action_result:r||"",screen_attributes_ab_tag:c&&c.tags?c.tags:"",event_version:"1.0",screen_type:"settings",screen_attributes_id:"settings",block_type:"popup",block_attributes_id:"account_name",element_type:n||"",element_attributes_id:o||"",element_attributes_text:a||"",event_time:(new Date).getTime()});t.props.clickHouseShoot(i)})),(0,u.Z)((0,s.Z)(t),"setNameHandler",(function(e){var n=e.target.value;/^[a-zA-Z\u0430-\u044f\u0410-\u042f \u0451\u0401]*$/.test(n)?t.setState({name:n,errorName:!1,errorNameMessage:""}):t.setState({name:n,errorName:!0,errorNameMessage:t.props.t("settingsaccountpersonaldatapopup.wrong-letters")})})),(0,u.Z)((0,s.Z)(t),"checkValidate",(function(t,e){})),(0,u.Z)((0,s.Z)(t),"handleSubmitClick",(function(){var e=t.state,n=e.name,o=e.errorName;if(n!==t.props.prevName){if(t.sendEvents("click","button","save"),!o){var a;t.setState({loading:!0});var r={name:null!==n&&void 0!==n&&null!==(a=n.trim())&&void 0!==a&&a.length?n.trim():null},s="".concat(t.apiUrl).concat(C.ve.profileInfoName).concat(h.$h);fetch(s,{credentials:"include",method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((function(e){e.status<400&&e.json().then((function(e){e.success&&t.props.setProfileName(e.data),t.props.toggleChangeProfileNamePopup(!1),t.props.personalDataRememberPush(!0)})),t.setState({loading:!1})}))}}else t.props.toggleChangeProfileNamePopup(!1)})),(0,u.Z)((0,s.Z)(t),"closeHandler",(function(e,n,o){t.sendEvents(e,n,o),t.props.toggleChangeProfileNamePopup(!1)})),(0,u.Z)((0,s.Z)(t),"handleKeyDown",(function(e){27===e.keyCode&&t.closeHandler(),13===e.keyCode&&t.handleSubmitClick()})),(0,u.Z)((0,s.Z)(t),"handleClickOutside",(function(e){t.popupWrapper&&!t.popupWrapper.contains(e.target)&&t.closeHandler()})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=this.props.systemInformation.clickHouseData,e=this.props.prevName,n=this.props.registration.authData;this.setState({name:e||""});var o=At(At({},t),{},{action_id:"popupview",screen_attributes_ab_tag:n&&n.tags?n.tags:"",event_version:"1.0",screen_type:"settings",screen_attributes_id:"settings",block_type:"popup",block_attributes_id:"account_name",event_time:(new Date).getTime()});this.props.clickHouseShoot(o)}},{key:"render",value:function(){var t=this,e=this.state,n=e.name,a=e.errorName,r=e.errorNameMessage,s=e.blockInfo,c=e.loading;return(0,o.jsx)("div",{className:T()["start-popup"],onMouseDown:this.handleClickOutside,onKeyDown:this.handleKeyDown,children:(0,o.jsxs)("div",{className:T()["start-popup__wrapper"],ref:function(e){t.popupWrapper=e},children:[(0,o.jsx)("div",{className:T()["start-popup__close"],onClick:function(){return t.closeHandler("click","button","cross")},children:(0,o.jsx)("img",{src:"/static/images/popups/cross.svg"})}),(0,o.jsxs)("div",{className:T()["start-popup__content"],children:[(0,o.jsx)("div",{className:T()["start-popup__title"],children:this.props.t("settingsaccountpersonaldatapopup.tell-name")}),(0,o.jsx)(I.Z,{value:n,label:this.props.t("settingsaccountpersonaldatapopup.your-name"),error:a,errorText:r,onChange:this.setNameHandler,onValidate:this.checkValidate,onFocus:this.handleFocus,onBlur:this.handleBlur,type:"textName",blockInfo:s,updatedType:"account_name",needActionResult:!0,id:"name",testid:"popup_info_name",maxLength:"50"})]}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-red"]),onClick:this.handleSubmitClick,"data-testid":"popup_info_save",children:c?(0,o.jsx)(L.Z,{}):this.props.t("settingsaccountpersonaldatapopup.save")})]})})}}]),n}(l.Component),Lt=(0,Ct.withRouter)((0,d.$j)((function(t){return{toggle:t.toggle,profile:t.profile,systemInformation:t.systemInformation,registration:t.registration}}),Rt)((0,k.Z)()(Tt))),Ht=n(4510),Mt=n.n(Ht);function Ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ft(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ut(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Vt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var Wt={clickHouseShoot:f.F7},Gt=function(t){(0,c.Z)(n,t);var e=Vt(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{inputValue:"",inputFocus:"",validate:!0,visibleOptions:!1,selectedValue:t.props.selectedValue}),(0,u.Z)((0,s.Z)(t),"selectedValueProp",null),(0,u.Z)((0,s.Z)(t),"handleShoot",(function(e){var n=t.props,o=n.blockInfo,a=n.title,r=n.label,s=Ft(Ft({},t.props.systemInformation.clickHouseData),{},{event_version:"1.0",action_id:"text_input_start",action_attributes_ab_tag:"manual",action_parameter:"manual",block_type:o&&o.block_type||"",block_attributes_id:o&&o.block_attributes_id||"",screen_type:o&&o.screen_type||"",screen_attributes_id:o&&o.screen_attributes_id||"",element_type:"input",element_attributes_id:"day"!==a&&"month"!==a&&"year"!==a?a:"birthday",element_attributes_text:"interface_language"===a?r:"",element_attributes_index:"interface_language"===a?"1":"",event_time:Date.now()});o&&o.block_attributes_index&&(s.block_attributes_index=o.block_attributes_index),t.props.clickHouseShoot(s),t.props.onChange(e)})),(0,u.Z)((0,s.Z)(t),"toggleVisibleOptions",(function(){var e=t.props,n=e.isDisable,o=e.title,a=e.label;if(!n){var r=t.state,s=r.visibleOptions,c=r.selectedValue;t.setState({visibleOptions:!s},(function(){var e=t.props.blockInfo,n=t.props.systemInformation.clickHouseData;if(!t.state.visibleOptions){var r=Ft(Ft({},n),{},{event_version:"1.0",action_id:"text_input",action_result:t.selectedValueProp||c,block_type:e&&e.block_type||"",block_attributes_id:e&&e.block_attributes_id||"",element_type:"input",element_attributes_id:"day"!==o&&"month"!==o&&"year"!==o?o:"birthday",screen_type:e&&e.screen_type||"",screen_attributes_id:e&&e.screen_attributes_id||"",element_attributes_text:"interface_language"===o?a:"",element_attributes_index:"interface_language"===o?"1":"",event_time:Date.now()});e&&e.block_attributes_index&&(r.block_attributes_index=e.block_attributes_index),t.props.clickHouseShoot(r)}}))}})),(0,u.Z)((0,s.Z)(t),"selectValue",(function(e){t.selectedValueProp=e.option,t.setState({selectedValue:t.selectedValueProp}),t.props.onChange(e.value),t.handleShoot()})),(0,u.Z)((0,s.Z)(t),"handleClickOutside",(function(e){t.popupWrapper&&!t.popupWrapper.contains(e.target)&&t.setState({visibleOptions:!1})})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"render",value:function(){var t=this,e=this.props,n=e.error,a=e.errorText,r=e.title,s=e.options,c=e.imageSrc,i=e.isDisable,p=e.testid,u=e.testidDisabled,l=e.placeholder,d=this.state,_=d.visibleOptions,f=d.selectedValue;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{"data-testid":p||null,className:"".concat(Mt()["start-select"]," ").concat(n?Mt()["start-select__error"]:""),ref:function(e){t.popupWrapper=e},onClick:this.toggleVisibleOptions,children:(0,o.jsxs)("div",{className:Mt()["start-select__wrapper"],children:[(0,o.jsxs)("div",{className:Mt()["start-select-selected"],children:[(0,o.jsx)("div",{className:Mt()["start-select-selected__text"],children:i&&s&&1===s.length?s[0].option:f||this.props.selectedValue||l}),c?(0,o.jsx)("img",{"data-testid":i?u:null,src:"".concat(c,"?v=u"),className:"".concat(Mt()["start-select-selected__image"]," ").concat(_?Mt().rotate:"")}):null]}),_?(0,o.jsx)("div",{className:Mt()["start-select-options"],children:s.map((function(e){return(0,o.jsx)("div",{"data-testid":"popup_info_select_".concat(r,"_").concat(e.value),className:Mt()["start-select-options__item"],onClick:function(){return t.selectValue(e)},children:e.option},e.value)}))}):null]})}),n&&a&&(0,o.jsx)("div",{className:Mt()["start-input__error-text"],children:a})]})}}]),n}(l.Component),$t=(0,d.$j)((function(t){return{systemInformation:t.systemInformation}}),Wt)(Gt);function Bt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Kt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Bt(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Jt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var zt={toggleChangeProfileGenderPopup:A.Ox,personalDataRememberPush:m.Jl,clickHouseShoot:f.F7},Yt=function(t){(0,c.Z)(n,t);var e=Jt(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{name:"",errorGender:!1,errorGenderMessage:"",gender:"",genderList:[],blockInfo:{block_type:"popup",block_attributes_id:"gender",screen_type:"settings",screen_attributes_id:"settings"},loading:!1}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"sendEvents",(function(e,n,o,a,r){var s=t.props.systemInformation.clickHouseData,c=t.props.registration.authData,i=Kt(Kt({},s),{},{action_id:e,action_result:r||"",screen_attributes_ab_tag:c&&c.tags?c.tags:"",event_version:"1.0",screen_type:"settings",screen_attributes_id:"settings",block_type:"popup",block_attributes_id:"gender",element_type:n||"",element_attributes_id:o||"",element_attributes_text:a||"",event_time:(new Date).getTime()});t.props.clickHouseShoot(i)})),(0,u.Z)((0,s.Z)(t),"setGenderHandler",(function(e){if(!e)return!1;t.setState({errorGender:!1,errorGenderMessage:"",gender:e||""})})),(0,u.Z)((0,s.Z)(t),"checkValidate",(function(t,e){})),(0,u.Z)((0,s.Z)(t),"handleSubmitClick",(function(){var e=t.state,n=e.gender,o=e.errorGender,a=t.props.prevGender;if(a&&n===a)t.props.toggleChangeProfileGenderPopup(!1);else if(t.sendEvents("click","button","save"),n||a){if(!o){t.setState({loading:!0});var r={gender:n||""},s="".concat(t.apiUrl).concat(C.ve.profileInfoGender).concat(h.$h);fetch(s,{credentials:"include",method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((function(e){e.status<400&&e.json().then((function(e){e.success&&t.props.setProfileGender(e.data),t.props.toggleChangeProfileGenderPopup(!1),t.props.personalDataRememberPush(!0)})),t.setState({loading:!1})}))}}else t.setState({errorGender:!0,errorGenderMessage:t.props.t("settingsaccountpersonaldatapopup.select-gender")})})),(0,u.Z)((0,s.Z)(t),"closeHandler",(function(e,n,o){t.sendEvents(e,n,o),t.props.toggleChangeProfileGenderPopup(!1)})),(0,u.Z)((0,s.Z)(t),"handleKeyDown",(function(e){27===e.keyCode&&t.closeHandler(),13===e.keyCode&&t.handleSubmitClick()})),(0,u.Z)((0,s.Z)(t),"handleFocus",(function(e){t.sendEvents("text_input_start","input","gender",t.props.t("settingsaccountpersonaldatapopup.gender"),"manual")})),(0,u.Z)((0,s.Z)(t),"handleBlur",(function(){t.sendEvents("text_input","input","gender",t.props.t("settingsaccountpersonaldatapopup.gender"),t.state.gender)})),(0,u.Z)((0,s.Z)(t),"handleClickOutside",(function(e){t.popupWrapper&&!t.popupWrapper.contains(e.target)&&t.closeHandler()})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t,e=this.props.systemInformation.clickHouseData,n=this.props.prevGender,o=this.props.registration.authData;t=[{value:"male",option:this.props.t("settingsaccountpersonaldatapopup.male")},{value:"female",option:this.props.t("settingsaccountpersonaldatapopup.female")}],this.setState({genderList:t,gender:n||""});var a=Kt(Kt({},e),{},{action_id:"popupview",screen_attributes_ab_tag:o&&o.tags?o.tags:"",event_version:"1.0",screen_type:"settings",screen_attributes_id:"settings",block_type:"popup",block_attributes_id:"gender",event_time:(new Date).getTime()});this.props.clickHouseShoot(a)}},{key:"render",value:function(){var t=this,e=this.state,n=e.errorGender,a=e.errorGenderMessage,r=e.genderList,s=e.blockInfo,c=e.loading,i=this.props.prevGender;return(0,o.jsx)("div",{className:T()["start-popup"],onMouseDown:this.handleClickOutside,onKeyDown:this.handleKeyDown,children:(0,o.jsxs)("div",{className:T()["start-popup__wrapper"],ref:function(e){t.popupWrapper=e},children:[(0,o.jsx)("div",{className:T()["start-popup__close"],onClick:function(){return t.closeHandler("click","button","cross")},children:(0,o.jsx)("img",{src:"/static/images/popups/cross.svg"})}),(0,o.jsxs)("div",{className:T()["start-popup__content"],children:[(0,o.jsx)("div",{className:T()["start-popup__title"],children:this.props.t("settingsaccountpersonaldatapopup.tell-gender")}),(0,o.jsx)($t,{error:n,errorText:a,onChange:this.setGenderHandler,onFocus:this.handleFocus,onBlur:this.handleBlur,options:r,title:"gender",testidDisabled:"popup_info_gender_select_lock",testid:"popup_info_select_gender",selectedValue:i,imageSrc:"/static/images/account/arrow.svg",blockInfo:s,placeholder:this.props.t("settingsaccountpersonaldatapopup.gender")})]}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-red"]),onClick:this.handleSubmitClick,"data-testid":"popup_info_save",children:c?(0,o.jsx)(L.Z,{}):this.props.t("settingsaccountpersonaldatapopup.save")})]})})}}]),n}(l.Component),Xt=(0,Ct.withRouter)((0,d.$j)((function(t){return{toggle:t.toggle,profile:t.profile,systemInformation:t.systemInformation,registration:t.registration}}),zt)((0,k.Z)()(Yt)));function qt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Qt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qt(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function te(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}for(var ee={toggleChangeProfileBirthdayPopup:A.g4,personalDataRememberPush:m.Jl,clickHouseShoot:f.F7},ne=[],oe=[],ae=1;ae<32;ae++)ne.push({value:ae<10?"0".concat(ae):ae,option:ae<10?"0".concat(ae):ae});for(var re=(new Date).getFullYear()-18;re>1910;re--)oe.push({value:re,option:re});var se=function(t){(0,c.Z)(n,t);var e=te(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{day:"",errorDay:"",month:"",year:"",adultError:"",birthday:"",dayList:[],monthList:[],yearList:[],blockInfo:{block_type:"popup",block_attributes_id:"birthday",screen_type:"settings",screen_attributes_id:"settings"},loading:!1}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"sendEvents",(function(e,n,o){var a=t.props.systemInformation.clickHouseData,r=t.props.registration.authData,s=Qt(Qt({},a),{},{action_id:"click",action_result:"link"!==e?o:"",screen_attributes_ab_tag:r&&r.tags?r.tags:"",event_version:"1.0",screen_type:"settings",screen_attributes_id:"settings",block_type:"popup",block_attributes_id:"birthday",element_type:e||"",element_attributes_id:n||"",element_attributes_text:"link"===e?o:"",event_time:(new Date).getTime()});t.props.clickHouseShoot(s)})),(0,u.Z)((0,s.Z)(t),"checkValidate",(function(t,e){})),(0,u.Z)((0,s.Z)(t),"setDayHandler",(function(e){if(!e)return!1;t.setState({day:"- -"!==e?e:"",errorDay:!1,adultError:!1})})),(0,u.Z)((0,s.Z)(t),"setMonthHandler",(function(e){if(!e)return!1;t.setState({month:"- -"!==e?e:"",errorDay:!1,adultError:!1})})),(0,u.Z)((0,s.Z)(t),"setYearHandler",(function(e){if(!e)return!1;t.setState({year:"- -"!==e?e:"",errorDay:!1,adultError:!1})})),(0,u.Z)((0,s.Z)(t),"handleSubmitClick",(function(){var e=t.state,n=e.adultError,o=e.errorDay,a=e.day,r=e.month,s=e.year,c="",i=parseInt(a),p=parseInt(r),u=parseInt(s);if(t.sendEvents("button","save"),(u||i||p)&&(!i||p&&u)&&(!p||i&&u)&&(!u||i&&p)){if(i&&p&&u){var l=new Date(u,p-1,i),d=new Date,_=[2,4,6,9,11];if(u%4==0&&u%100!=0||u%400==0){if(2==p&&i>29||-1!==_.indexOf(p)&&i>30)return void t.setState({errorDay:t.props.t("settingsaccountpersonaldatapopup.date-incorrect")})}else{if(2==p&&i>28||-1!==_.indexOf(p)&&i>30)return void t.setState({errorDay:t.props.t("settingsaccountpersonaldatapopup.date-incorrect")});t.setState({errorDay:""})}if(l>new Date(d.setFullYear(d.getFullYear()-18)))return void t.setState({adultError:t.props.t("settingsaccountpersonaldatapopup.must-be-adult")});t.setState({adultError:""}),c=i+"-"+p+"-"+u}if(!o&&!n){t.setState({loading:!0});var f={birthday:c||""},g="".concat(t.apiUrl).concat(C.ve.profileInfoBirthday).concat(h.$h);fetch(g,{credentials:"include",method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}).then((function(e){e.status<400&&e.json().then((function(e){e.success&&t.props.setProfileBirthday(e.data),t.props.toggleChangeProfileBirthdayPopup(!1),t.props.personalDataRememberPush(!0)})),t.setState({loading:!1})}))}}else t.setState({errorDay:t.props.t("settingsaccountpersonaldatapopup.date-incorrect")})})),(0,u.Z)((0,s.Z)(t),"closeHandler",(function(e,n,o){t.sendEvents(e,n,o),t.props.toggleChangeProfileBirthdayPopup(!1)})),(0,u.Z)((0,s.Z)(t),"handleKeyDown",(function(e){27===e.keyCode&&t.closeHandler(),13===e.keyCode&&t.handleSubmitClick()})),(0,u.Z)((0,s.Z)(t),"handleClickOutside",(function(e){t.popupWrapper&&!t.popupWrapper.contains(e.target)&&t.closeHandler()})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t,e,n,o=this.props.systemInformation.clickHouseData,a=this.props.prevBirthday,r=this.props.registration.authData;e=[{value:"01",option:this.props.t("settingsaccountpersonaldatapopup.jan")},{value:"02",option:this.props.t("settingsaccountpersonaldatapopup.feb")},{value:"03",option:this.props.t("settingsaccountpersonaldatapopup.mar")},{value:"04",option:this.props.t("settingsaccountpersonaldatapopup.apr")},{value:"05",option:this.props.t("settingsaccountpersonaldatapopup.may")},{value:"06",option:this.props.t("settingsaccountpersonaldatapopup.jun")},{value:"07",option:this.props.t("settingsaccountpersonaldatapopup.jul")},{value:"08",option:this.props.t("settingsaccountpersonaldatapopup.aug")},{value:"09",option:this.props.t("settingsaccountpersonaldatapopup.sep")},{value:"10",option:this.props.t("settingsaccountpersonaldatapopup.oct")},{value:"11",option:this.props.t("settingsaccountpersonaldatapopup.nov")},{value:"12",option:this.props.t("settingsaccountpersonaldatapopup.dec")}],t=ne,n=oe,this.setState({dayList:t,monthList:e,yearList:n,birthday:a||"",day:a?a.slice(0,2):"",month:a?a.slice(3,5):"",year:a?a.slice(6):""});var s=Qt(Qt({},o),{},{action_id:"popupview",screen_attributes_ab_tag:r&&r.tags?r.tags:"",event_version:"1.0",screen_type:"settings",screen_attributes_id:"settings",block_type:"popup",block_attributes_id:"birthday",event_time:(new Date).getTime()});this.props.clickHouseShoot(s)}},{key:"render",value:function(){var t,e=this,n=this.state,a=n.errorDay,r=n.adultError,s=n.dayList,c=n.monthList,i=n.yearList,p=n.blockInfo,u=n.loading,l=this.props.prevBirthday,d=l?l.slice(0,2):"",_=c.length?null===(t=c.find((function(t){return t.value===l.slice(3,5)})))||void 0===t?void 0:t.option:"",f=l?l.slice(6):"";return(0,o.jsx)("div",{className:T()["start-popup"],onMouseDown:this.handleClickOutside,onKeyDown:this.handleKeyDown,children:(0,o.jsxs)("div",{className:T()["start-popup__wrapper"],ref:function(t){e.popupWrapper=t},children:[(0,o.jsx)("div",{className:T()["start-popup__close"],onClick:function(){return e.closeHandler("button","cross")},children:(0,o.jsx)("img",{src:"/static/images/popups/cross.svg"})}),(0,o.jsxs)("div",{className:T()["start-popup__content"],children:[(0,o.jsx)("div",{className:T()["start-popup__title"],children:this.props.t("settingsaccountpersonaldatapopup.tell-birthday")}),(0,o.jsxs)("div",{className:T()["account-popup__date"],onBlur:this.checkAdult,children:[(0,o.jsx)($t,{onChange:this.setDayHandler,options:s,imageSrc:"/static/images/account/arrow.svg",blockInfo:p,title:"day",selectedValue:d,testidDisabled:"popup_info_day_select_lock",testid:l?null:"popup_info_day_select",placeholder:this.props.t("settingsaccountpersonaldatapopup.dd")}),(0,o.jsx)($t,{onChange:this.setMonthHandler,options:c,imageSrc:"/static/images/account/arrow.svg",blockInfo:p,title:"month",selectedValue:_,testidDisabled:"popup_info_month_select_lock",testid:l?null:"popup_info_month_select",placeholder:this.props.t("settingsaccountpersonaldatapopup.mm")}),(0,o.jsx)($t,{onChange:this.setYearHandler,options:i,imageSrc:"/static/images/account/arrow.svg",blockInfo:p,title:"year",selectedValue:f,testidDisabled:"popup_info_year_select_lock",testid:l?null:"popup_info_year_select",placeholder:this.props.t("settingsaccountpersonaldatapopup.yyyy")})]}),a&&(0,o.jsx)("div",{className:T()["account-popup__error"],"data-testid":"popup_info_alert",children:a}),r&&(0,o.jsx)("div",{className:T()["account-popup__error"],"data-testid":"popup_info_alert",children:r}),(0,o.jsxs)("div",{className:T()["start-popup__text"],children:[this.props.t("settingsaccountpersonaldatapopup.must-be-adult-user-agreement-1")," ",(0,o.jsx)("a",{href:"".concat("ru"!==Z.Z.language?"/".concat(Z.Z.language):"","/legal/terms_of_use"),target:"_blank",onClick:function(){return e.sendEvents("link","terms_of_service",e.props.t("settingsaccountpersonaldatapopup.must-be-adult-user-agreement-2"))},children:this.props.t("settingsaccountpersonaldatapopup.must-be-adult-user-agreement-2")})," ",this.props.t("settingsaccountpersonaldatapopup.must-be-adult-user-agreement-3")," ",(0,o.jsx)("a",{href:"".concat("ru"!==Z.Z.language?"/".concat(Z.Z.language):"","/legal/privacy_policy"),target:"_blank",onClick:function(){return e.sendEvents("link","privacy_policy",e.props.t("settingsaccountpersonaldatapopup.must-be-adult-user-agreement-4"))},children:this.props.t("settingsaccountpersonaldatapopup.must-be-adult-user-agreement-4")})]})]}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-red"]),onClick:this.handleSubmitClick,"data-testid":"popup_info_save",children:u?(0,o.jsx)(L.Z,{}):this.props.t("settingsaccountpersonaldatapopup.save")})]})})}}]),n}(l.Component),ce=(0,Ct.withRouter)((0,d.$j)((function(t){return{toggle:t.toggle,profile:t.profile,systemInformation:t.systemInformation,registration:t.registration}}),ee)((0,k.Z)()(se)));function ie(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var pe={toggleChangeProfileNamePopup:A.eO,toggleChangeProfileGenderPopup:A.Ox,toggleChangeProfileBirthdayPopup:A.g4,clickHouseShoot:f.F7},ue=function(t){(0,c.Z)(n,t);var e=ie(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{editMessage:!1,name:"",gender:"",birthday:""}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"setProfileInfo",(function(e){e&&t.setState({name:e.name||"",gender:e.gender||"",birthday:e.birthday?t.replaceDate(e.birthday):""})})),(0,u.Z)((0,s.Z)(t),"setProfileName",(function(e){e&&t.setState({name:e.name||""})})),(0,u.Z)((0,s.Z)(t),"setProfileGender",(function(e){e&&t.setState({gender:e.gender||""})})),(0,u.Z)((0,s.Z)(t),"setProfileBirthday",(function(e){e&&t.setState({birthday:e.birthday?t.replaceDate(e.birthday):""})})),(0,u.Z)((0,s.Z)(t),"replaceDate",(function(t){var e=t.replace(/\D/g,"");return"".concat(e.slice(6,8),".").concat(e.slice(4,6),".").concat(e.slice(0,4))})),(0,u.Z)((0,s.Z)(t),"nameHandler",(function(){t.props.toggleChangeProfileNamePopup(!0)})),(0,u.Z)((0,s.Z)(t),"genderHandler",(function(){t.props.toggleChangeProfileGenderPopup(!0)})),(0,u.Z)((0,s.Z)(t),"birthdayHandler",(function(){t.props.toggleChangeProfileBirthdayPopup(!0)})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=this,e="".concat(this.apiUrl).concat(C.ve.profileInfo).concat(h.$h);fetch(e,{credentials:"include"}).then((function(e){e.status<400&&e.json().then((function(e){return t.setProfileInfo(e)}))}))}},{key:"componentDidUpdate",value:function(t,e){var n=t.systemInformation.locale;this.props.systemInformation.locale!==n&&this.setProfileGender(this.state)}},{key:"componentWillUnmount",value:function(){var t=this.props.toggle,e=t.namePopup,n=t.genderPopup,o=t.birthdayPopup;e&&this.props.toggleChangeProfileNamePopup(!1),n&&this.props.toggleChangeProfileGenderPopup(!1),o&&this.props.toggleChangeProfileBirthdayPopup(!1)}},{key:"render",value:function(){var t=this.props.toggle,e=t.namePopup,n=t.genderPopup,a=t.birthdayPopup,r=this.state,s=r.name,c=r.gender,i=r.birthday;return(0,o.jsxs)(v.W_,{name:"personal_data",children:[(0,o.jsx)("h2",{children:this.props.t("settingspersonaldata.title")}),(0,o.jsxs)("div",{className:"".concat(kt()["account__block-wrapper"]),children:[(0,o.jsxs)("div",{className:"".concat(kt().account__block),children:[(0,o.jsx)("div",{className:kt().account__data__label,children:this.props.t("settingspersonaldata.name")}),(0,o.jsxs)("div",{className:kt().account__data__item,children:[s&&(0,o.jsx)("div",{className:kt().account__data__text,"data-testid":"name",children:s}),(0,o.jsx)("div",{className:"".concat(kt()["account__change-info"]),onClick:this.nameHandler,"data-testid":"change_name",children:s?this.props.t("settingspersonaldata.edit"):this.props.t("settingspersonaldata.add")})]})]}),(0,o.jsxs)("div",{className:"".concat(kt().account__block),children:[(0,o.jsx)("div",{className:kt().account__data__label,children:this.props.t("settingspersonaldata.sex")}),(0,o.jsxs)("div",{className:kt().account__data__item,children:[c&&(0,o.jsx)("div",{className:kt().account__data__text,"data-testid":"gender",children:c?"male"===c?this.props.t("settingspersonaldata.male"):this.props.t("settingspersonaldata.female"):""}),(0,o.jsx)("div",{className:kt()["account__change-info"],onClick:this.genderHandler,"data-testid":"change_gender",children:c?this.props.t("settingspersonaldata.edit"):this.props.t("settingspersonaldata.add")})]})]}),(0,o.jsxs)("div",{className:"".concat(kt().account__block),children:[(0,o.jsx)("div",{className:kt().account__data__label,children:this.props.t("settingspersonaldata.birthday")}),(0,o.jsxs)("div",{className:kt().account__data__item,children:[i&&(0,o.jsx)("div",{className:kt().account__data__text,"data-testid":"bday",children:i}),(0,o.jsx)("div",{className:kt()["account__change-info"],onClick:this.birthdayHandler,"data-testid":"change_birthday",children:i?this.props.t("settingspersonaldata.edit"):this.props.t("settingspersonaldata.add")})]})]})]}),e&&(0,o.jsx)(Lt,{prevName:s,setProfileName:this.setProfileName}),n&&(0,o.jsx)(Xt,{prevGender:c?"male"===c?this.props.t("settingspersonaldata.male"):this.props.t("settingspersonaldata.female"):"",setProfileGender:this.setProfileGender}),a&&(0,o.jsx)(ce,{prevBirthday:i,setProfileBirthday:this.setProfileBirthday})]})}}]),n}(l.Component),le=(0,d.$j)((function(t){return{profile:t.profile,systemInformation:t.systemInformation,toggle:t.toggle}}),pe)((0,k.Z)()(ue)),de=n(54883),_e=n(54569),fe=n(59999);function he(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ge(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?he(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function me(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var be={clickHouseShoot:f.F7},ve=function(t){(0,c.Z)(n,t);var e=me(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{inputValue:"",inputFocus:"",validate:!0,validateText:"",visibleOptions:!1,selectedValues:[],options:[]}),(0,u.Z)((0,s.Z)(t),"selectedValueProp",null),(0,u.Z)((0,s.Z)(t),"optionsProp",null),(0,u.Z)((0,s.Z)(t),"handleShoot",(function(){var e=t.props,n=e.blockInfo,o=e.title,a=e.label,r=ge(ge({},t.props.systemInformation.clickHouseData),{},{event_version:"1.0",action_id:"text_input_start",action_attributes_ab_tag:"manual",block_type:n&&n.block_type||"",block_attributes_id:n&&n.block_attributes_id||"",screen_type:n&&n.screen_type||"",screen_attributes_id:n&&n.screen_attributes_id||"",element_type:"input",element_attributes_id:o,element_attributes_text:"content_language"===o?a:"",element_attributes_index:"content_language"===o?"2":"",event_time:Date.now()});n&&n.block_attributes_index&&(r.block_attributes_index=n.block_attributes_index),t.props.clickHouseShoot(r)})),(0,u.Z)((0,s.Z)(t),"toggleVisibleOptions",(function(){var e=t.props,n=e.isDisable,o=e.title,a=e.label;if(!n){var r=t.state,s=r.visibleOptions,c=r.selectedValues;t.setState({visibleOptions:!s},(function(){var e=t.props.blockInfo,n=t.props.systemInformation.clickHouseData;if(t.state.visibleOptions)t.handleShoot();else{var r=ge(ge({},n),{},{event_version:"1.0",action_id:"text_input",action_result:t.selectedValueProp||c&&Array.isArray(c)&&c.map((function(t){return t.value})).join(", "),block_type:e&&e.block_type||"",block_attributes_id:e&&e.block_attributes_id||"",element_type:"input",element_attributes_id:o,element_attributes_text:"content_language"===o?a:"",element_attributes_index:"content_language"===o?"2":"",event_time:Date.now()});e&&e.block_attributes_index&&(r.block_attributes_index=e.block_attributes_index),t.props.clickHouseShoot(r)}}))}})),(0,u.Z)((0,s.Z)(t),"selectValue",(function(e){t.selectedValuesProp=t.state.selectedValues.concat(e),t.optionsProp=t.state.options.filter((function(t){return t.option!==e.option})),t.setState({selectedValues:t.selectedValuesProp}),t.props.onChange(t.selectedValuesProp.map((function(t){return t.option}))),t.setState({options:t.optionsProp})})),(0,u.Z)((0,s.Z)(t),"deleteValue",(function(e){if(!e)return!1;"function"===typeof t.props.onDeleteCheck?(t.isDelete=t.props.onDeleteCheck(e),t.isDelete&&t.handleDeleteValue(e)):t.handleDeleteValue(e)})),(0,u.Z)((0,s.Z)(t),"handleDeleteValue",(function(e){if(!e)return!1;t.selectedValuesProp=t.state.selectedValues.filter((function(t){return t.value!==e.value})),t.optionsProp=t.props.options.filter((function(e){return!t.selectedValuesProp.find((function(t){return t.option===e.option}))})),t.setState({selectedValues:t.selectedValuesProp}),t.props.onChange(t.selectedValuesProp.map((function(t){return t.option}))),t.setState({options:t.optionsProp}),t.setValidate()})),(0,u.Z)((0,s.Z)(t),"handleClickOutside",(function(e){t.popupWrapper&&!t.popupWrapper.contains(e.target)&&t.setState({visibleOptions:!1}),t.popupMultiItemsWrapper&&!t.popupMultiItemsWrapper.contains(e.target)&&t.setValidate()})),(0,u.Z)((0,s.Z)(t),"setValidate",(function(){var e=t.state.validate,n=t.props.id;t.props.onValidate(e,n)})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside),this.setState((function(t,e){return{selectedValues:e.selectedValues,options:e.options.filter((function(t){return!e.selectedValues.find((function(e){return e.option===t.option}))}))}}))}},{key:"componentDidUpdate",value:function(t,e){var n=this.props,o=n.selectedValues,a=n.options,r=t.selectedValues;t.options;o!==r&&this.setState({selectedValues:o,options:a.filter((function(t){return!o.find((function(e){return e.option===t.option}))}))})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"render",value:function(){var t=this,e=this.props,n=e.error,a=e.title,r=e.imageSrc,s=e.isDisable,c=e.testid,i=e.testidDisabled,p=e.placeholder,u=e.errorText,l=this.state,d=l.visibleOptions,_=l.selectedValues,f=l.options;return(0,o.jsxs)("div",{className:Mt()["start-select-selected"],children:[(0,o.jsxs)("div",{className:Mt()["start-select__multi-items-wrapper"],children:[(null===_||void 0===_?void 0:_.length)>0&&(0,o.jsx)("div",{className:Mt()["start-select__multi-items"],children:_.map((function(e){return(0,o.jsxs)("div",{ref:function(e){t.popupMultiItemsWrapper=e},className:Mt()["start-select__multi-item"],children:[e.value,(0,o.jsx)("div",{className:"".concat(Mt()["start-select__multi-item-delete"]),onClick:function(){return t.deleteValue(e)},children:(0,o.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:"M17 17L7 7.00001M7.00001 17L17 7",stroke:"#757D8A",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]},e.option)}))}),n?(0,o.jsx)("div",{className:Mt()["start-select__multi-items-text"],children:(0,o.jsx)("div",{className:Mt()["start-input__error-text"],children:u})}):null]}),(0,o.jsx)("div",{"data-testid":c||null,className:"".concat(Mt()["start-select"]),ref:function(e){t.popupWrapper=e},onClick:this.toggleVisibleOptions,children:(0,o.jsxs)("div",{className:Mt()["start-select__wrapper"],children:[(0,o.jsxs)("div",{className:Mt()["start-select-selected"],children:[(0,o.jsx)("div",{className:Mt()["start-select-selected__text"],children:p}),r?(0,o.jsx)("img",{"data-testid":s?i:null,src:"".concat(r,"?v=u")}):null]}),d?(0,o.jsx)("div",{className:Mt()["start-select-options"],children:f.map((function(e){return(0,o.jsx)("div",{"data-testid":"popup_multi_select_".concat(a,"_").concat(e.option),className:Mt()["start-select-options__item"],onClick:function(){return t.selectValue(e)},children:e.value},e.option)}))}):null]})})]})}}]),n}(l.Component),ye=(0,d.$j)((function(t){return{systemInformation:t.systemInformation}}),be)(ve),Pe=n(44775);function we(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ke(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?we(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ze(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var je={toggleProfilePopup:A.Sq,toggleProfileDeleteConfirmPopup:A.Zs,toggleLanguageChanged:A.Qb,setProfileType:de.uM,fetchedProfileList:de.Nt,accountChangeProfilePush:m.kq,accountAddProfilePush:m.XV,clickHouseShoot:f.F7,fetchedavatarsList:de.xm,fetchedavatarsListChild:de.TE,selectProfile:de.tM,authRefreshed:N.wc,authRefresh:N.iv,setStartDeviceId:N.Tt,setClientLocale:f.FZ},xe=function(t){(0,c.Z)(n,t);var e=Ze(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{name:"",avatar:"",child:!1,main:!1,id:null,visibleAvatars:!1,loading:!1,blockInfo:{block_type:t.props.profileData._id?"profile_edit":"popup",block_attributes_id:t.props.profileData._id||"profile_add",screen_type:"settings",screen_attributes_id:"settings"},submited:!1,nameIsEmpty:!1,interfaceIsEmpty:!1,interfaceLang:"",contentLang:[],blockDeleteLang:!1,profileError:!1,profileErrorMessage:"",initialContentLang:[]}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"sendEvents",(function(e,n,o,a,r,s,c){var i=t.props.systemInformation.clickHouseData,p=t.props.profileData,u=t.props.registration.authData,l=ke(ke({},i),{},{action_id:r||"click",action_result:s||"",action_attributes_str:c||"",block_type:a||"popup",block_attributes_id:p?p._id:"",screen_type:"settings",screen_attributes_id:"settings",screen_attributes_ab_tag:u&&u.tags?u.tags:"",element_type:e||"",element_attributes_id:n||"",element_attributes_text:o||"",event_time:(new Date).getTime()});t.props.clickHouseShoot(l)})),(0,u.Z)((0,s.Z)(t),"handleName",(function(e){t.setState({name:e.target.value,submited:!1,nameIsEmpty:!1})})),(0,u.Z)((0,s.Z)(t),"handleChild",(function(){t.setState((function(t){return{child:!t.child,submited:!1,nameIsEmpty:!1}}))})),(0,u.Z)((0,s.Z)(t),"closeHandler",(function(e,n,o){t.sendEvents(e,n,o),t.props.toggleProfilePopup(!1)})),(0,u.Z)((0,s.Z)(t),"checkValidate",(function(e,n){"name"===n?t.setState({oldValidate:e,submited:!1,nameIsEmpty:!1}):"content_lang"===n&&t.setState({languageIsUnremovable:!1,profileError:!1,profileErrorMessage:""})})),(0,u.Z)((0,s.Z)(t),"handleSubmitClick",(function(){t.state.submited||t.setState({submited:!0},(function(){var e,n,o,a,r=t.props.profile.currentProfile,s=t.state,c=s.name,i=s.child,p=s.id,u=s.avatar,l=s.interfaceLang,d=s.contentLang;if(t.sendEvents("button",p?"save":"add",p?t.props.t("settingsaccountprofilepopup.save"):t.props.t("settingsaccountprofilepopup.add")),null!==c&&void 0!==c&&c.trim())if(i||l||!d||!d.length){var _=ke(ke({fullname:c.trim(),child:i,profile_id:p,avatar:u},l&&!i&&{language:ke(ke({},t.props.profileData.language),{},{interface:l,content_lang:d})}),i&&{language:{interface:"ru",content_lang:["ru"]}});t.setState({loading:!0}),t.sendEvents("","","","profile_edit","send_form",(null===(e=_.language)||void 0===e?void 0:e.content_lang)&&_.language.content_lang.join(","),"ProfilePopup"),t.sendEvents("","","","profile_edit","change_interface_language",null===(n=_.language)||void 0===n?void 0:n.interface,null===(o=t.props.profileData)||void 0===o||null===(a=o.language)||void 0===a?void 0:a.interface),fetch("".concat(t.apiUrl).concat(C.ve.profile).concat(h.$h),{method:p?"PUT":"POST",credentials:"include",body:JSON.stringify(_),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){if(t.setState({loading:!1}),e.status<400){var n=l&&h.a2.find((function(t){return t.option===l}));t.handleFetchProfileList(),t.props.authRefresh(t.apiUrl),t.closeHandler(),p?(t.props.accountChangeProfilePush(!0),p===r._id&&e.json().then((function(e){Z.Z.language!==n.option&&t.props.toggleLanguageChanged(!0),Z.Z.changeLanguage(n.option),t.props.setClientLocale(n.option),t.props.selectProfile(e),t.props.setProfileType(i);var o=y.Router.router.asPath,a=t.props.registration.authData,r=t.props.systemInformation.RU_DOMAIN;(0,_e.$5)(o,n.option,null===a||void 0===a?void 0:a.authentication_token,t.props.authRefreshed,t.props.setStartDeviceId,r)}))):t.props.accountAddProfilePush(!0),t.setState({submited:!1})}else e.json().then((function(n){console.error("Error ".concat(e.status,": ").concat(n.message)),t.setState({profileError:!0,profileErrorMessage:"".concat(e.status,": ").concat(n.message)})})),t.setState({submited:!1})}))}else t.setState({interfaceIsEmpty:!0,submited:!1});else t.setState({nameIsEmpty:!0})}))})),(0,u.Z)((0,s.Z)(t),"handleFetchProfileList",(function(){fetch("".concat(t.apiUrl).concat(C.ve.profileList).concat(h.$h),{credentials:"include"}).then((function(e){e.status<400&&e.json().then((function(e){return t.props.fetchedProfileList(e)}))}))})),(0,u.Z)((0,s.Z)(t),"handleDeleteProfile",(function(){t.sendEvents("link","delete_profile",t.props.t("settingsaccountprofilepopup.delete-acc")),t.props.toggleProfileDeleteConfirmPopup(!0),t.props.toggleProfilePopup(!1)})),(0,u.Z)((0,s.Z)(t),"selectAvatarToggle",(function(){var e=t.props.profile,n=e.avatarsList,o=e.avatarsListChild,a=t.state.child;if(t.sendEvents("link","select_avatar",t.props.t("settingsaccountprofilepopup.choose-avatar")),a&&!o||!a&&!n){var r="".concat(t.apiUrl).concat(C.ve.avatars).concat(h.$h,"&for_kids=").concat(a);fetch(r).then((function(e){e.status<400&&e.json().then((function(e){a?t.props.fetchedavatarsListChild(e):t.props.fetchedavatarsList(e)})).then((function(){t.setState({visibleAvatars:!0})}))}))}else t.setState({visibleAvatars:!0})})),(0,u.Z)((0,s.Z)(t),"selectAvatarHandler",(function(e){t.sendEvents("image",e),t.setState({avatar:e,visibleAvatars:!1})})),(0,u.Z)((0,s.Z)(t),"closeAvatarHandler",(function(){t.setState({visibleAvatars:!1})})),(0,u.Z)((0,s.Z)(t),"handleKeyDown",(function(e){27===e.keyCode&&t.closeHandler(),13===e.keyCode&&t.handleSubmitClick()})),(0,u.Z)((0,s.Z)(t),"handleClickOutside",(function(e){t.popupWrapper&&!t.popupWrapper.contains(e.target)&&t.closeHandler()})),(0,u.Z)((0,s.Z)(t),"handleSetInterfaceLang",(function(e){if(!e)return!1;t.setState({interfaceLang:e,interfaceIsEmpty:!1});var n=(0,fe.Z)(t.state.contentLang);n.findIndex((function(t){return t===e}))+1||n.push(e),t.handleSetContentLang(n)})),(0,u.Z)((0,s.Z)(t),"handleSetContentLang",(function(e){if(!e)return!1;t.setState({contentLang:e})})),(0,u.Z)((0,s.Z)(t),"checkContentLang",(function(e){if(!e)return!1;var n=t.state.interfaceLang;if(e.option===n)return t.setState({languageIsUnremovable:!0}),!1;var o=t.state.initialContentLang.filter((function(t){return t!==e.option}));return t.setState({initialContentLang:o}),!0})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t,e,n,o,a,r,s=this.props,c=s.profileData,i=s.mainLanguageInfo,p=this.props.systemInformation.clickHouseData;c?(this.setState({avatar:c.avatar,child:c.child,name:c.fullname,main:c.main,id:c._id}),c.main||!i||null!==(t=c.language)&&void 0!==t&&t.interface||null!==(e=c.language)&&void 0!==e&&null!==(n=e.content_lang)&&void 0!==n&&n.length?this.setState({interfaceLang:null===(o=c.language)||void 0===o?void 0:o.interface,contentLang:null===(a=c.language)||void 0===a?void 0:a.content_lang,initialContentLang:null===(r=c.language)||void 0===r?void 0:r.content_lang}):this.setState({interfaceLang:i.interface,contentLang:(0,fe.Z)(i.content_lang),initialContentLang:(0,fe.Z)(i.content_lang)})):i&&this.setState({interfaceLang:i.interface,contentLang:(0,fe.Z)(i.content_lang),initialContentLang:(0,fe.Z)(i.content_lang)});var u=ke(ke({},p),{},{action_id:"popupview",block_type:"profile_edit",block_attributes_id:c?c._id:"",event_time:(new Date).getTime()});this.props.clickHouseShoot(u)}},{key:"componentDidUpdate",value:function(t,e){var n=this.state.contentLang,o=e.contentLang;0===(null===n||void 0===n?void 0:n.length)&&n!==o&&this.setState({interfaceIsEmpty:!1})}},{key:"componentWillUnmount",value:function(){this.props.toggleProfilePopup(!1)}},{key:"render",value:function(){var t=this,e=this.state,n=e.name,a=e.avatar,r=e.child,s=e.id,c=e.main,i=e.visibleAvatars,p=e.nameIsEmpty,u=e.blockInfo,l=e.loading,d=e.contentLang,_=e.languageIsUnremovable,f=e.interfaceIsEmpty,g=e.interfaceLang,m=e.profileError,b=e.profileErrorMessage,v=this.props.profile,y=v.currentProfile,P=v.avatarsList,w=v.avatarsListChild,k=v.contentLangList,j=r?w:P;return(0,o.jsx)("div",{className:T()["start-popup"],onMouseDown:this.handleClickOutside,onKeyDown:this.handleKeyDown,children:(0,o.jsxs)("div",{className:T()["start-popup__wrapper"],ref:function(e){t.popupWrapper=e},children:[(0,o.jsx)("div",{className:T()["start-popup__close"],onClick:function(){return t.closeHandler("button","cross")},children:(0,o.jsx)("img",{src:"/static/images/popups/cross.svg"})}),(0,o.jsxs)("div",{className:T()["start-popup__content"],children:[(0,o.jsx)("div",{className:"".concat(T()["start-popup__title"]," ").concat(T()["start-popup__title-profile"]),children:s?this.props.t("settingsaccountprofilepopup.edit-user"):this.props.t("settingsaccountprofilepopup.add-user")}),(0,o.jsxs)("div",{className:T()["start-popup__profile-wrapper"],children:[(0,o.jsx)("div",{className:T()["start-popup__profile"],onClick:this.selectAvatarToggle,children:(0,o.jsx)("img",{className:T()["start-popup__profile-avatar"],src:a?this.apiUrl+a:"/static/images/popups/avatar.svg",alt:this.props.t("settingsaccountprofilepopup.ava")})}),j&&j.length>0&&i&&(0,o.jsxs)("div",{className:T()["start-popup__avatars-wrapper"],children:[(0,o.jsx)("div",{className:T()["start-popup__close"],children:(0,o.jsx)("img",{src:"/static/images/popups/cross.svg",onClick:this.closeAvatarHandler})}),j.map((function(e){return(0,o.jsx)("img",{src:t.apiUrl+e,onClick:function(){return t.selectAvatarHandler(e)},className:T()["start-popup__avatars-item"],alt:t.props.t("settingsaccountprofilepopup.ava")},e)}))]}),(0,o.jsx)("div",{className:T()["start-popup__input-wrapper"],children:(0,o.jsx)(I.Z,{value:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e"===n?this.props.t("profile.default"):n,label:s?this.props.t("settingsaccountprofilepopup.profile-name"):this.props.t("settingsaccountprofilepopup.create-profile-name"),onChange:this.handleName,onValidate:this.checkValidate,id:"name",maxLength:"25",type:"text",onBlur:this.checkValidate,error:p,errorText:this.props.t("settingsaccountprofilepopup.put-profile-name"),blockInfo:u,updatedType:"profile_name",needActionResult:!0,isProfile:"true"})})]}),c||"ru"!==Z.Z.language?null:(0,o.jsx)("div",{className:T()["start-popup__profile-checkbox-wrapper"],children:(0,o.jsx)(Pe.Z,{checked:r,onChange:this.handleChild,name:"childPfofile",text:this.props.t("settingsaccountprofilepopup.child-profile"),blockInfo:u})}),r?null:(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:T()["start-popup__input-label"],children:this.props.t("settingsaccountprofilepopup.interface-lang")}),(0,o.jsx)($t,{label:this.props.t("settingsaccountprofilepopup.interface-lang"),onChange:this.handleSetInterfaceLang,options:h.a2.map((function(t){return ke(ke({},t),{},{option:t.value,value:t.option})})),title:"interface_language",testid:"popup_info_select_interface_lang",selectedValue:g&&h.a2.find((function(t){return g===t.option})).value,imageSrc:"/static/images/account/arrow.svg",onValidate:this.checkValidate,error:f,errorText:this.props.t("settingsaccountprofilepopup.choose-interface-lang"),placeholder:this.props.t("settingsaccountprofilepopup.choose-lang"),blockInfo:u})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:T()["start-popup__input-label"],children:this.props.t("settingsaccountprofilepopup.content-lang")}),k&&(0,o.jsx)(ye,{label:this.props.t("settingsaccountprofilepopup.content-lang"),id:"content_lang",testid:"popup_info_select_content_lang",title:"content_language",type:"content_lang",options:null===k||void 0===k?void 0:k.map((function(t){return{option:t.content_lang,value:t.title}})),selectedValues:null===d||void 0===d?void 0:d.map((function(t){return null===k||void 0===k?void 0:k.find((function(e){return t===e.content_lang}))})).map((function(t){return{option:null===t||void 0===t?void 0:t.content_lang,value:null===t||void 0===t?void 0:t.title}})),placeholder:this.props.t("settingsaccountprofilepopup.choose-lang"),imageSrc:"/static/images/popups/plus.svg",onChange:this.handleSetContentLang,onDeleteCheck:this.checkContentLang,onValidate:this.checkValidate,error:_||m,errorText:_?this.props.t("settingsaccountprofilepopup.delete-content-lang-error"):m?b:"",blockInfo:u}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__input-text"]," ").concat(T()["start-popup__content-lang-text"]),children:this.props.t("settingsaccountprofilepopup.content-lang-text")})]})]})]}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-red"]),onClick:this.handleSubmitClick,"data-testid":"popup_profile_add",children:l?(0,o.jsx)(L.Z,{}):s?this.props.t("settingsaccountprofilepopup.save"):this.props.t("settingsaccountprofilepopup.add")}),s&&!c&&y&&y._id!==s&&(0,o.jsxs)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-unstroke"]," ").concat(T()["start-popup__button-safary"]),onClick:this.handleDeleteProfile,"data-testid":"popup_profile_delete",children:[(0,o.jsx)("img",{src:"/static/images/account/trashbin.svg"}),(0,o.jsx)("span",{children:this.props.t("settingsaccountprofilepopup.delete-profile")})]})]})})}}]),n}(l.Component),Se=(0,d.$j)((function(t){return{toggle:t.toggle,profile:t.profile,systemInformation:t.systemInformation,registration:t.registration}}),je)((0,k.Z)()(xe));function De(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Oe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?De(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ee(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var Ce={toggleProfilePopup:A.Sq,toggleProfileDeleteConfirmPopup:A.Zs,fetchedProfileList:de.Nt,accountDeleteProfilePush:m.Dm,clickHouseShoot:f.F7},Ne=function(t){(0,c.Z)(n,t);var e=Ee(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{loading:!1}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"sendEvents",(function(e,n,o){var a=Oe(Oe({},t.props.systemInformation.clickHouseData),{},{action_id:"click",block_type:"popup",block_attributes_id:"profile_delete",element_type:e||"",element_attributes_id:n||"",element_attributes_text:o||"",event_time:(new Date).getTime()});t.props.clickHouseShoot(a)})),(0,u.Z)((0,s.Z)(t),"closeHandler",(function(e,n,o){t.sendEvents(e,n,o),t.props.toggleProfileDeleteConfirmPopup(!1),t.props.toggleProfilePopup(!0)})),(0,u.Z)((0,s.Z)(t),"submitHandler",(function(){var e=t.props.profileData._id;t.sendEvents("button","delete_profile",t.props.t("settingsaccountprofiledeletepopup.delete-profile")),t.setState({loading:!0}),fetch("".concat(t.apiUrl).concat(C.ve.profile,"/").concat(e).concat(h.$h),{method:"DELETE",credentials:"include",body:JSON.stringify(null),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){t.setState({loading:!1}),e.status<400&&t.handleFetchProfileList()}))})),(0,u.Z)((0,s.Z)(t),"handleFetchProfileList",(function(){var e="".concat(t.apiUrl).concat(C.ve.profileList).concat(h.$h);fetch(e,{credentials:"include"}).then((function(e){e.status<400&&e.json().then((function(e){return t.props.fetchedProfileList(e)}))})).then((function(){t.props.toggleProfileDeleteConfirmPopup(!1),t.props.accountDeleteProfilePush(!0)}))})),(0,u.Z)((0,s.Z)(t),"handleKeyDown",(function(e){27===e.keyCode&&t.closeHandler(),13===e.keyCode&&t.handleSubmitClick()})),(0,u.Z)((0,s.Z)(t),"handleClickOutside",(function(e){t.popupWrapper&&!t.popupWrapper.contains(e.target)&&t.closeHandler()})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=Oe(Oe({},this.props.systemInformation.clickHouseData),{},{action_id:"popupview",block_type:"popup",block_attributes_id:"profile_delete",event_time:(new Date).getTime()});this.props.clickHouseShoot(t)}},{key:"render",value:function(){var t=this,e=this.props.profileData,n=e.fullname,a=e.avatar,r=this.state.loading;return(0,o.jsx)("div",{className:T()["start-popup"],onMouseDown:this.handleClickOutside,onKeyDown:this.handleKeyDown,children:(0,o.jsxs)("div",{className:T()["start-popup__wrapper"],ref:function(e){t.popupWrapper=e},children:[(0,o.jsx)("div",{className:T()["start-popup__close"],onClick:function(){return t.closeHandler("button","cross")},children:(0,o.jsx)("img",{src:"/static/images/popups/cross.svg"})}),(0,o.jsxs)("div",{className:T()["start-popup__content"],children:[(0,o.jsx)("div",{className:"".concat(T()["start-popup__title"]," ").concat(T()["start-popup__title-sure-delete"]),children:this.props.t("settingsaccountprofiledeletepopup.sure-delete")}),(0,o.jsxs)("div",{className:T()["start-popup__profile-delete"],children:[(0,o.jsx)("img",{className:T()["start-popup__profile-avatar"],src:a?"".concat(this.apiUrl).concat(a):"/static/images/popups/avatar.svg",alt:this.props.t("settingsaccountprofiledeletepopup.ava")}),(0,o.jsx)("div",{className:T()["start-popup__delete-name"],children:n})]})]}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-red"]),onClick:this.submitHandler,"data-testid":"popup_delete_yes",children:r?(0,o.jsx)(L.Z,{}):(0,o.jsxs)("span",{className:T()["start-popup__delete"],children:[(0,o.jsx)("img",{src:"/static/images/inputs/trash.svg"})," ",this.props.t("settingsaccountprofiledeletepopup.delete-profile")]})}),(0,o.jsx)("div",{className:"".concat(T()["start-popup__button"]," ").concat(T()["start-popup__button-stroke"]),onClick:function(){return t.closeHandler("button","cancel",t.props.t("settingsaccountprofiledeletepopup.cancel"))},"data-testid":"popup_delete_cancel",children:this.props.t("settingsaccountprofiledeletepopup.cancel")})]})})}}]),n}(l.Component),Ae=(0,d.$j)((function(t){return{profile:t.profile,systemInformation:t.systemInformation}}),Ce)((0,k.Z)()(Ne)),Ie=n(42616),Re=n.n(Ie);function Te(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Le(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Te(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function He(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var Me={toggleProfilePopup:A.Sq,clickHouseShoot:f.F7,fetchedContentLangList:de.n_},Ue=function(t){(0,c.Z)(n,t);var e=He(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{profileData:"",avatarsList:[]}),(0,u.Z)((0,s.Z)(t),"jezikList",["sr","hr","bg"]),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"sendEvent",(function(e,n,o,a){var r=Le(Le({},t.props.systemInformation.clickHouseData),{},{action_id:"click",element_type:e,element_attributes_id:n,element_attributes_text:o,element_attributes_index:a,block_type:"block",block_attributes_id:"profiles",event_time:(new Date).getTime()});t.props.clickHouseShoot(r)})),(0,u.Z)((0,s.Z)(t),"countAdultHandler",(function(t){return t&&t.filter((function(t){return!t.child})).length})),(0,u.Z)((0,s.Z)(t),"getMainLanguageInfo",(function(t){var e=t&&t.find((function(t){return!0===t.main}));return e&&e.language})),(0,u.Z)((0,s.Z)(t),"handleAvatarError",(function(t){t.target.src="/static/images/svg/ava.svg"})),(0,u.Z)((0,s.Z)(t),"handleProfilePopup",(function(e,n){e?(t.sendEvent("link","edit",t.props.t("settingsaccountprofile.edit"),n+1),t.setState({profileData:e},(function(){return t.props.toggleProfilePopup(!0)}))):(t.sendEvent("button","add_profile",t.props.t("settingsaccountprofile.add"),""),t.setState({profileData:""},(function(){return t.props.toggleProfilePopup(!0)})))})),(0,u.Z)((0,s.Z)(t),"handleJezik",(function(e){if(e)return-1!==t.jezikList.indexOf(e.content_lang)?"sr"===e.content_lang?{content_lang:"sr",title:"Srpski"}:{content_lang:e.content_lang,title:(0,_e.fm)(e.title.split(" ")[0])}:e})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=this,e=this.props.profile,n=e.childProfile,o=e.contentLangList,a="".concat(this.apiUrl).concat(C.ve.avatars).concat(h.$h,"?for_kids=").concat(n);if(fetch(a).then((function(e){e.status<400&&e.json().then((function(e){return t.setState({avatarsList:e})}))})),!o){var r="".concat(this.apiUrl).concat(C.ve.languagesContent).concat(h.$h);fetch(r).then((function(e){e.status<400&&e.json().then((function(e){var n=e&&Array.isArray(e)&&e.map((function(e){return t.handleJezik(e)}));t.props.fetchedContentLangList(n)}))}))}}},{key:"componentWillUnmount",value:function(){this.props.toggle.profilePopup&&this.props.toggleProfilePopup(!1)}},{key:"render",value:function(){var t=this,e=this.state,n=e.profileData,a=e.avatarsList,r=this.props.profile.profileList,s=this.props.toggle,c=s.profilePopup,i=s.profileDeleteConfirmPopup,p=this.countAdultHandler(r),u=this.getMainLanguageInfo(r);return(0,o.jsxs)(v.W_,{name:"profile",children:[(0,o.jsx)("h2",{children:this.props.t("settingsaccountprofile.title")}),r&&r.length>0&&(0,o.jsxs)("div",{className:kt()["account__block-wrapper"],children:[r.map((function(e,n){return"ru"!==Z.Z.language&&e.child?null:(0,o.jsxs)("div",{id:"profile_name_".concat(n),className:"".concat(kt().account__block," ").concat(Re()["account-profile__block"]),children:[e.avatar?(0,o.jsx)("img",{className:Re()["account-profile__block-img"],src:"".concat(t.apiUrl).concat(e.avatar),onError:t.handleAvatarError,alt:t.props.t("settingsaccountprofile.avatar")}):(0,o.jsx)("img",{className:Re()["account-profile__block-img"],src:"/static/images/account/avatar.svg"}),(0,o.jsxs)("div",{className:"".concat(kt().account__data__item," ").concat(Re()["account-profile__item"]),children:[(0,o.jsx)("div",{className:kt().account__data__text,"data-testid":"profile_name_".concat(n),children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e"===e.fullname?t.props.t("profile.default"):e.fullname}),(0,o.jsx)("div",{className:"".concat(kt()["account__change-info"]," ").concat(Re()["account-profile__change-info"]),onClick:function(){return t.handleProfilePopup(e,n)},children:t.props.t("settingsaccountprofile.edit")})]})]},e._id)})),r.length<5&&(0,o.jsxs)("div",{className:"".concat(kt().account__block,"  ").concat(Re()["account-profile__block"]),children:[(0,o.jsx)("div",{className:Re()["account-profile__block-img"],children:(0,o.jsx)("div",{className:Re()["account-profile__button"],"data-testid":"add_profile",onClick:function(){return t.handleProfilePopup(null)},children:(0,o.jsx)("img",{className:Re()["account-profile__button-img"],src:"/static/images/account/plus.svg"})})}),(0,o.jsx)("div",{className:"".concat(kt().account__data__item," ").concat(Re()["account-profile__item-button"]),children:(0,o.jsx)("div",{className:"".concat(kt().account__data__text," ").concat(Re()["account-profile__button-text"]),onClick:function(){return t.handleProfilePopup(null)},children:this.props.t("settingsaccountprofile.add")})})]})]}),c&&(0,o.jsx)(Se,{profileData:n,countAdult:p,avatarsList:a,mainLanguageInfo:u}),i&&(0,o.jsx)(Ae,{profileData:n})]})}}]),n}(l.Component),Fe=(0,d.$j)((function(t){return{profile:t.profile,toggle:t.toggle,systemInformation:t.systemInformation}}),Me)((0,k.Z)()(Ue)),Ve=n(11768),We=n(94372),Ge=n(809),$e=n.n(Ge),Be=n(92447),Ke=n(22650),Je=n.n(Ke),ze=n(81877),Ye=n(55922),Xe=n.n(Ye);function qe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var Qe=function(t){(0,c.Z)(n,t);var e=qe(n);function n(){return(0,a.Z)(this,n),e.apply(this,arguments)}return(0,r.Z)(n,[{key:"render",value:function(){var t,e,n=this.props,a=n.card,r=n.small,s=n.phone,c=n.multiple,i=n.noDisabled;if(!a)return null;var p=-1!==h.I7.indexOf(a.getType())&&!i,u=!1;return new Date(null===(t=a.cardInfo_)||void 0===t||null===(e=t.card_expire)||void 0===e?void 0:e.replace(/-/g,"/"))<new Date&&-1===h.I7.indexOf(a.getType())&&-1===h.bj.indexOf(a.getType())&&(u=!0),(0,o.jsxs)("div",{className:"".concat(Xe().card," ").concat(r?Xe().small:""," ").concat(a.getCardTheme()?"":Xe().dark," ").concat(p?Xe().disabled:""),style:{backgroundColor:a.getBackgroundColor()},children:["card_cloudpayments_applepay"!==a.getType()?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:Xe()["card-logo"],children:(0,o.jsx)("img",{className:Xe()["card-bank-logo"],src:a.getLogo()?"/static/images/banks-logos/ru-".concat(a.getLogo()):"/static/images/Union.svg"})}),(0,o.jsx)("div",{className:Xe()["card-number"],style:{color:"card_googlepay"===a.getType()?a.getPaymentTextColor():""},children:a.getCardNumber()}),"card_googlepay"!==a.getType()?(0,o.jsx)("div",{className:Xe()["card-wrap"],children:a.getType()?(0,o.jsx)("div",{className:Xe()["card-text"],style:{color:a.getPaymentTextColor()},children:"megafon_payment"===a.getType()&&s?s:a.getPaymentText()}):(0,o.jsxs)(o.Fragment,{children:[a.getDateCompletion()?(0,o.jsx)("div",{className:Xe()["card-date"],children:a.getDateCompletion()}):null,a.getCardType()?(0,o.jsx)("img",{className:Xe()["card-type"],src:"/static/images/card-types/".concat(a.getCardType()).concat(a.getCardTheme()?"-light":"-dark",".svg")}):null]})}):null]}):(0,o.jsx)("div",{className:"".concat(Xe()["card-logo"]," ").concat(Xe()["card-logo--centered"]),children:(0,o.jsx)("img",{className:Xe()["card-bank-logo"],src:a.getLogo()?"/static/images/banks-logos/ru-".concat(a.getLogo()):""})}),c?(0,o.jsxs)("div",{className:Xe()["payments-multiple"],children:[(0,o.jsx)("div",{className:Xe()["payments-multiple__image"],children:(0,o.jsx)("img",{src:"/static/images/card-types/warning.svg"})}),(0,o.jsx)("div",{className:Xe()["payments-multiple__text"],children:this.props.t("cardpayment.choose")})]}):null,u?(0,o.jsxs)("div",{className:Xe()["payments-multiple"],children:[(0,o.jsx)("div",{className:Xe()["payments-multiple__image"],children:(0,o.jsx)("img",{src:"/static/images/card-types/error.svg"})}),(0,o.jsx)("div",{className:Xe()["payments-multiple__text"],children:this.props.t("cardpayment.period-ended")})]}):null,p?(0,o.jsx)("div",{className:Xe().card__disabled,children:(0,o.jsx)("img",{src:"/static/images/card-types/disabled.svg"})}):null]})}}]),n}(l.Component),tn=(0,k.Z)()(Qe),en=n(65052),nn=n(1640);function on(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function an(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?on(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):on(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function rn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var sn={fetchPaymentsLoad:nn.u,clickHouseShoot:f.F7},cn=function(t){(0,c.Z)(n,t);var e=rn(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{paymentNumberRemove:-1,isShowAlertMaxPayments:!0,mobileRemoving:!1,mobileRemovingId:null,showDisabledMessage:!1,showActivateMessage:!1,showDeleteMessage:!1,showDeleteError:!1}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"paymentRemove",function(){var e=(0,Be.Z)($e().mark((function e(n){return $e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setState({paymentNumberRemove:n}),t.sendLogs("button","trash","","",n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,u.Z)((0,s.Z)(t),"handleCardRemove",(function(e){var n=t.props.systemInformation.clickHouseData,o=an(an({},n),{},{action_id:"click",block_type:"popup",block_attributes_id:"change_payment_method",element_type:"button",element_attributes_id:"yes",element_attributes_text:t.props.t("settingsaccountpaymentpopup.yes"),event_time:(new Date).getTime()});t.props.clickHouseShoot(o);var a="".concat(t.apiUrl).concat(C.ve.paymentMethods,"/").concat(e).concat(h.$h);fetch(a,{credentials:"include",method:"DELETE"}).then((function(o){o.status<400?o.json().then((function(o){t.props.fetchPaymentsLoad(o),t.setState({mobileRemoving:!1,mobileRemovingId:null,paymentNumberRemove:-1,showDeleteMessage:!0});var a=an(an({},n),{},{action_id:"payment_method",action_result:"removed",action_attributes_str:e,event_time:(new Date).getTime()});t.props.clickHouseShoot(a)})):t.setState({showDeleteError:!0,mobileRemoving:!1,paymentNumberRemove:-1})}))})),(0,u.Z)((0,s.Z)(t),"hoverPaymentCard",(function(t){var e=t.currentTarget;e.parentElement.style.width="174px",e.parentElement.style.height="116px",e.parentElement.style.marginTop="-7.5px"})),(0,u.Z)((0,s.Z)(t),"mouseOutPaymentCard",(function(t){var e=t.currentTarget;e.parentElement.style.width="144px",e.parentElement.style.height="96px"})),(0,u.Z)((0,s.Z)(t),"cancelPaymentRemove",(function(){t.sendLogs("button","no","\u043d\u0435\u0442"),t.setState({paymentNumberRemove:-1,mobileRemoving:!1,mobileRemovingId:null})})),(0,u.Z)((0,s.Z)(t),"toggleAlertMaxPayments",(function(e){t.setState({isShowAlertMaxPayments:e})})),(0,u.Z)((0,s.Z)(t),"redirectAddPayment",(function(){t.sendLogs("button","add",t.props.t("settingsaccountpaymentpopup.add")),t.props.addCard()})),(0,u.Z)((0,s.Z)(t),"selectionPaymet",(function(e,n,o){if(n||o)t.setState({showDisabledMessage:!0});else{var a="".concat(t.apiUrl).concat(C.ve.paymentMethods,"/").concat(e,"/activate").concat(h.$h);fetch(a,{credentials:"include",method:"POST"}).then((function(e){e.status<400?e.json().then((function(e){t.props.fetchPaymentsLoad(e),t.setState({showActivateMessage:!0}),t.sendLogs()})):t.setState({showDisabledMessage:!0})}))}})),(0,u.Z)((0,s.Z)(t),"handleMobileRemove",(function(e,n){t.sendLogs("button","trash","","",n),t.setState({mobileRemoving:!0,mobileRemovingId:e})})),(0,u.Z)((0,s.Z)(t),"sendLogs",(function(e,n,o,a,r){var s=an(an({},t.props.systemInformation.clickHouseData),{},{action_id:"click",action_result:"undefined"!==a?a:"",element_type:e||"",element_attributes_id:n||"",element_attributes_text:o||"",element_attributes_index:r||"",block_type:"popup",block_attributes_id:"change_payment_method",event_time:(new Date).getTime()});t.props.clickHouseShoot(s)})),(0,u.Z)((0,s.Z)(t),"closeHandler",(function(){t.sendLogs("button","cross"),t.props.closeHandler()})),t}return(0,r.Z)(n,[{key:"render",value:function(){var t=this,e=this.props,n=e.acitveMethod,a=e.t,r=this.props.payments.payments,s=this.state,c=s.paymentNumberRemove,i=s.isShowAlertMaxPayments,p=s.mobileRemoving,u=s.mobileRemovingId,l=s.showDisabledMessage,d=s.showActivateMessage,_=s.showDeleteMessage,f=s.showDeleteError,g=this.props.systemInformation.deviceData,m=this.props.registration.authData,b=(r&&r.length?r.filter((function(t){return t.is_active})):[]).length>1;return(0,o.jsxs)("div",{className:"".concat(Je()["start-popup"]," ").concat(Je().dark),children:[(0,o.jsx)("div",{className:Je()["start-popup__close"],onClick:this.closeHandler,children:(0,o.jsx)("img",{src:"/static/images/card-types/close.svg"})}),"mobile_web"===g?(0,o.jsxs)("div",{className:"".concat(Je()["start-popup__wrapper"]," ").concat(Je().mobile),children:[n&&!b?(0,o.jsxs)("div",{className:Je().mobile__active,children:[(0,o.jsx)("div",{className:Je()["mobile__active-data"],children:(0,o.jsx)(tn,{card:n,phone:m&&m.phone})}),(0,o.jsx)("div",{className:Je()["mobile__active-wrapper"],children:(0,o.jsxs)("div",{className:Je()["mobile__active-current"],children:[(0,o.jsx)("img",{src:"/static/images/card-types/active.svg"}),(0,o.jsx)("div",{children:a("settingsaccountpaymentpopup.cur-way")})]})})]}):null,(0,o.jsxs)("div",{className:Je().mobile__cards,children:[r.map((function(e,n){var a,r,s=-1!==h.I7.indexOf(e.type),c=new ze.Z(e),i=new Date(null===(a=c.cardInfo_)||void 0===a||null===(r=a.card_expire)||void 0===r?void 0:r.replace(/-/g,"/"))<new Date&&-1===h.bj.indexOf(c.getType());if(!e.is_active||b)return(0,o.jsxs)("div",{className:Je()["mobile__cards-item"],children:[(0,o.jsx)("div",{onClick:function(){return t.selectionPaymet(e.id,s,i)},children:(0,o.jsx)(tn,{card:c,small:!0,phone:m&&m.phone})}),b||s&&"megafon_payment"!==c.getType()?null:(0,o.jsx)("div",{className:Je()["mobile__cards-item_remove"],onClick:function(){return t.handleMobileRemove(e.id,n)},children:(0,o.jsx)("img",{src:"/static/images/card-types/trashbin.svg"})})]},e.id)})),r.length>=5?null:(0,o.jsxs)("div",{className:Je().mobile__add,onClick:this.redirectAddPayment,children:[(0,o.jsx)("span",{className:Je()["payments-new__icon"],children:(0,o.jsx)("img",{src:"/static/images/card-types/new.svg"})}),(0,o.jsx)("span",{children:this.props.t("settingsaccountpaymentpopup.add")})]})]})]}):(0,o.jsxs)("div",{className:Je()["start-popup__wrapper"],children:[r.length>=5?null:(0,o.jsxs)("div",{className:Je()["payments-new"],onClick:this.redirectAddPayment,children:[(0,o.jsx)("span",{className:Je()["payments-new__icon"],children:(0,o.jsx)("img",{src:"/static/images/card-types/new.svg"})}),(0,o.jsx)("a",{children:this.props.t("settingsaccountpaymentpopup.add")})]}),r.map((function(e,n){var a,r,s=e.id,i=e.is_active,p=new ze.Z(e),u=-1!==h.I7.indexOf(p.getType()),l=new Date(null===(a=p.cardInfo_)||void 0===a||null===(r=a.card_expire)||void 0===r?void 0:r.replace(/-/g,"/"))<new Date&&-1===h.bj.indexOf(p.getType());return i&&!b?(0,o.jsxs)("div",{className:Je()["payments-item--active"],children:[(0,o.jsx)(tn,{card:p,phone:m&&m.phone}),(0,o.jsx)("span",{className:Je()["current-payment"],children:t.props.t("settingsaccountpaymentpopup.cur-way")})]},"".concat(s,"-").concat(n)):(0,o.jsxs)("div",{className:Je()["payments-item"],style:{backgroundColor:p.getBackgroundColor()},children:[(0,o.jsx)("div",{onClick:function(){return t.selectionPaymet(s,u,l)},children:(0,o.jsx)(tn,{className:Je()["popup__payments-item"],card:p,small:!0,phone:m&&m.phone,is_active:i})}),b||u&&"megafon_payment"!==p.getType()?null:c===n?(0,o.jsxs)("div",{className:Je()["popup-remove-card"],children:[(0,o.jsx)("div",{className:Je()["popup-remove-card__text"],children:t.props.t("settingsaccountpaymentpopup.sure-delete")}),(0,o.jsxs)("div",{className:Je()["popup-remove-card__control"],children:[(0,o.jsxs)("div",{onClick:function(){return t.handleCardRemove(s)},className:Je()["popup-remove-card__button-control"],children:[(0,o.jsx)("img",{src:"/static/images/card-types/payment-remove-ok.svg"}),(0,o.jsx)("span",{children:t.props.t("settingsaccountpaymentpopup.Yes")})]}),(0,o.jsxs)("div",{onClick:t.cancelPaymentRemove,className:Je()["popup-remove-card__button-control"],children:[(0,o.jsx)("img",{src:"/static/images/card-types/payment-remove.svg"}),(0,o.jsx)("span",{children:t.props.t("settingsaccountpaymentpopup.No")})]})]})]}):(0,o.jsx)("span",{className:Je()["payments-item__btn-remove"],onClick:function(){return t.paymentRemove(n)}})]},"".concat(s,"-").concat(n))}))]}),r.length>=5&&i?(0,o.jsx)(en.Z,{closePush:this.toggleAlertMaxPayments,text:this.props.t("settingsaccountpaymentpopup.max-payment-ways")}):null,l?(0,o.jsx)(en.Z,{closePush:function(){return t.setState({showDisabledMessage:!1})},text:this.props.t("settingsaccountpaymentpopup.cant-select")}):null,d?(0,o.jsx)(en.Z,{closePush:function(){return t.setState({showActivateMessage:!1})},text:this.props.t("settingsaccountpaymentpopup.successfully-changed")}):null,_?(0,o.jsx)(en.Z,{closePush:function(){return t.setState({showDeleteMessage:!1})},text:this.props.t("settingsaccountpaymentpopup.successfully-deleted")}):null,f?(0,o.jsx)(en.Z,{closePush:function(){return t.setState({showDeleteError:!1})},text:this.props.t("settingsaccountpaymentpopup.cant-delete")}):null,p?(0,o.jsxs)("div",{className:Je().remove,children:[(0,o.jsx)("div",{className:Je().remove__title,children:this.props.t("settingsaccountpaymentpopup.sure-delete")}),(0,o.jsxs)("div",{className:Je().remove__buttons,children:[(0,o.jsxs)("div",{className:Je().remove__button,onClick:function(){return t.handleCardRemove(u)},children:[(0,o.jsx)("img",{src:"/static/images/card-types/confirm.svg"}),(0,o.jsx)("span",{children:this.props.t("settingsaccountpaymentpopup.Yes")})]}),(0,o.jsxs)("div",{className:Je().remove__button,onClick:this.cancelPaymentRemove,children:[(0,o.jsx)("img",{src:"/static/images/card-types/payment-remove.svg"}),(0,o.jsx)("span",{children:this.props.t("settingsaccountpaymentpopup.No")})]})]})]}):null]})}}]),n}(l.Component),pn=(0,d.$j)((function(t){return{profile:t.profile,payments:t.payments,systemInformation:t.systemInformation,registration:t.registration}}),sn)((0,k.Z)()(cn));function un(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ln(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?un(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):un(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function dn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var _n={fetchPaymentsLoad:nn.u,fetchedPendingSubscriptions:de.hv,clickHouseShoot:f.F7},fn=function(t){(0,c.Z)(n,t);var e=dn(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{progress:!1,error:!1,visiblePaymentsPopup:!1}),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"submited",!1),(0,u.Z)((0,s.Z)(t),"handleExpiration",(function(e,n){var o=t.props.t,a=new Date;if(n)a=new Date(1e3*e);else for(var r in e)a=t.dateAdd(new Date,r,e[r]);var s=a.getDate(),c=a.getMonth(),i=a.getFullYear();return"".concat(s," ").concat(o(h.p_[c])," ").concat(i)})),(0,u.Z)((0,s.Z)(t),"handleDuration",(function(e){for(var n in e)switch(n){case"years":return"".concat(e[n],"\xa0").concat(t.declension([t.props.t("settingsaccounttariffspopup.god"),t.props.t("settingsaccounttariffspopup.goda"),t.props.t("settingsaccounttariffspopup.let")],e[n]));case"days":return e[n]<30?"".concat(e[n],"\xa0").concat(t.declension([t.props.t("settingsaccounttariffspopup.den"),t.props.t("settingsaccounttariffspopup.dnya"),t.props.t("settingsaccounttariffspopup.dney")],e[n])):t.handlePeriodTitle(e[n]);case"hours":return"".concat(e[n],"\xa0").concat(t.declension([t.props.t("settingsaccounttariffspopup.chas"),t.props.t("settingsaccounttariffspopup.chasa"),t.props.t("settingsaccounttariffspopup.chasov")],e[n]));case"minutes":return"".concat(e[n],"\xa0").concat(t.declension([t.props.t("settingsaccounttariffspopup.minuta"),t.props.t("settingsaccounttariffspopup.minuty"),t.props.t("settingsaccounttariffspopup.minut")],e[n]));case"months":default:return"".concat(e[n],"\xa0").concat(t.declension([t.props.t("settingsaccounttariffspopup.mesyac"),t.props.t("settingsaccounttariffspopup.mesyaca"),t.props.t("settingsaccounttariffspopup.mesyacev")],e[n]))}})),(0,u.Z)((0,s.Z)(t),"handlePeriodTitle",(function(e){var n=(e||30)/30;t.props.t("settingsaccounttariffspopup.mesyac");return n>1&&n<=4&&t.props.t("settingsaccounttariffspopup.mesyaca"),n>=5&&t.props.t("settingsaccounttariffspopup.mesyacev"),"".concat(n,"\xa0").concat(t.declension([t.props.t("settingsaccounttariffspopup.mesyac"),t.props.t("settingsaccounttariffspopup.mesyaca"),t.props.t("settingsaccounttariffspopup.mesyacev")],n))})),(0,u.Z)((0,s.Z)(t),"handlePrice",(function(t,e){return t%1?parseFloat(t)?"RUB"!==e?parseFloat(t).toFixed(2):parseFloat(t).toFixed(0):t:parseInt(t)})),(0,u.Z)((0,s.Z)(t),"dateAdd",(function(t,e,n){if(t instanceof Date){var o=new Date(t),a=function(){o.getDate()!=t.getDate()&&o.setDate(0)};switch(String(e).toLowerCase()){case"years":o.setFullYear(o.getFullYear()+n),a();break;case"months":o.setMonth(o.getMonth()+n),a();break;case"weeks":o.setDate(o.getDate()+7*n);break;case"days":o.setDate(o.getDate()+n);break;case"hours":o.setTime(o.getTime()+36e5*n);break;case"minutes":o.setTime(o.getTime()+6e4*n);break;case"seconds":o.setTime(o.getTime()+1e3*n);break;default:o=null}return o}})),(0,u.Z)((0,s.Z)(t),"declension",(function(t,e){return t[e%100>4&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]})),(0,u.Z)((0,s.Z)(t),"handlePayment",(function(e,n,o){var a=t.props.systemInformation,r=a.clickHouseData,s=(a.locale,t.props.registration.authData),c=ln(ln({},r),{},{action_id:"click",block_type:"popup",block_attributes_id:"tariff_confirm_pay",element_type:"button",element_attributes_id:"multiple_".concat(o),element_attributes_text:t.props.t("settingsaccounttariffspopup.prolong"),event_time:Date.now()});if(t.props.clickHouseShoot(c),s&&s.externals&&s.externals.length)y.Router.pushRoute("".concat("ru"!==Z.Z.language?"/".concat(Z.Z.language):"","/pages/subscription/already?manageable=false"));else if(!o&&!t.submited){t.submited=!0;var i="".concat(t.apiUrl).concat(C.ve.billingBuyCard).concat(e).concat(h.$h),p=Ve.ZP.load("admitad_uid"),u=Ve.ZP.load("pmkey"),l={payment_method_id:n};p&&(l.at_uid=p,l.at_campaign_code="d5244facbc",l.at_action_code=1,l.at_tariff_code=1,l.at_payment_type="sale"),u&&(l.postmarket_id=Ve.ZP.load("pmkey"));try{t.setState({progress:!0},(function(){fetch(i,{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then((function(e){e.status<400&&(e.json().then((function(e){if("Failed"===e.data.status)t.setState({progress:!1,error:!0});else{t.setState({progress:!1,error:!1});var n="".concat(t.apiUrl).concat(C.ve.subscriptionsWithPending).concat(h.$h);fetch(n,{credentials:"include"}).then((function(n){n.status<400&&n.json().then((function(n){t.props.fetchedPendingSubscriptions(n.data.subscriptions),t.props.onClose(e.data)}))}))}})),t.submited=!1)}))}))}catch(d){t.setState({progress:!1}),t.submited=!1}}})),(0,u.Z)((0,s.Z)(t),"addCardHandler",(function(e){var n="".concat(t.apiUrl).concat(C.ve.setTariff).concat(e).concat(h.$h);fetch(n,{method:"GET",credentials:"include"}).then((function(t){t.status<400&&t.text().then((function(t){t&&((0,h.kT)("addCard","",window.location.host),(0,h.d8)("defaultBuy",!0,window.location.host),window.location=(0,C.hh)(t,Z.Z.language))}))}))})),(0,u.Z)((0,s.Z)(t),"closeHandler",(function(e){var n=ln(ln({},t.props.systemInformation.clickHouseData),{},{action_id:"click",action_result:"close",block_type:"popup",block_attributes_id:"tariff_confirm_pay",element_type:"button",element_attributes_text:e?t.props.t("settingsaccounttariffspopup.close"):"",event_time:Date.now()});t.props.clickHouseShoot(n),(0,h.kT)("selectedTariff","",window.length.host),t.props.onClose()})),(0,u.Z)((0,s.Z)(t),"handleChange",(function(e,n){Ve.ZP.save("selectedTariff",e,{path:"/",domain:(0,C.tm)(window.location.host)});var o=t.props.payments.payments;if(o&&o.length>1)t.setState({visiblePaymentsPopup:!0});else{(0,h.d8)("defaultBuy",!0,window.location.host);var a=null;try{a=ga.getAll()[0].get("clientId")}catch(c){}var r=(0,C.mC)("".concat(t.apiUrl).concat(n).concat(h.$h).concat(a?"&ga_id=".concat(a):""));fetch(r,{method:"GET",credentials:"include"}).then((function(t){t.status<400&&t.text().then((function(t){window.location=(0,C.hh)(t,Z.Z.language)}))}))}var s=ln(ln({},t.props.systemInformation.clickHouseData),{},{action_id:"click",action_result:"change",block_type:"popup",block_attributes_id:"tariff_confirm_pay",element_type:"link",element_attributes_id:"change",element_attributes_text:t.props.t("settingsaccounttariffspopup.change"),event_time:Date.now()});t.props.clickHouseShoot(s)})),t}return(0,r.Z)(n,[{key:"render",value:function(){var t,e=this,n=this.props,a=n.longestSubscription,r=n.acitveMethod,s=n.userTrial,c=n.multiple,i=n.phone,p=this.props.data,u=p.allow_trial,l=p.paid_period_duration,d=p.trial_period_duration,_=p.price,f=p.currency,g=p._id,m=p.url,b=this.state,v=b.progress,y=b.error,P=b.visiblePaymentsPopup,w=!1;return new Date(null===r||void 0===r||null===(t=r.cardInfo_)||void 0===t?void 0:t.card_expire.replace(/-/g,"/"))<new Date&&-1===h.I7.indexOf(null===r||void 0===r?void 0:r.getType())&&-1===h.bj.indexOf(null===r||void 0===r?void 0:r.getType())&&(w=!0),(0,o.jsxs)("div",{className:Je().tariffsPopup,children:[(0,o.jsxs)("div",{className:Je().tariffsPopup__wrapper,children:[(0,o.jsx)("div",{className:Je().tariffsPopup__close,onClick:function(){return e.closeHandler(!1)},children:(0,o.jsx)("img",{src:"/static/images/popups/cross.svg"})}),(0,o.jsx)("div",{className:Je().tariffsPopup__title,children:a?this.props.t("settingsaccounttariffspopup.change-sub-period"):this.props.t("settingsaccounttariffspopup.subscribe")}),(0,o.jsx)("div",{className:Je().tariffsPopup__description,dangerouslySetInnerHTML:{__html:a?this.props.t("settingsaccounttariffspopup.sub-info",{expiration:this.handleExpiration(a.expiration,!0),duration:this.handleDuration(l),price:this.handlePrice(_,f),currency:f}):u&&s?this.props.t("settingsaccounttariffspopup.sub-info",{expiration:this.handleExpiration(d,!1),duration:this.handleDuration(l),price:this.handlePrice(_,f),currency:f}):this.props.t("settingsaccounttariffspopup.sub-1-info",{duration:this.handleDuration(l),price:this.handlePrice(_,f),currency:f})}}),(0,o.jsxs)("div",{className:Je().tariffsPopup__data,children:[(0,o.jsx)("div",{className:Je().tariffsPopup__card,children:(0,o.jsx)(tn,{card:r,multiple:c,phone:i})}),(0,o.jsxs)("div",{className:Je().tariffsPopup__bg,children:[(0,o.jsx)("div",{className:Je().tariffsPopup__link,children:(0,o.jsx)("div",{className:Je().tariffsPopup__change,onClick:function(){return e.handleChange(g,m)},children:this.props.t("settingsaccounttariffspopup.change")})}),(0,o.jsx)("div",{className:"".concat(Je().tariffsPopup__ok," ").concat(c||w?Je().disabled:""),onClick:function(){return e.handlePayment(g,r.cardInfo_.id,c||w)},children:v?(0,o.jsx)(L.Z,{}):a?this.props.t("settingsaccounttariffspopup.prolong"):this.props.t("settingsaccounttariffspopup.subscribe-2")}),(0,o.jsx)("div",{className:Je().tariffsPopup__cancel,onClick:function(){return e.closeHandler(!0)},children:this.props.t("settingsaccounttariffspopup.close")}),y?(0,o.jsx)("div",{className:Je().tariffsPopup__error,children:this.props.t("settingsaccounttariffspopup.try-later")}):null]})]}),(0,o.jsx)("div",{className:Je().tariffsPopup__info,children:this.props.t("settingsaccounttariffspopup.1-month")})]}),P?(0,o.jsx)(pn,{closeHandler:function(){e.setState({visiblePaymentsPopup:!1})},addCard:function(){return e.addCardHandler(g)},acitveMethod:r}):null]})}}]),n}(l.Component),hn=(0,d.$j)((function(t){return{payments:t.payments,systemInformation:t.systemInformation,registration:t.registration}}),_n)((0,k.Z)()(fn)),gn=n(9489),mn=n.n(gn);function bn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function vn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bn(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function yn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var Pn={toggleDisableReccurentPopup:A.Zj,toggleConfirmPaymentPopup:A.xn,toggleErrorPopup:A.pH,fetchedTariffs:N.ZX,fetchedSubscriptions:de._5,clickHouseShoot:f.F7,fetchedPendingSubscriptions:de.hv,fetchPaymentsLoad:nn.u},wn=function(t){(0,c.Z)(n,t);var e=yn(n);function n(){var t;(0,a.Z)(this,n);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return t=e.call.apply(e,[this].concat(c)),(0,u.Z)((0,s.Z)(t),"state",{requestedTariff:!1,loading:!1,card:[],visiblePaymentsPopup:!1,visibleTariffsSelectPopup:!1,tariffsSelectData:null,isLoadingCards:!1,megafonMessage:!1,redirectedPush:Ve.ZP.load("addCardRedirect"),redirectedPushShootFlag:Ve.ZP.load("addCardRedirect"),paymentChange:!1}),(0,u.Z)((0,s.Z)(t),"stop",!1),(0,u.Z)((0,s.Z)(t),"stopWithoutTags",!1),(0,u.Z)((0,s.Z)(t),"chooseDesign",!1),(0,u.Z)((0,s.Z)(t),"updateTag",!1),(0,u.Z)((0,s.Z)(t),"dateNow",parseInt((Date.now()/1e3).toFixed())),(0,u.Z)((0,s.Z)(t),"redirectedShootFlag",!1),(0,u.Z)((0,s.Z)(t),"apiUrl",t.props.systemInformation.API_URL||h.T5),(0,u.Z)((0,s.Z)(t),"fetchSubscriptions",(function(){var e="".concat(t.apiUrl).concat(C.ve.subscriptionsWithPending).concat(h.$h);fetch(e,{credentials:"include"}).then((function(e){e.status<400&&e.json().then((function(e){t.props.fetchedPendingSubscriptions(e.data.subscriptions),t.setState({loading:!1})}))}))})),(0,u.Z)((0,s.Z)(t),"fetchPaymentMethods",(function(){var e="".concat(t.apiUrl).concat(C.ve.getPaymentMethods).concat(h.$h);fetch(e,{credentials:"include"}).then((function(e){e.status<400&&e.json().then((function(e){e&&e.length&&t.setState({cards:e,isLoadingCards:!0}),t.props.fetchPaymentsLoad(e)}))}))})),(0,u.Z)((0,s.Z)(t),"tryHandler",(function(){(0,h.kT)("selectedTariff","",window.location.host);var e=t.props.registration.tariffs.filter((function(t){return 0===t.weight&&t.allow_trial}))[0];e?t.getPaymentLink(e):console.error(">>> no default traiff")})),(0,u.Z)((0,s.Z)(t),"addCardHandler",(function(){var e="".concat(t.apiUrl).concat(C.ve.addCard).concat(h.$h);fetch(e,{method:"GET",credentials:"include"}).then((function(t){t.status<400&&t.text().then((function(t){t&&(Ve.ZP.save("addCard",!0,{path:"/",domain:(0,C.tm)(window.location.host)}),window.location=(0,C.hh)(t,Z.Z.language))}))}))})),(0,u.Z)((0,s.Z)(t),"getPaymentLink",(function(e){localStorage.removeItem("url");var n=null;try{n=ga.getAll()[0].get("clientId")}catch(a){}var o=(0,C.mC)("".concat(t.apiUrl).concat(e.url).concat(h.$h).concat(n?"&ga_id=".concat(n):""));fetch(o,{credentials:"include"}).then((function(e){e.status<400?e.text().then((function(t){return window.location=(0,C.hh)(t,Z.Z.language)})):t.props.toggleErrorPopup(!0)}))})),(0,u.Z)((0,s.Z)(t),"autoControlHandler",(function(e){var n=e.target.checked;t.sendLogs("switch","recurrent","",n),t.manageSubscription(n)})),(0,u.Z)((0,s.Z)(t),"subscriptionOnHandler",(function(){t.sendLogs("button","renew_subscription",t.props.t("settingsaccountsubscription.renew")),t.manageSubscription(!0)})),(0,u.Z)((0,s.Z)(t),"manageSubscription",(function(e){var n=t.props.registration.authData,o=new Date(2018,6,1,0,0),a=t.props.profile.pendingSubscription,r=a&&a.length&&a.filter((function(e){return e.manageable&&(t.dateNow<e.expiration||t.dateNow>e.expiration&&t.dateNow<e.billing_expire)})),s=r&&r.length?r[r.length-1]:null;if(n&&!1===n.status_gdpr&&n&&new Date(n.date_created)<=o&&n.current_country_code&&"RU"!==n.current_country_code&&n.subscriptions[0]&&e)t.props.toggleConfirmPaymentPopup({on:!0,isReccurent:!0,isPaymentForm:!1});else if(e){var c="".concat(t.apiUrl).concat(C.ve.reccurent,"/").concat(s.tariff_info._id).concat(h.$h);t.setState({loading:!0}),fetch(c,{method:"PUT",credentials:"include",body:JSON.stringify({auth_token:n.authentication_token}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){e.status<400&&t.fetchSubscriptions()})).catch((function(t){return console.error(t)}))}else t.props.toggleDisableReccurentPopup(!0)})),(0,u.Z)((0,s.Z)(t),"sendLogs",(function(e,n,o,a){var r=vn(vn({},t.props.systemInformation.clickHouseData),{},{action_id:"click",action_result:"undefined"!==a?a:"",element_type:e||"",element_attributes_id:n||"",element_attributes_text:o||"",block_type:"block",block_attributes_id:"subscriptions",event_time:(new Date).getTime()});t.props.clickHouseShoot(r)})),(0,u.Z)((0,s.Z)(t),"handlePeriodTitle",(function(e){var n=(e||30)/30;return"".concat(n," ").concat(t.declension([t.props.t("settingsaccountsubscription.mesyac"),t.props.t("settingsaccountsubscription.mesyaca"),t.props.t("settingsaccountsubscription.mesyacev")],n))})),(0,u.Z)((0,s.Z)(t),"declension",(function(t,e){return t[e%100>4&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]})),(0,u.Z)((0,s.Z)(t),"isInteger",(function(t,e){return t%1?parseFloat(t)?"RUB"!==e?parseFloat(t).toFixed(2):parseFloat(t).toFixed(0):t:parseInt(t)})),(0,u.Z)((0,s.Z)(t),"handleClick",(function(e,n,o,a){if(a===e._id)return!1;if(n||o){var r="/pages/subscription/already?manageable=false";n&&(r+="&itunes_product_id=true"),o&&(r+="&googleplay_id=true"),y.Router.pushRoute("".concat("ru"!==Z.Z.language?"/".concat(Z.Z.language):"").concat(r))}var s=t.props.payments.acitveMethod,c=vn(vn({},t.props.systemInformation.clickHouseData),{},{action_id:"click",block_type:"block",block_attributes_id:e._id,element_type:"tariff_item",element_attributes_text:e.title,event_time:Date.now()});if(t.props.clickHouseShoot(c),s){if(s.bank_)if("Megafon Payment"===s.bank_.name)t.setState({megafonMessage:!0});else if(-1!==["Apple Store","Google Play"].indexOf(s.bank_.name)){var i="/pages/subscription/already?manageable=false";switch(s.bank_.name){case"Apple Store":i+="&itunes_product_id=true";break;case"Google Play":i+="&googleplay_id=true"}y.Router.pushRoute("".concat("ru"!==Z.Z.language?"/".concat(Z.Z.language):"").concat(i))}else t.setState({visibleTariffsSelectPopup:!0,tariffsSelectData:e});else t.setState({visibleTariffsSelectPopup:!0,tariffsSelectData:e})}else t.redirectTo(e.url,e._id)})),(0,u.Z)((0,s.Z)(t),"closeTariffSelectPopup",(function(e){t.setState({visibleTariffsSelectPopup:!1,tariffsSelectData:null,paymentChange:!!e&&t.parseDate(e.expire)})})),(0,u.Z)((0,s.Z)(t),"redirectTo",(function(e,n){Ve.ZP.save("selectedTariff",n,{path:"/",domain:(0,C.tm)(window.location.host)});var o=t.props.registration.authData,a=t.props.profile.pendingSubscription;if(a&&a.length||o.externals.length){var r=a.sort((function(t,e){return t.expiration<e.expiration?1:t.expiration>e.expiration?-1:0}))[0];if(o.externals.length){return void y.Router.pushRoute("".concat("ru"!==Z.Z.language?"/".concat(Z.Z.language):"").concat("/pages/subscription/already"))}if(r.tariff_info.price.googleplay_id||r.tariff_info.price.itunes_product_id){var s="/pages/subscription/already?manageable=".concat(r.manageable);r.tariff_info.price.googleplay_id&&(s+="&googleplay_id=true"),r.tariff_info.price.itunes_product_id&&(s+="&itunes_product_id=true"),y.Router.pushRoute("".concat("ru"!==Z.Z.language?"/".concat(Z.Z.language):"").concat(s))}else t.requestRedirect(e)}else!o||o.email||o.phone?t.requestRedirect(e):(localStorage.setItem("url",e),y.Router.pushRoute("".concat("ru"!==Z.Z.language?"/".concat(Z.Z.language):"","/signup")))})),(0,u.Z)((0,s.Z)(t),"requestRedirect",(function(e){var n=null;try{n=ga.getAll()[0].get("clientId")}catch(a){}var o=(0,C.mC)("".concat(t.apiUrl).concat(e).concat(h.$h).concat(n?"&ga_id=".concat(n):""));fetch(o,{method:"GET",credentials:"include"}).then((function(t){t.status<400&&t.text().then((function(t){window.location=(0,C.hh)(t,Z.Z.language)}))}))})),(0,u.Z)((0,s.Z)(t),"fetchSubscriptions",(function(){var e="".concat(t.apiUrl).concat(C.ve.subscriptionsWithPending).concat(h.$h);fetch(e,{credentials:"include"}).then((function(e){e.status<400&&e.json().then((function(e){t.props.fetchedPendingSubscriptions(e.data.subscriptions)}))}))})),(0,u.Z)((0,s.Z)(t),"handleExpire",(function(e){var n=t.props.t,o=new Date(1e3*e),a=o.getDate(),r=n(h.p_[o.getMonth()]),s=o.getFullYear();return"".concat(a," ").concat(r," ").concat(s)})),(0,u.Z)((0,s.Z)(t),"handleDiscount",(function(e,n,a){var r=parseFloat((parseInt(e)/(n.days/30)).toFixed(2));"RUB"!==a&&(r=e/(n.days/30));var s=t.state.tariffsToRender[0];return r<h.Jn?"RUB"==a?(0,o.jsx)("sup",{className:mn().discount,children:"-".concat((100-100*r/h.Jn).toFixed(),"%")}):(0,o.jsx)("sup",{className:mn().discount,children:"-".concat((100-100*r/s.price).toFixed(),"%")}):null})),(0,u.Z)((0,s.Z)(t),"handleDescription",(function(e,n,o,a){return e?t.props.t("settingsaccountsubscription.subscription-ended"):n||o.tariff_info.price.googleplay_id||o.tariff_info.price.itunes_product_id?n&&o&&a&&o.reccurent?t.props.t("settingsaccountsubscription.subscription-renewed"):t.props.t("settingsaccountsubscription.subscription-will-end"):o.reccurent?t.props.t("settingsaccountsubscription.subscription-renewed"):t.props.t("settingsaccountsubscription.subscription-will-end")})),(0,u.Z)((0,s.Z)(t),"closePaymentsPopup",(function(){t.setState({visiblePaymentsPopup:!t.state.visiblePaymentsPopup})})),(0,u.Z)((0,s.Z)(t),"cardChange",(function(e){if(!e){t.sendLogs("link","change","\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c");var n=t.props.payments,o=n.payments,a=n.acitveMethod;a.bank_&&a.bank_.type&&!a.bank_.canChange||(o&&o.length>1?t.setState({visiblePaymentsPopup:!0}):t.addCardHandler())}})),(0,u.Z)((0,s.Z)(t),"parseDate",(function(t){var e=new Date(1e3*t),n=e.getFullYear(),o=e.getMonth()+1,a=e.getDate();return"".concat(a<10?"0".concat(a):a,".").concat(o<10?"0".concat(o):o,".").concat(n)})),(0,u.Z)((0,s.Z)(t),"handleRateSteps",(function(t){var e=(0,fe.Z)(t);return e.sort((function(t,e){return t.order_number>e.order_number?1:e.order_number>t.order_number?-1:0})),e[0]})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=this;(0,h.RZ)(),(0,h.kT)("addCardRedirect","",window.location.host);var e=this.props.registration.tariffs;if(e&&e.length)this.setState({tariffsToRender:e.sort((function(t,e){return t.paid_period_duration.days>e.paid_period_duration.days?1:t.paid_period_duration.days<e.paid_period_duration.days?-1:0}))});else{var n="".concat(this.apiUrl).concat(C.ve.getTariffs).concat(h.$h);fetch(n,{credentials:"include"}).then((function(e){t.setState({loading:!1}),e.status<400&&e.json().then((function(e){t.props.fetchedTariffs(e),t.setState({tariffsToRender:e.sort((function(t,e){return t.paid_period_duration.days>e.paid_period_duration.days?1:t.paid_period_duration.days<e.paid_period_duration.days?-1:0}))})}))}))}this.fetchSubscriptions(),this.fetchPaymentMethods()}},{key:"componentDidUpdate",value:function(t,e){var n=this.state,o=n.visiblePaymentsPopup,a=n.redirectedPushShootFlag,r=e.visiblePaymentsPopup;o||o===r||this.fetchPaymentMethods();var s=this.props.systemInformation.clickHouseData;if(a&&!this.redirectedShootFlag&&s){this.redirectedShootFlag=!0;var c=vn(vn({},s),{},{action_id:"payment_method",action_result:"added",block_type:"block",block_attributes_id:"subscriptions",event_time:(new Date).getTime()});this.props.clickHouseShoot(c)}}},{key:"render",value:function(){var t=this,e=this.props.registration.authData;if(!e)return null;var n=this.state,a=n.loading,r=n.visiblePaymentsPopup,s=n.tariffsToRender,c=n.visibleTariffsSelectPopup,i=n.tariffsSelectData,p=n.megafonMessage,u=n.redirectedPush,d=n.paymentChange,_=this.props.profile.pendingSubscription,f=this.props.payments,h=f.acitveMethod,g=f.payments,m=_&&_.length&&_.filter((function(e){return e.manageable&&(t.dateNow<e.expiration||t.dateNow>e.expiration&&t.dateNow<e.billing_expire)})),b=m&&m.length?m[m.length-1]:null,P=(0,C.Ik)(_),w=_&&_.length&&_.filter((function(e){return!e.manageable&&(t.dateNow<e.expiration||t.dateNow>e.expiration&&t.dateNow<e.billing_expire)})),k=w&&w.length?w[w.length-1]:null,j=P&&P.manageable&&this.dateNow>P.expiration&&this.dateNow<P.billing_expire,x=P&&P.manageable&&this.dateNow<P.expiration&&P.expiration<P.billing_expire,S=e.externals&&0!=e.externals.length,D=g&&g.length?g.filter((function(t){return t.is_active})):[],O=g&&g.length?g.find((function(t){return"itunes_receipt"===t.type})):null,E=g&&g.length?g.find((function(t){return"google_token"===t.type})):null,N=D.length>1;return(0,o.jsxs)(v.W_,{name:"subscription",children:[(0,o.jsx)("h2",{children:this.props.t("settingsaccountsubscription.add")}),(0,o.jsx)("div",{className:mn()["subscription-container"],children:(0,o.jsx)("div",{children:(0,o.jsxs)("div",{className:mn()["account-subscriptions"],children:[b||k||j||x||P?(0,o.jsx)(l.Fragment,{children:(0,o.jsxs)("div",{className:mn()["account-subscriptions__subscription"],children:[(0,o.jsxs)("div",{className:mn()["account-subscriptions__left"],children:[_&&_.length>1?(0,o.jsx)("div",{className:mn()["account-subscriptions__name"],children:this.props.t("settingsaccountsubscription.subscription-start")}):P?(0,o.jsx)("div",{className:mn()["account-subscriptions__name"],children:P.tariff_info&&P.tariff_info.title}):(0,o.jsx)("div",{className:mn()["account-subscriptions__name"],children:k.tariff_info&&k.tariff_info.title}),P&&P.expiration&&!S?(0,o.jsxs)("div",{className:mn()["account-subscriptions__subtitle"],children:[this.handleDescription(j,x,P,k)," ",this.handleExpire(P.expiration)]}):k&&k.expiration&&!S?(0,o.jsxs)("div",{className:mn()["account-subscriptions__subtitle"],children:[this.handleDescription(j,x,k)," ",this.handleExpire(k.expiration)]}):null]}),(0,o.jsxs)("div",{className:"".concat(mn()["account-subscriptions__right"]," ").concat(mn()["account-subscriptions__link"]),children:[S?null:(0,o.jsx)(y.Link,{prefetch:!1,route:"".concat("ru"!==Z.Z.language?"/".concat(Z.Z.language):"","/payment_history"),children:(0,o.jsx)("a",{onClick:function(){return t.sendLogs("link","more_details",t.props.t("settingsaccountsubscription.more"))},children:this.props.t("settingsaccountsubscription.more")})}),b&&b.manageable&&!b.reccurent?(0,o.jsx)("div",{className:mn()["account-subscriptions__button-wrapper"],children:(0,o.jsx)(We.Z,{text:this.props.t("settingsaccountsubscription.renew"),type:"buy",blockInfo:{block_type:"block",block_attributes_id:"subscriptions"},page:"settings",onClick:this.subscriptionOnHandler,spinner:a,testid:"payment_button"})}):null]})]})}):S?this.props.t("settingsaccountsubscription.no"):(j||x)&&b&&b.manageable&&b.reccurent&&!k?(0,o.jsx)("div",{className:mn()["account-subscriptions__button-wrapper"],children:(0,o.jsx)(We.Z,{text:this.props.t("settingsaccountsubscription.buy"),type:"buy",blockInfo:{block_type:"block",block_attributes_id:"subscriptions"},page:"settings",onClick:this.tryHandler,spinner:a,testid:"payment_button"})}):null,_&&_.length||S?null:(0,o.jsx)("div",{className:mn().marginB,children:(0,o.jsx)(We.Z,{text:this.props.t("settingsaccountsubscription.buy"),type:"buy",blockInfo:{block_type:"block",block_attributes_id:"subscriptions"},page:"settings",onClick:this.tryHandler,spinner:a,testid:"payment_button"})}),h?(0,o.jsxs)("div",{className:mn()["account-payments"],children:[(0,o.jsx)("div",{onClick:function(){return t.cardChange(O||E)},className:h.bank_&&h.bank_.type&&!h.bank_.canChange?mn().defaultPointer:"",children:(0,o.jsx)(tn,{card:O?new ze.Z(O):E?new ze.Z(E):h,phone:e.phone,multiple:!O&&!E&&N,noDisabled:!0})}),h.bank_&&h.bank_.type&&!h.bank_.canChange||O||E?null:(0,o.jsx)("div",{className:mn()["account-payments__link"],children:(0,o.jsx)("a",{onClick:function(){return t.cardChange(!1)},children:this.props.t("settingsaccountsubscription.change")})})]}):null]})})}),s&&s.length?(0,o.jsxs)(l.Fragment,{children:[(0,o.jsx)("h2",{dangerouslySetInnerHTML:{__html:this.props.t("settingsaccountsubscription.benefit")}}),(0,o.jsx)("div",{className:mn().subscriptions,children:s.map((function(n,a){var r=b&&b.tariff_info&&b.tariff_info._id,s=r===n._id,c=n.currency,i=n.rate_steps&&n.rate_steps.length,p=i&&e.trial_is_available?t.handleRateSteps(n.rate_steps):n;return(0,o.jsxs)("div",{className:"".concat(mn().tariff," ").concat(s?mn().current:""),onClick:function(){return t.handleClick(n,O,E,r)},children:[(0,o.jsxs)("div",{className:mn().wrapper,children:[(0,o.jsxs)("div",{className:mn().price,children:[(0,o.jsx)("div",{className:mn().duration,children:t.handlePeriodTitle(i&&e.trial_is_available?p.duration.days:p.paid_period_duration.days)}),(0,o.jsx)("div",{className:mn().total,children:"".concat(a>0?"RUB"==c?t.isInteger(p.price):p.price:""," ").concat(a>0?"RUB"==c?"\u20bd":c:"")})]}),(0,o.jsxs)("div",{className:mn().pay,children:[(0,o.jsx)("div",{className:mn().month,children:"".concat(0===a?"RUB"!=c?p.price:t.isInteger(p.price):t.isInteger(p.price/((i&&e.trial_is_available?p.duration.days:p.paid_period_duration.days)/30),c)," ").concat("RUB"==c?"\u20bd":c)}),(0,o.jsx)("div",{className:mn().period,children:t.props.t("settingsaccountsubscription.per-month")})]}),a>0?t.handleDiscount(p.price,i&&e.trial_is_available?p.duration:p.paid_period_duration,c):null]}),s?(0,o.jsxs)("div",{className:mn().own,children:[(0,o.jsx)("img",{src:"/static/images/account/check.svg"}),(0,o.jsx)("span",{children:t.props.t("settingsaccountsubscription.your-subs")})]}):null]},n._id)}))}),(0,o.jsxs)("div",{className:mn().tip,children:[e.trial_is_available?"".concat(this.props.t("settingsaccountsubscription.first-7")," "):"",this.props.t("settingsaccountsubscription.1-month")]})]}):null,r?(0,o.jsx)(pn,{closeHandler:this.closePaymentsPopup,addCard:this.addCardHandler,acitveMethod:h}):null,c?(0,o.jsx)(hn,{data:i,acitveMethod:h,longestSubscription:P,userTrial:e.trial_is_available,reloadSubscriptions:this.fetchSubscriptions,onClose:this.closeTariffSelectPopup,multiple:N,addCardHandler:this.addCardHandler,phone:e.phone}):null,p?(0,o.jsx)(en.Z,{closePush:function(){return t.setState({megafonMessage:!1})},text:this.props.t("settingsaccountsubscription.not-available")}):null,u?(0,o.jsx)(en.Z,{closePush:function(){return t.setState({redirectedPush:!1})},text:this.props.t("settingsaccountsubscription.changed")}):null,d?(0,o.jsx)(en.Z,{closePush:function(){return t.setState({paymentChange:!1})},text:"".concat(this.props.t("settingsaccountsubscription.extended")," ").concat(d)}):null]})}}]),n}(l.Component),kn=(0,d.$j)((function(t){return{payments:t.payments,profile:t.profile,toggle:t.toggle,registration:t.registration,systemInformation:t.systemInformation}}),Pn)((0,k.Z)()(wn));function Zn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function jn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zn(Object(n),!0).forEach((function(e){(0,u.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function xn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var Sn={setSourceData:f.Kv,personalDataRememberPush:m.Jl,accountChangeEmailPush:m.s$,accountEmailPush:m.ih,accountChangePasswordPush:m.ow,accountChangePhonePush:m.sl,accountAddPhonePush:m.zN,accountChangeProfilePush:m.kq,accountAddProfilePush:m.XV,accountDeleteProfilePush:m.Dm},Dn=function(t){(0,c.Z)(n,t);var e=xn(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"state",{offset:80}),(0,u.Z)((0,s.Z)(t),"resizeHandler",(function(){var e=window.innerWidth;window.innerWidth>1440&&t.setState({offset:parseInt(100*e/1440)})})),(0,u.Z)((0,s.Z)(t),"debounce",(function(t,e){var n;return function(){for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];n&&clearTimeout(n),n=setTimeout((function(){return t.apply(void 0,a)}),e)}})),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var t=this.props.registration.authData;!t||t.email||t.phone||Router.pushRoute("ru"!==Z.Z.language?"/".concat(Z.Z.language):"/"),(0,h.kT)("coupon_duration","",window.location.host),(0,h.kT)("coupon_price","",window.location.host),(0,h.kT)("coupon_currency","",window.location.host),(0,h.kT)("coupon_code","",window.location.host),(0,h.kT)("coupon_paid_period_duration","",window.location.host),(0,h.kT)("addCard","",window.location.host),(0,h.kT)("defaultBuy","",window.location.host),this.resizeHandler(),window.addEventListener("resize",this.debounce(this.resizeHandler,100))}},{key:"componentWillUnmount",value:function(){this.props.setSourceData({sourceId:"/account",sourceTitle:this.props.t("settings.title")});var t=this.props.pushData,e=t.personalDataRemember,n=t.accountChangeEmail,o=t.accountEmail,a=t.accountChangePassword,r=t.accountChangePhone,s=t.accountAddPhone,c=t.accountChangeProfile,i=t.accountAddProfile,p=t.accountDeleteProfile;e&&this.props.personalDataRememberPush(!1),n&&this.props.accountChangeEmailPush(!1),o&&this.props.accountEmailPush(!1),a&&this.props.accountChangePasswordPush(!1),r&&this.props.accountChangePhonePush(!1),s&&this.props.accountAddPhonePush(!1),c&&this.props.accountChangeProfilePush(!1),i&&this.props.accountAddProfilePush(!1),p&&this.props.accountDeleteProfilePush(!1),window.removeEventListener("resize",this.debounce)}},{key:"render",value:function(){var t=this.props.pushData,e=t.personalDataRemember,n=t.accountChangeEmail,a=t.accountEmail,r=t.accountChangePassword,s=t.accountChangePhone,c=t.accountAddPhone,i=t.accountChangeProfile,p=t.accountAddProfile,u=t.accountDeleteProfile,l=this.state.offset,d=[{title:this.props.t("settings.title"),name:this.props.t("settings.title")}];return(0,o.jsxs)("div",{className:kt().account,children:[(0,o.jsx)(_.default,{children:(0,o.jsx)("title",{children:this.props.t("settings.title")})}),(0,o.jsx)(b.Z,{breadcrumbs:d}),(0,o.jsx)("h1",{children:this.props.t("settings.title")}),(0,o.jsx)(g.L9,{children:(0,o.jsxs)("div",{className:kt().account__wrapper,children:[(0,o.jsx)("div",{className:kt().account__left,children:(0,o.jsx)(g.Le,{topOffset:-l,children:function(t){var e=t.style,n={};t.distanceFromBottom<=0&&(n={position:"static"});var a=jn(jn(jn({},e),n),{},{top:"".concat(l,"px"),zIndex:"10"});return(0,o.jsx)("div",{style:a,children:(0,o.jsx)(E,{})})}})}),(0,o.jsxs)("div",{className:kt().account__right,children:[(0,o.jsx)(le,{}),(0,o.jsx)(Et,{}),(0,o.jsx)(Fe,{}),(0,o.jsx)(kn,{})]})]})}),e&&(0,o.jsx)(en.Z,{closePush:this.props.personalDataRememberPush,text:this.props.t("push.remember")}),n&&(0,o.jsx)(en.Z,{closePush:this.props.accountChangeEmailPush,text:this.props.t("push.changeemail")}),a&&(0,o.jsx)(en.Z,{closePush:this.props.accountEmailPush,text:this.props.t("push.add")}),r&&(0,o.jsx)(en.Z,{closePush:this.props.accountChangePasswordPush,text:this.props.t("push.changepassword")}),s&&(0,o.jsx)(en.Z,{closePush:this.props.accountChangePhonePush,text:this.props.t("push.add")}),c&&(0,o.jsx)(en.Z,{closePush:this.props.accountAddPhonePush,text:this.props.t("push.add")}),i&&(0,o.jsx)(en.Z,{closePush:this.props.accountChangeProfilePush,text:this.props.t("push.changeprofile")}),p&&(0,o.jsx)(en.Z,{closePush:this.props.accountAddProfilePush,text:this.props.t("push.addprofile")}),u&&(0,o.jsx)(en.Z,{closePush:this.props.accountDeleteProfilePush,text:this.props.t("push.deleteprofile")})]})}}]),n}(l.Component),On=(0,d.$j)((function(t){return{registration:t.registration,pushData:t.pushData,systemInformation:t.systemInformation}}),Sn)((0,k.Z)()(Dn));function En(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,i.Z)(this,n)}}var Cn=function(t){(0,c.Z)(n,t);var e=En(n);function n(){var t;(0,a.Z)(this,n);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return t=e.call.apply(e,[this].concat(r)),(0,u.Z)((0,s.Z)(t),"authFlag",!1),t}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){var t=this.props.registration.authData;!t||t.email||t.phone||this.authFlag||(this.authFlag=!0,y.Router.pushRoute("ru"!==Z.Z.language?"/".concat(Z.Z.language,"/signup"):"/signup"))}},{key:"render",value:function(){var t=this.props.registration.authData;return t&&(t.email||t.phone)?(0,o.jsx)(On,{authData:t}):null}}]),n}(l.Component),Nn=(0,d.$j)((function(t){return{registration:t.registration,systemInformation:t.systemInformation}}))(Cn)},93290:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account",function(){return n(82035)}])},75937:function(t){t.exports={account:"Account_account__3XYTe",account__wrapper:"Account_account__wrapper__1RtG-",account__left:"Account_account__left__JEHtK",account__right:"Account_account__right__1guGx","account__change-info":"Account_account__change-info__33jDM","account__change-info-wrapper":"Account_account__change-info-wrapper__Ix7J0","account__block-wrapper":"Account_account__block-wrapper__F6wzV",account__block:"Account_account__block__1YO2k",account__data__label:"Account_account__data__label__3xzxZ",account__data__item:"Account_account__data__item__3YDCT",account__data__text:"Account_account__data__text__23ACf",account__block__label:"Account_account__block__label__WxNOV",account__block__item:"Account_account__block__item__1TtpI","account__change-info-mobile":"Account_account__change-info-mobile__3fppM","account__tell-about":"Account_account__tell-about__FRUIE",account_page_content_row:"Account_account_page_content_row__1hK0N",onoffswitch:"Account_onoffswitch__3H4fn",account_page_content_data:"Account_account_page_content_data__1nKBB",account_page_tariff_reccurent_title:"Account_account_page_tariff_reccurent_title__24d49",recurrent:"Account_recurrent__3B2Aj","recurrent__title-type":"Account_recurrent__title-type__2o6et","recurrent__title-head":"Account_recurrent__title-head__1LrPM","recurrent__title-list":"Account_recurrent__title-list__9jzhh","recurrent__switcher-title":"Account_recurrent__switcher-title__35-Cy",disabled:"Account_disabled__3ljiF",account_page_global_wrapper:"Account_account_page_global_wrapper__1llRh",account_page_content:"Account_account_page_content__20RoY",account_page_content_title:"Account_account_page_content_title__3rPDP",account_page_email:"Account_account_page_email__38CbW",account_page_change_email:"Account_account_page_change_email__NCzpZ",account_page_current_email:"Account_account_page_current_email__3iBeo",account_page_password:"Account_account_page_password__1GAE8",account_page_change_password:"Account_account_page_change_password__2IGCI",account_page_email_phone:"Account_account_page_email_phone__1lGQc",account_page_content_data_profile_item:"Account_account_page_content_data_profile_item__1gG06",account_page_name:"Account_account_page_name___4Cnr",account_page_tariff_duration:"Account_account_page_tariff_duration__2hyUe",account_page_tariff_reccurent:"Account_account_page_tariff_reccurent__rZQ1T",account_page_tariff_reccurent_switch:"Account_account_page_tariff_reccurent_switch__1eliV","onoffswitch-checkbox":"Account_onoffswitch-checkbox__1HH_X","onoffswitch-label":"Account_onoffswitch-label__3GoHl",account_page_tariff_list:"Account_account_page_tariff_list__2ySXv",account_page_content_data_unactive:"Account_account_page_content_data_unactive__UvKdN",account_page_notification_wrapper:"Account_account_page_notification_wrapper__1879w",account_page_notification_point:"Account_account_page_notification_point__1ux1B",account_page_add_user_wrapper:"Account_account_page_add_user_wrapper__ytNyf",account_page_add_user_wrapper_plus:"Account_account_page_add_user_wrapper_plus__1acFz",account_page_add_user_wrapper_text:"Account_account_page_add_user_wrapper_text__Fndvk",account_page_content_actions:"Account_account_page_content_actions__3TAS4",account_page_content_actions_point:"Account_account_page_content_actions_point__3D3Xf",promo_action:"Account_promo_action__3PiSq",profile_popup_global_wrapper:"Account_profile_popup_global_wrapper__2-VhL",profile_popup_wrapper:"Account_profile_popup_wrapper__1WTGC",profile_change_close:"Account_profile_change_close__2froI",profile_popup_title:"Account_profile_popup_title__2a3T7",profile_popup_content:"Account_profile_popup_content__1w_-K",profile_popup_content_left:"Account_profile_popup_content_left__2cpB6",profile_popup_content_name:"Account_profile_popup_content_name__5gTDK",profile_popup_content_child:"Account_profile_popup_content_child__16lj7",start_checkbox:"Account_start_checkbox__3Odt2",profile_popup_content_delete:"Account_profile_popup_content_delete__7_lbv",profile_popup_content_right:"Account_profile_popup_content_right__3XnEv",profile_avatar_none:"Account_profile_avatar_none__1ejn0",profile_avatar_list:"Account_profile_avatar_list__3Ibh5",profile_change_row:"Account_profile_change_row__cPLV9",profile_change_title:"Account_profile_change_title__2-ToS",profile_change_label:"Account_profile_change_label__-_DEg",profile_change_input:"Account_profile_change_input__1WAGF",profile_gender_row:"Account_profile_gender_row__1jLVP",profile_gender_changed:"Account_profile_gender_changed__6uclR",profile_change_buttons_wrapper:"Account_profile_change_buttons_wrapper__3JmDd",profile_popup_button_cancel:"Account_profile_popup_button_cancel__3Kah0",profile_popup_button_submit:"Account_profile_popup_button_submit__37sXr",profile_popup_buttons:"Account_profile_popup_buttons__1ZkSF",profile_popup_button:"Account_profile_popup_button__ElVin",profile_popup_buttons_cancel:"Account_profile_popup_buttons_cancel__2lKXR",recurrent__title:"Account_recurrent__title__2AJjQ"}},55446:function(t){t.exports={"account-info":"AccountInfo_account-info__pvF8i","account-info__data-label":"AccountInfo_account-info__data-label__28zBJ","account-info__data-item":"AccountInfo_account-info__data-item__12FaK","account-info__data-text":"AccountInfo_account-info__data-text__3do3p",error:"AccountInfo_error__3_zaR"}},22650:function(t){t.exports={"card-wrap":"AccountPaymentsPopup_card-wrap__2MMl0",remove:"AccountPaymentsPopup_remove__2NW47","payments-item":"AccountPaymentsPopup_payments-item__3zfjd","card-number":"AccountPaymentsPopup_card-number__1tYgi","payments-item--active":"AccountPaymentsPopup_payments-item--active__2kOJE","start-popup":"AccountPaymentsPopup_start-popup__11pB8",dark:"AccountPaymentsPopup_dark__CZQIH","alert__max-payments":"AccountPaymentsPopup_alert__max-payments__1G1Ev",alert__text:"AccountPaymentsPopup_alert__text__2iwYJ","alert__close-btn":"AccountPaymentsPopup_alert__close-btn__1TKxe","start-popup__close":"AccountPaymentsPopup_start-popup__close__30Myj","start-popup__wrapper":"AccountPaymentsPopup_start-popup__wrapper__1l04j","payments-new":"AccountPaymentsPopup_payments-new__uHT1s","payments-new__icon":"AccountPaymentsPopup_payments-new__icon__3Ls_J","payments-new__btn":"AccountPaymentsPopup_payments-new__btn__1UV8b","current-payment":"AccountPaymentsPopup_current-payment__2WtgP","payments-item__card-container":"AccountPaymentsPopup_payments-item__card-container__KDQ0h","payments-item__btn-remove":"AccountPaymentsPopup_payments-item__btn-remove__1mlVV","popup-remove-card":"AccountPaymentsPopup_popup-remove-card__1kiLW","popup-remove-card__text":"AccountPaymentsPopup_popup-remove-card__text__f0nRw","popup-remove-card__control":"AccountPaymentsPopup_popup-remove-card__control__39ix_","popup-remove-card__button-control":"AccountPaymentsPopup_popup-remove-card__button-control__1nTg9","popup__payments-item":"AccountPaymentsPopup_popup__payments-item__1mW3k",tariffsPopup:"AccountPaymentsPopup_tariffsPopup__1FHE1",tariffsPopup__wrapper:"AccountPaymentsPopup_tariffsPopup__wrapper__2PPrr",tariffsPopup__close:"AccountPaymentsPopup_tariffsPopup__close__1jIU9",tariffsPopup__title:"AccountPaymentsPopup_tariffsPopup__title__3UZmM",tariffsPopup__description:"AccountPaymentsPopup_tariffsPopup__description__tG4Di",tariffsPopup__info:"AccountPaymentsPopup_tariffsPopup__info__rrTSo",tariffsPopup__data:"AccountPaymentsPopup_tariffsPopup__data__18asj",tariffsPopup__bg:"AccountPaymentsPopup_tariffsPopup__bg__1cGKe",tariffsPopup__card:"AccountPaymentsPopup_tariffsPopup__card__3KQTT",tariffsPopup__cancel:"AccountPaymentsPopup_tariffsPopup__cancel__kztVc",tariffsPopup__ok:"AccountPaymentsPopup_tariffsPopup__ok__3rIoX",disabled:"AccountPaymentsPopup_disabled__34mtq",tariffsPopup__change:"AccountPaymentsPopup_tariffsPopup__change__vbfYG",tariffsPopup__error:"AccountPaymentsPopup_tariffsPopup__error__3Aeaq",mobile:"AccountPaymentsPopup_mobile__aMyFu",mobile__active:"AccountPaymentsPopup_mobile__active__11xMI","mobile__active-wrapper":"AccountPaymentsPopup_mobile__active-wrapper__1gx75","mobile__active-current":"AccountPaymentsPopup_mobile__active-current__17O3t","mobile__cards-item":"AccountPaymentsPopup_mobile__cards-item__1BL1f",mobile__cards:"AccountPaymentsPopup_mobile__cards__37uAF",mobile__add:"AccountPaymentsPopup_mobile__add__2yx-D","mobile__cards-item_remove":"AccountPaymentsPopup_mobile__cards-item_remove__3JFqa",remove__title:"AccountPaymentsPopup_remove__title__1nHcJ",remove__buttons:"AccountPaymentsPopup_remove__buttons__2HIe4",remove__button:"AccountPaymentsPopup_remove__button__1SyCC"}},42616:function(t){t.exports={"account-profile":"AccountProfile_account-profile__1r4QL","account-profile__block":"AccountProfile_account-profile__block__I8duy","account-profile__block-img":"AccountProfile_account-profile__block-img__2NDLD","account-profile__item-button":"AccountProfile_account-profile__item-button__3D-Vk","account-profile__button":"AccountProfile_account-profile__button__1ba7l","account-profile__button-text":"AccountProfile_account-profile__button-text__2fQYY","account-profile__item-name":"AccountProfile_account-profile__item-name__2sfIH","account-profile__button-img":"AccountProfile_account-profile__button-img__2mxJX","account-profile__item":"AccountProfile_account-profile__item__2VjCc","account-profile__change-info":"AccountProfile_account-profile__change-info__35sq7"}},35273:function(t){t.exports={"account-sidebar":"AccountSidebar_account-sidebar__9cgPg","account-sidebar__top":"AccountSidebar_account-sidebar__top__2ZMnI","account-sidebar__item":"AccountSidebar_account-sidebar__item__1zC13","account-sidebar__item-active":"AccountSidebar_account-sidebar__item-active__1G3P1","account-sidebar__button":"AccountSidebar_account-sidebar__button__mM-dm"}},9489:function(t){t.exports={defaultPointer:"AccountSubscriptions_defaultPointer__1jLnU","account-subscriptions":"AccountSubscriptions_account-subscriptions__21-yW","account-subscriptions__subscription":"AccountSubscriptions_account-subscriptions__subscription__2m7CF","account-subscriptions__right":"AccountSubscriptions_account-subscriptions__right__1NSzF","account-subscriptions__link":"AccountSubscriptions_account-subscriptions__link__Fgjql","account-subscriptions__name":"AccountSubscriptions_account-subscriptions__name__3ILPL","account-subscriptions__subtitle":"AccountSubscriptions_account-subscriptions__subtitle__Z1O_R","account-subscriptions__spinner":"AccountSubscriptions_account-subscriptions__spinner__1bTlL",spinner:"AccountSubscriptions_spinner__1Ul3P","account-subscriptions__button":"AccountSubscriptions_account-subscriptions__button__Y6WsO","account-subscriptions__button-wrapper":"AccountSubscriptions_account-subscriptions__button-wrapper__3we_u","subscription-container":"AccountSubscriptions_subscription-container__1Gjcx","card-default":"AccountSubscriptions_card-default__N0Qe4","card-number":"AccountSubscriptions_card-number__yo-bp","card-wrap":"AccountSubscriptions_card-wrap__1LWQF","account-payments":"AccountSubscriptions_account-payments__3NPU8","account-payments__card":"AccountSubscriptions_account-payments__card__19Vba","account-payments__link":"AccountSubscriptions_account-payments__link__256tq",subscriptions:"AccountSubscriptions_subscriptions__14wKx",tariff:"AccountSubscriptions_tariff__189o9",wrapper:"AccountSubscriptions_wrapper__2ENyn",current:"AccountSubscriptions_current__1vAq7",own:"AccountSubscriptions_own__3ozK8",month:"AccountSubscriptions_month__2MXfP",duration:"AccountSubscriptions_duration__1S0TG",total:"AccountSubscriptions_total__1AFVw",tip:"AccountSubscriptions_tip__3ffhy",discount:"AccountSubscriptions_discount__1PTVx",period:"AccountSubscriptions_period__oW0Y5","account-subscriptions__left":"AccountSubscriptions_account-subscriptions__left__3lRr3","account-subscriptions__type":"AccountSubscriptions_account-subscriptions__type__1HJgH",marginB:"AccountSubscriptions_marginB__3NaqL",price:"AccountSubscriptions_price__3tVr4",pay:"AccountSubscriptions_pay__3OVl-"}},21380:function(t){t.exports={"start-popup":"StartPopups_start-popup__3ZWOe","start-popup__wrapper":"StartPopups_start-popup__wrapper__28-Iw","start-popup__delete":"StartPopups_start-popup__delete__uNkrP","start-popup__close":"StartPopups_start-popup__close__111-7","start-popup__title":"StartPopups_start-popup__title__1MaDr","start-popup__title-profile":"StartPopups_start-popup__title-profile__3NfUA","start-popup__content":"StartPopups_start-popup__content__3LMcf","start-popup__input-label":"StartPopups_start-popup__input-label__10XEc","start-popup__input-text":"StartPopups_start-popup__input-text__2se-a","start-popup__content-lang-text":"StartPopups_start-popup__content-lang-text__27a3R","start-popup__text":"StartPopups_start-popup__text__2Lyez","start-popup__description":"StartPopups_start-popup__description__1B9vg","start-popup__button":"StartPopups_start-popup__button__3hdeU",submited:"StartPopups_submited__ApIHy",spinner:"StartPopups_spinner__PeYdy","start-popup__button-red":"StartPopups_start-popup__button-red__3MtN3","start-popup__button-stroke":"StartPopups_start-popup__button-stroke__nHyEh","start-popup__button-unstroke":"StartPopups_start-popup__button-unstroke__3ze1f","start-popup__spinner":"StartPopups_start-popup__spinner__JrNdX","start-popup__profile-wrapper":"StartPopups_start-popup__profile-wrapper__1naxd","start-popup__profile":"StartPopups_start-popup__profile__3vrfw","start-popup__profile-avatar":"StartPopups_start-popup__profile-avatar__3n8Cw","start-popup__profile-checkbox-wrapper":"StartPopups_start-popup__profile-checkbox-wrapper__1QF-U","start-popup__profile-delete":"StartPopups_start-popup__profile-delete__1w3Ds","start-popup__delete-name":"StartPopups_start-popup__delete-name__yZUU0","start-popup__avatars-wrapper":"StartPopups_start-popup__avatars-wrapper__2jSKG","start-popup__avatars-item":"StartPopups_start-popup__avatars-item__x2DAp","start-popup__input-wrapper":"StartPopups_start-popup__input-wrapper__Y_IQ5","start-popup__item":"StartPopups_start-popup__item__Zn3V3","start-popup__error":"StartPopups_start-popup__error__2XZ-B","account-popup__date":"StartPopups_account-popup__date__1Nca4","account-popup__error":"StartPopups_account-popup__error__mdZBk","start-popup__delete-img":"StartPopups_start-popup__delete-img__3wmSL","start-popup__title-sure-delete":"StartPopups_start-popup__title-sure-delete__1y-1h"}},55922:function(t){t.exports={card:"CardPayment_card__145Ve",small:"CardPayment_small__M4Vw6","card-logo--centered":"CardPayment_card-logo--centered__2J4FS","card-number":"CardPayment_card-number__2Xsjf","card-wrap":"CardPayment_card-wrap__zkfR_",dark:"CardPayment_dark__1IBvi",card__disabled:"CardPayment_card__disabled__3V2mL",disabled:"CardPayment_disabled__kPUCw","card-logo":"CardPayment_card-logo__1UCQw","card-text":"CardPayment_card-text__26miw","payments-multiple":"CardPayment_payments-multiple__25n_7","payments-multiple__text":"CardPayment_payments-multiple__text__15ZRy","payments-multiple__image":"CardPayment_payments-multiple__image__jvWd5","card-bank-logo":"CardPayment_card-bank-logo__2aLG0"}},75093:function(t,e,n){"use strict";function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}n.d(e,{Z:function(){return o}})},59999:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var o=n(75093);var a=n(40355);function r(t){return function(t){if(Array.isArray(t))return(0,o.Z)(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||(0,a.Z)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},40355:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var o=n(75093);function a(t,e){if(t){if("string"===typeof t)return(0,o.Z)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,o.Z)(t,e):void 0}}}},function(t){t.O(0,[9774,7925,3433,2090,7018,2191,569,8122,6261,8882,1688,6880,3064,7815,9236,1877],(function(){return e=93290,t(t.s=e);var e}));var e=t.O();_N_E=e}]);